# $Id$
# Maintainer: Thomas Baechler <thomas@archlinux.org>
# Contributor: Jaroslaw Swierczynski <swiergot@juvepoland.com>
# Contributor: Michal Hybner <dta081@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgbase=firefox-i18n
pkgver=33.0
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox>=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'az     "Azerbaijani"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'csb    "Kashubian"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Lower Sorbian"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati (India)"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Malay"'
  'nb-NO  "Norwegian (BokmÃ¥l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi (India)"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=()
source=()
_url=http://download.cdn.mozilla.net/pub/firefox/releases/$pkgver/linux-i686/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

_package() {
  pkgdesc="$2 language pack for Firefox"
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg csb; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}

md5sums=('2963ccbe3ba6a91b44318a9f52fa386f'
         'd1c9e298fb4f20c50201f2984149b77a'
         '79db810c03957bd8f0af6beb41c6159d'
         'a05fadfa79d6903e2fd34b79ae133293'
         '8ff97e056e7b883e00b6ed0bafa9fc9d'
         '63b1569bd912657f54b6bdcb3f3dd907'
         '0af9c94e279d4164dbb3d7e0106f550b'
         '74ae4670551cabf50557b2089dd4bd34'
         '1e4bee3ddbd7552ee20b3d85fb585e55'
         '27c20a5420d4add92526c79c8a202fc5'
         'e75af23840f95b960a9acfc4232ef7cf'
         '92d58c8f0a4cdf6623b4c2b996fc365e'
         'edccd64c2a5439df497292b3927a6b15'
         'e0239a41ced7d2c191b78482230c8cb4'
         '586984b0b28b8d84cec5915703af3768'
         '4af160603045541ad0b449ae6fca966e'
         '0ea8aed71f8ed6019c9a35487ab0fb71'
         '952fa3171d54e08af1df80782ad0cb34'
         '13426db18885a5fd3e61304286b67d09'
         '5d443eaad0cb5f1e7a75d10085c2bdf2'
         'f864ebc70bfa89a98d2cff275d952686'
         '37f23418392cb5f6b8d6cec0b8e6c897'
         '5339c14bf91895ea58ee2b46bd10030e'
         'e132c229fcdb913aac6a17723003f67a'
         'ae756b37a4960714fb2f5e344e047268'
         '48144402eb49922574619ab3c3df37cf'
         'e92fecf85d2c58e57a2361230c3796f4'
         '5d8e322cfcb8aa5a41dbbdd6175dd341'
         'd021c7aeb683d67d20af145501ec0198'
         '044797d94ccfdbb1c59bce3edab37d47'
         'ec600b8578070b02ee96b7fd92702a34'
         '0192713b7380496773a7661129da7d0b'
         'c78e124daabab6fb3ba1c0db38771300'
         'b7975e58367a001786d1e9ddfe0e6e4a'
         'be452afa7a465de248a6dc51f733f5b3'
         '527fbe3a2c25f4517c9f983719cf2e94'
         '7f6ca7907803d9aa036e392eba9441cd'
         'aab09d6275620f16387512cd3c5c3379'
         '00f9fccee324effb6044f6a742aec126'
         'aeeb757711951a4510f61c543c295d5a'
         'f4b548ea7ffe9a1d052f402fe578db0f'
         '4a01ee5943a557691389a4683130e53f'
         '1e4535532d1c3b6b7b139723f5adf491'
         'b153f453628d44b9ea376d61449f4eac'
         'd8d87794948b423f043b47636cb1e0b8'
         'd2e16563b9cadbddcf12ce31c63c0e07'
         '06ebee513252b21dc1addacb904404e1'
         'eec8008337a6118bc04df0315c98f833'
         'af75a7322168bdc0b2aa984919b0ad77'
         'ca9457ffa6c850bacf1f7c8f414994d1'
         'b85d80ce6fd49f80e4135422b801bb99'
         '259f16d0a8519a471ad344f69338074d'
         '729c37279dbd2f398802a59e47012b15'
         '1863c481324f56d86b012d2c9faec5a6'
         'b8cc11481271630b250e59c7c2ee7bf2'
         '344d0d726357bfa8c42a8b1bb3e33bac'
         '673dd43cb0bfd5f6c853735c2f6dc2f7'
         'c72a4549ce2e6e61876d3667a0695712'
         'f2661da3e15c6a87565537d196961323'
         '359649fb360e6964b947753c3342caa2'
         'e3225bcf2c958ef8ad93fd04a242fa2d'
         '5fae5582d277679a9008061d66262971'
         '02edc8b837f1ca1ac909be1947754ece'
         'eeed15062443f601dcf6d1ac7b79d272'
         '016db9afe9e5e11dca864bf644f44944'
         '4f5a1cac594212691c6911784f34d65e'
         'bdc9957823ff7b7fc990558cccc23c01'
         '6561adc949974afb8ca387b11fd0e1ac'
         'fcf22f7b273e25052b87c965df6dc6f9'
         '3f5ce88c143a6687a130484099ee4492'
         'dbd2fc3cf7ee7e87b8b115b81aabd09a'
         'd5df59b3371c74c431532c5abc30ae60'
         '5d6ede05ade0f95fce8435508c127002'
         '022a900ff1bddf98f0a99980f3efbc84'
         'ba2b21b0be9688632d6e10a8e1d8d6ed'
         'f22015abd9299db122f7991a9d2b806a'
         '3a1cefd91792ada5513e22af6965bec2'
         '76b2aa95c36f5d4c4eb1b587445f5aff'
         'b7f4c29894bee0d213d131985b6666fc'
         '5ed8e96ca461705bd26a0875c7b5ecc8'
         '14648edde3990558537681004c017017'
         '03e31a73121adc0299d84984ec6bb16e'
         '806932dadb09b7a2cade894c58403989'
         '1df3f1bc1f51b93f13a229b25cfb127c'
         '79d7ecc76ba0ca66ab85e83f68a2497a'
         '5b96bee3c71b265fc8462f7c6c29df8f'
         'c4a8ad9470f95a91fe97e8d7a5097791'
         'bcfead1602c2c2e69eb5b0bb34477c25')
