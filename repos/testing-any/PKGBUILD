# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase=libreoffice-fresh-i18n

pkgver=5.0.0
pkgrel=1
_rcver=${pkgver}.5
#_oodlver=${pkgver}.0.beta1
_oodlver=${pkgver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)
md5sums=('7852ca3743f988af70d95ae59cffa715'
         '4e2c94c7bc4936ae19d9cb8cdb8a21e4'
         '66af6e61a9f1a4028b74bb0603f38af0'
         '194a297d438ca47928df201ee2d51830'
         '2d020fec3f7b463a06339ff16a67bc4a'
         '4c6a1ad68bd90223c0959926532ccd9f'
         '0d336d16c9367badf38671709b08dfea'
         '9acbad296b7b776d335c77849aab31bb'
         'dcdd33b9616f6afbe9829466dbc1044b'
         'ec511fec8410b0bb7556cc0ee73980a0'
         'ff282383717f7cfb9cac569d0b7e2bd8'
         'e8064c38179e057193384c508e98d655'
         'eefc13498555fefd9322fd4ce47a1f16'
         '4e1c5fb69dd4016886353fd2c7c1a266'
         '28712935e13443fad0e8c54cc6720466'
         'e62aa6b1874c448458bea01b752920a9'
         'b526d23e1b666c1655ecd110bc90bfac'
         '6b6f2be1bde8ca2c54456260ea17aef9'
         'b702ea7c81e53746098e8171e4a0ac0d'
         '27ac2721b7534396dab624ae4f094c2e'
         'e532b91f02b989564d07ca3515d3ed24'
         '003a6e5e7882688572e71973b63193cf'
         '62e5f2f68b10a0e75d56d944dccbd93b'
         'b21fbce0e00bd127d033e95fa0437767'
         '0f7f43fc7b44261bc6e41a975cbb1629'
         'f6379836b0a02d8fddde4310d0e4270b'
         'cf4e95ad65a81c114db2bd7b75a5c6d0'
         '74f1f9eb19f833a2119e93e42a33200b'
         '64491e53f851fb3bf208c4b8062e7f85'
         'ead6ce1930cba4d8d18bb4a3d3f58239'
         '40dc2f7938fd9a2534d6098651a0fab9'
         'ff221afc9a8f3bc17bbe72bac7fc1da5'
         'ce0e42779e0d4451b3fc47989a462446'
         '50a6139a39c2d3b1d18b00fdda0d3a8c'
         '4a3d3c9c61d4f133ad44a901722be581'
         '83fef9ead1ae32f0b9fae45ecc1aac90'
         'b2959549d5cfe5d6381a81e213c0c87c'
         '38be6d3d38132c91a9ca2206dfa7a693'
         '1752872bb36e9fd0189b98cba79d3b05'
         '77f2e8819bce4272c4a7bc83dcb51ac0'
         '3eddeeb8806cfee6c576e01120abc306'
         '89d58fe75bd830535c7f4bc50f7f6538'
         'a905c4be1fe76ab89c9a8e0021037960'
         '0bae49a5ee5b16354356d49663b6c322'
         '8ac341464c3ba9761693d5ebb83a8964'
         '4fb39218a5579914ab3a27a205c40c39'
         '3b9ee7e9e9cdad6928911227b0fa6a05'
         '97a85ae85495c5a94ceb81ee03c4bde1'
         'd35af170b5e835a7c102afca8e6a48ee'
         'cee182e4b584024ced229b5f93304486'
         'cac0a6359e198ce2010052d097a1971e'
         '8ab9a0ec71d74f0cccdc6229c2b28a7d'
         '3a7145743b38bd5744ddfcd34d218682'
         '39da3a9a4be3d73c9807ac2cadaece48'
         '5f2990fa345101fe0fa488a94568cada'
         '79584e63e15ed9818449a653becb1462'
         'f34b6424688f4333b5ffad811699ef9b'
         '262f32248687de6d440cffb005c1b151'
         '9dfe0125e2ea9827ea5517304a1a18d8'
         '61ab69e07dd606fc9e0bbeb116e1b91a'
         'a744dfd45f7f4e41514b56181b6ab91b'
         'a5d8936ec7420c877047aca9ac69701a'
         '28c3e038079bd83b68e540cd5ca18201'
         'bc6882490798d4b605852f6ba424153f'
         'ea2600d1bfcb9cdadc19c9ddf374cbea'
         'd172462462084a6b7a2d8ab28f40d03d'
         '6788e7a49de1a214a0038c7d66b89621'
         '94fee2cfc64595999201fb329d260390'
         '6df72bea94dc0b4994281694dfe6c5b9'
         '14632ec7043538936b46661f0a4056fe'
         '693a900e15b52ebdc87d6e667b91febe'
         '06fcbac40697d449c3a3469185f61776'
         '6c4b39c4198396c22aae0f05855150f9'
         '62e5ba9afd41fc15542b4005302a6c12'
         '384c963c09c789f7cc0cea5d27287dbd'
         'd7481be0dd7e477484b4fd23b64eddd2'
         '70abb0baf4b170e05fe2dfaf766be98a'
         '9c7266b4c82b2c88faf90ea3ade9bfa4'
         'd8e5444b7225310578b225aee88fd7f3'
         '10513f1b820ee38305468ac9d2f8d863'
         'f4cb480bd07ec5cd429e5e5e69eb2fa9'
         '83ab652d0a8c7b3fd761f649c97ec7d4'
         '025e89817a1f8b734314f350ae95ba5b'
         'd9a0652af6227d225184ebba7337869b'
         '54ff2f200aa11c0dafe2b4a37e2c5f90'
         '9dd0c2bd21875e1f6b270f7a1b69a479'
         '12aa333f8dd205d51377707ad0e0f703'
         '4e147986d712bf70b4089dda82d3354e'
         'b20d5ebdc57a093f3e69b8db29df63cb'
         'ab61eb9aefabdee34b6b274571172d32'
         '88e4d9230d73f27f2015d6e53c8530a7'
         'fe68c909e06d956ffe3e45a22b3eec83'
         '454e2b13305f8e81e74e0d3b0286e07c'
         '1b874281805bb0a9e98ae41f4e464eac'
         '2e9136999dd50889d407a18dfbc4e615'
         '2d29fac13a3cc8463eaceadac5f8b13a'
         '89cfe7e15856e7c300462082fa618a22'
         'f87f3017719b5a0cf9a03f6a95308c3c'
         '37b4d70050fa5f7c66c15b4f2bf49bdf'
         '109485a5b49afa9765a59c03792f15d4'
         '0ac8e34c3c62bbef69c8fba422c10f87'
         '8a75b2dbe9943e1a77382074f5298181'
         '0686657526ec5995ad9fd30b4f149c92'
         'f166029919d568c22026c0e42b354e9d'
         '6681fed2953cef428a49336715efa169'
         'cb8fde88012aeca198e408fb7a45f87c'
         'bcf8241af7e30f936cd3634033f61503'
         '3c1ef8b3e437579246f441593f90bd93'
         '16dacd17231cb92a591bf6dbc8c05569'
         'a134c6528fb402a0d96e667e32c45987'
         'ffde773083dda2cfafcc49b5cccdfd0d'
         '8ad3403f587ef9685f30391acfd9e39e'
         'dd497e6256a23f6150505352dd2fcd41'
         'd44605869d04db009ba847ca0e2c93f8'
         '562981eb2410dc13b1e3d872a7a709b6'
         'b0938a884d3263d6042a67fe250f4b32'
         '61b74eb88d384fdf06a36a6aba370777'
         '691a41ac2041a8c9360225de20e251b2'
         'a98aa67bd875be66afeed7960affbce1'
         'dceb729b5c4eb8541be9ca31328abf81'
         'ad4ce6e67844f19d1420c5678af22553'
         '55169ccaa3b70e1844cce7c740e22182'
         '665bfaa474c9fed47fcadf287167520e'
         '1dfd90ebfcd16683f95023032d3d1f2d'
         '12e0aa292fc8d53d4f839693d7f2e72e'
         '8d80104881a142670ff5041a3188e14e'
         'af3646161333c4a0553634531e4e5fee'
         '9ffff051defce6bcd0d12d1bb08cf9ad'
         '564eb348b68fc5ff278c7061ff2b6da5'
         '184de313ad3c7b7f51e9fdf41752d662'
         'e7e6c09381949f0d931761481e275d03'
         '665c4b52056b3a101665f83ea66c6be0'
         '8d03ee2a4f32aa6005224960a7a2c379'
         '6bac9aeb10d95b4edce0c7c36899bc7d'
         'da755a95c919fd9dd595d180a21758d9'
         'e24cadd6e6a37beaa2622b59b7f2d7bb'
         '8dfec1ae049562527a93158c699746f5'
         '05f599f4e11e2bf192605cb84535a945'
         'f40780d5e208bd1c3f92da912f099f14'
         'ff2d965144268f08802db15109bb73c4'
         '93402fbe5abbd4c108de541bfebc8402'
         'b692440ee8452afbf4be343366b5ef5d'
         'b83433aa43ed5665df2dade9cbcf8875'
         '658f46e4ff4630ba8a0185fcbdfeb9a8'
         '256593295aafdfcca2bc8e286a7aba7a'
         '981b832696fbdb9f53f35c193f889efb'
         'bc8b543dd4757976016ebf7882989408'
         'b422bf3804c73ebb61d452b6c1971ae9'
         'dba6c15b7287d5edb26e7b71acdf4b64'
         '27f47e6704d1bcafdd487fc097f8224d'
         'c0dce724f10663d8c25a2d034d0f9472'
         '9e1b7c9a90620127c55189c5c84e6ca5'
         'cbd61132268683457b45332f37e1bb69'
         'd316ddf59915f6b00561d336cbe5c6fb'
         'e752a8ee4482fa17e7fdc42abef231fe'
         '5e3520fe567519616ba357806040fdff'
         '379c0b8ae64a06e958481c7c31df96a7'
         '326dc4d343bb5faa9099f4f145b82b08'
         '8050d1019e8b1dfd65562d7e311394bb'
         '1441f3c9ec12d9aada8b8e9dfa577605'
         '1cee9da0c680637c9df90ff12019123b'
         '8ef64fd99f1360162737921b3e39fc66'
         '9e2d7c9e3f14f00287e8c8508b0d4809'
         'a213da67d3c5b2224f3edd5b8a2eb6ce'
         'b9cb9eaf7f52f122871e502b2f02a855'
         '6900cd119d29152f3d5ede68ced5e263')

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/fresh-}

    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm \
      || true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice Fresh"
  depends=('libreoffice-fresh')
  provides=("openoffice-$1" "libreoffice-$1")
  conflicts=("openoffice-$1" "libreoffice-$1")
  replaces=("openoffice-$1")

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-fresh-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
