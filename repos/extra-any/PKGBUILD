# $Id$
# Maintainer: Thomas Baechler <thomas@archlinux.org>
# Contributor: Jaroslaw Swierczynski <swiergot@juvepoland.com>
# Contributor: Michal Hybner <dta081@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgbase=firefox-i18n
pkgver=32.0.2
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox>=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'csb    "Kashubian"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'nb-NO  "Norwegian (BokmÃ¥l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=()
source=()
_url=http://download.cdn.mozilla.net/pub/firefox/releases/$pkgver/linux-i686/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

_package() {
  pkgdesc="$2 language pack for Firefox"
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg csb; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}

md5sums=('d99011e8ee18406a0269ec84e4f450df'
         '3e691878f774900b513a963cf0c759b5'
         '621bba1383c9cc940b740a21c9e9175f'
         '9e8055e6eb371833d0a78ffe6cf1d587'
         'fc56774ceb56ac5b8de7d9dcac1510d3'
         'f78df981dd25807352f7e7ac8dd3e253'
         'dc61721d5dee6e608e3cf9a9332fac59'
         '66ae1916c01aac1298c20f90a92950f9'
         '1ca1275d4aae4cae24543ae43a4fc7ce'
         '6a9f1870a1062656fe9be7d44258b84f'
         'c140a93cdfda54a11e59beaf050f0f9b'
         'ce17183f10ba52812e0ee2a32bbd99dc'
         '1b9549119aef711cd96654671e1e8312'
         '89fda314d63facdf03c537602a5eaec5'
         'e9603de827ed440f71dbbe035dad7549'
         'ddef8e00ffee9b0782a6c843b7ec625c'
         '8545a0395172f2563d1be2fef5167271'
         'f3933864da8d926c6a1e50e6dd1cd8e6'
         'd0e950e2f7bd986ced61d92bc9ca9540'
         'f4b2403f1f1ffa53f0471431ea7ba03d'
         'd70a9f4ece4f74245e43cfade91e4179'
         'e0536b736c549455f14cdee92d34fa61'
         '13e1d9450ee95823b58b753c951ad3d4'
         'e045eaea8ac1ae2034d92e3883a8fd18'
         '2c06b7f36219db0156235da111520cd8'
         '33a55a677f98805cccc7c4e51b9c5087'
         'd544cf36bb6cb619c68746a05d9ceaea'
         '2b762d8690e6d362d05f358f2b47b492'
         'fd2feed471ac7225db0645472a491a1a'
         'b9ae8be4235e3b3a2398844ed97f26c4'
         '78e702183f1c6841592829640cca13ff'
         '40fa8a56e7c45f5c442c8ed7bc5e322f'
         'c6ddcc6f498f188224d9d192ec6f3c43'
         '1ce62650c4227171e11066aa7bc64013'
         '1ab9e0084dbf57ee7166c3afdb964907'
         '4fb1ea716d707c27b34ba1073cd32323'
         '3d4d49327cb4d82fcf8f32917dabd806'
         '106c2ef9d05598b08b8967a83272e4a5'
         'e178dbe70f0a0117b91ed80c3e657322'
         'a1f25cdf458f2e32b6eb7980a04db1cf'
         '9b569b03bc078e47802101cc0d4a5475'
         '704f2a7fbb2aeac5beefc43c8b624554'
         '1a0b129dc1f87871008f17592bcbfacd'
         '68559779023aa95be480caef98a31976'
         '6408c3a1b83386df2bf5e9c6d63400ab'
         '8ad802fa45b8a821a3e6321f2a0427de'
         'bce85849627e8975385b02038a4c1a40'
         '4e8b0e2d0fa3fb8b4265a55070ef4f66'
         'dbcb0131c49feb583a1b5261953aa323'
         '43d7bc71b477a0144d6cfc8365e4d39a'
         '99a7e1c403ee2268f2c586c8b30b5049'
         '44fb78994d502ba5c3c2b364710d7012'
         'c5062d0cdda3c061a4fce1e17f556ef9'
         '960bbe13e4678b911d0b91ccf5f2e482'
         '999f55b599f36f6b88fc34ffd50aaf56'
         '627bc7596e71c28cb4470ee470ec520d'
         '6d93c01ab8c8d237e0bbe98460a02061'
         'eef2d37ffa1915ecbab01bbe1fdcd357'
         'e714ce23b3de3b0100c5a8639d09d9c4'
         '7016d4325044ed2cd80ba703be36950e'
         '0bc1d9b5600a343284385b81a8d44101'
         'a06bc81040a1111af155908df5b41d69'
         '67871cac39c71da3ff336c250d977c48'
         '86edc94f40df6daf539815f0bfd3fe8c'
         'c58311c1615e1ca1c4a9c3ee7a156077'
         '8402f90b0c31622ac46b429e6f285fa6'
         'a5927d5c590b04aa6d19d6d1d4c83845'
         'ed15cd25914d6aae3294417789963b2c'
         'e021034e07043a48685bc5cdc6704107'
         '99cb05c627c7b7a68d0f23380020f057'
         'f7f43ceda0d595ca01404f684bc087f5'
         '72c1d9dfceff63cf2d835447c9410b22'
         'c6ac341db8f11f77829f6f16ae3875e7'
         'be9b837b7818eefe4ae458ae4d470692'
         '52c8291c2461a1300af9774fded9b01f'
         '7340657e090d5f5e89f6a1e1e5e6b63d'
         '03b209c1afe379c553e1d9acb2354f08'
         '7a4f46723f02e02ded4a4f39caded063'
         'd230223a5190119d8a432c17c8e5865a'
         '01b585e86eb50aa6228e6ee4adc68fe0'
         '3c300814331348da7a301983519fa4f9'
         'ae44322face78eb3a58136b8272ead79'
         '4d360372f0841f1533fa64cf0db43751')
