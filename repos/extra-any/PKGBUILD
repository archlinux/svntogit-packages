# $Id$
# Maintainer: Thomas Baechler <thomas@archlinux.org>
# Contributor: Jaroslaw Swierczynski <swiergot@juvepoland.com>
# Contributor: Michal Hybner <dta081@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgbase=firefox-i18n
pkgver=32.0
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox>=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'csb    "Kashubian"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'nb-NO  "Norwegian (BokmÃ¥l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=()
source=()
_url=http://download.cdn.mozilla.net/pub/firefox/releases/$pkgver/linux-i686/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

_package() {
  pkgdesc="$2 language pack for Firefox"
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg csb; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}

md5sums=('aa9c0ed90553c9ee035f9f4c24c59576'
         '86de027b23200d25ac68fb2db7be0b32'
         'ba151b4b7b68d6fc7d75f8b8668abae6'
         '58fa8b7ee014b68ba91c1fe633b2ff99'
         'e75508b54e199ecfdeb088116104910d'
         '21c4e186886f936874e3409d7891b807'
         'ebf5a6cd1182ac81f200e5e3d494dc3b'
         '2b493479509929a36aacb4bd7739c7bb'
         '1c7f4d367b64d39a7f5b1ff53dd1fc25'
         '9955071de92dde7e42026a2c0e4a5231'
         'e7cac310f20f62559f58f1bae90ca4ce'
         '617f128aea53a94bbe45566b13054a62'
         '73bd2e980c97c89ce8b7cf618fd8e202'
         'e7300b3ccc805089b8a9b80dcc5512d0'
         '5bb2b9d95550b04c2ceeeac2f4134673'
         '915718140a6c0c840ea328ca94082356'
         'aa6b147a3b432be8569b51505113a1cb'
         '6bb44558382657298632f910233a3b42'
         '9e8d4df4f43e037d9a370c88d0b41c3f'
         '1e444cdadd566e23a5027c176e464a83'
         '7991562192929da2f474febdb0299756'
         '350d70c6824b65f1c98e5d44e99a8188'
         'c537491afe46bd428dbbd8f811162ec3'
         '3955948b105c9c137a7f07095c3b1faf'
         'effc6f6437a0e2157eb931261dac8ad0'
         '2c73c19386d60f7663eb6d92ba3147a8'
         '453f8d5d4894737b1aae530f8e633c0b'
         'ea78a5160eb4789db30c7d86ea6fdc13'
         '84e53838fb30b13af9b23b491cb35dac'
         '4bcb50575450dfcffa0e4912349a142b'
         '60fcebd762f60530a682f6a615beef45'
         'ef95aa0ae0b6088fa66daee04caa69ef'
         '53671d9892669618bd46d0633f14c16c'
         '6be063cff174bd22a05ceb1af0ea75b8'
         '8472d35b05a00f179a2b9e30e944ad59'
         'a0a869fe51c28fa1834217f8dd28b77f'
         'b69732bdcdf8ef486c64044b61e552e9'
         'b9bccaee428eb5f326cda54dc8962e47'
         'afbd76134e334b8c63cbafebdff3e52a'
         '6795c07134b0411d3019e2c536f00c80'
         '64eaa643f0f54891f5626f008b13455c'
         '081da30bfe609907217da4292167ced3'
         '757fef1fe62aa107a8b4f33413e9b9bd'
         'a329da2ca085b8cdcf6577d27e8ba777'
         '93b64f9ddc8c8da58a3939fa4a31a66a'
         '0d6d7c33706f6f9fa47cc745017b20f3'
         'e41a068800c85f8fa9b1cd851521213f'
         '4e41d5ba8e56c5b9b2f32f4600466833'
         '8383bb378887bdb04de30dfc1699c560'
         '1859ff08965f3f441d6ceb7b8e13e0f0'
         'd230218b4ce85d8f7e36c9799b2ef997'
         '682be302fd45e3d050f1b2ffcc141875'
         '7750420c111be194ff6e78a8d8dc2c64'
         '4331e5d31046737d53bdfe63f086bf78'
         'dcb6efd2ed130937dc17fd51e9b75a81'
         '0f8918ca307bd082c0814e7ccdaf83c0'
         'f256f6916bc350f0f4f22f47f48a1f1e'
         '05e28a032ac480166ff0092b3ef904b2'
         '496d0ffc567b66ee5e4da083a395b1e2'
         '146ece429108d16c5f92c3057afc50ee'
         'a167b125e40445abb7c43a33ad116c16'
         '7ee036ca5544159d3c838286ccfde0b6'
         '7806f6f1cf2ca2f93510618d6a8bdb84'
         '3a232c15dff3e0c0454dea76df052a9c'
         '2070023f9b6cee30117dde12628f7163'
         '47ecb4ad743e92adad6778de7609cf28'
         '28f6defc2a6187fc3d954322e26bf843'
         '57b14b41f3f8a3d1dc27ac03e55f5f70'
         '47e1e548befc33917d2797ca8ec847bc'
         '495a2bbc176212bb74b503fc24f1dad4'
         '4f48e4cd559da077ee617979c6b1e762'
         '6374cabb7bda36fd4f2ddf77faba7bdd'
         '102f1226641987204725dd50e810bd30'
         'abba947996e84a71fcca4775ccbafc1f'
         '381113cdc5d52ec6f94963db872ab42a'
         '7c0c441bf562e4ec0c1159017b241904'
         'f6b33824e0b795d733707319662043b5'
         'f496fdc21d0677d395c0daf1d03f173a'
         '127cddc5973fa3120a651ead0f32e594'
         '17ecac509cd15937379fb010f6501ab3'
         '003838628d6ff20af724edb0c4ce5ad1'
         '44f9931dfbe15d2ed2eaea97bc0c806c'
         '63ab7093cc6e39a83a8b1bf75543029f')
