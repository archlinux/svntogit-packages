# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase=libreoffice-fresh-i18n

pkgver=4.3.0
pkgrel=1
_rcver=4.3.0.4
#_oodlver=${pkgver}.0.beta1
_oodlver=${pkgver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/fresh-}

    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm \
      || true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice Fresh"
  depends=('libreoffice-fresh')
  provides=("openoffice-$1" "libreoffice-$1")
  conflicts=("openoffice-$1" "libreoffice-$1")
  replaces=("openoffice-$1")

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-fresh-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done

md5sums=('eca53968341803bc238a18146342a02e'
         'f148245fe1b8056ebb2e9fdf4cfe99f5'
         '248eb12ff5fea612cf737f6f7ca930f2'
         '9146f28a0ab95a6ed6c4f7acf9561001'
         '00b19f09a4604e000a7a896f4961f4ec'
         '9d1970ce72fca00efa54a9744c340008'
         '1ee6beadf99e69404766054f2e8c954a'
         '124f621c6718643df7bd3ba91b3b97d9'
         '0bf1ff3fc43ffa82c48847acb38c519f'
         'f6b228fd6629d3a8c635c3aa034d7589'
         'dc5fbd5dc2fc126a5e5c7f1000f846be'
         'd1c938e42f732abe89e6bb22e41db4ad'
         '393729e000886e5af25733a49553240b'
         '08f3eb9eca15e27ea3e0615995957113'
         '1e25d125bfc4fdd236860d460ed9bff6'
         '496b68596461321d9ff2a4b227d3ad21'
         '43a9c3600b7866d917f12f3009fcbfdc'
         '83704086aab8dbcfd85de33bc4ab72c3'
         'd1d8d5f7cca1613355b1490b5fd36ff3'
         'f143c266b5f80a24d0d5a5865ef76369'
         '1ac1597db1e4c56e7779d02be1aa7fd8'
         '75481bb0b96e49ad3aab0331e8699758'
         'd16f906454ef92c5efe5c952054835b6'
         'b3da86a29d77e14277a826bb50d5e23b'
         'c921d52b234aa95ba771bf7cee215d7e'
         '2e926349e7a54f4bed7bf2e79a8a5da3'
         '7d0f05c85736e67d9be3c359ea6e42cb'
         '10d3bbcbb9ec249a405b38758367ffd8'
         '4c52252daa292f4f0dcd317c11fadf62'
         'f4c5bcdfe052290b9f0eb334f0d41631'
         '9b7e4591468ea54d9b4853767e5e6a32'
         '39491edf155b5e39eb936a9843c194b6'
         '5f30c18660446a04b8ec8b1d5d453330'
         '3071ba859ff1fc4a5d853f7413e350e4'
         '0cdd7d121dcfffc602e00d74e70cf661'
         '354f034c35bb38ca6b516c9965ada126'
         '531d9a6ba20e3f033a81bc7c69367ffa'
         '39f1b3718540fb3ad15aba5bf83fb3be'
         '108cc901a713c1ef8d7bc50d96cde7eb'
         '8a2bc7736a7e68807a04e9588f3ef03a'
         '050819878aac4b6e867ab0df1bc3034e'
         '1320df1c9f0079dabcf29e23e55b1345'
         '7d8d2d87b2e86deeeeaf124817504f10'
         'ef7883c69604e2844a6495c2a6d20dcc'
         'a9acfbebe89f89c7838ec4665d906d96'
         'daa9461987647519fdf44b950118fdbf'
         '90f84605ee20c4fbd6b3cf078183142d'
         'b1500895b7e91a3b5b154fdfb5569420'
         '870c02f86d832026402b9b7865d3a4a7'
         '6e361552d26b6bbdfb968e31dba55642'
         '38bf00fd45cbeeffeabeb6932579bf82'
         '84f426fd53c894372896f0d0d7a27815'
         '5e8198ad9297f74b0f83b40aad8dac8f'
         '26d66d2e32f5c93c1a8e358cf4923299'
         '9bc7be33ba509a265fc74a3e7518a7b1'
         '4ddb282a9ddecb910263bb2c6973d164'
         '0eac113a8da63dc05a78b606c390c6d2'
         '88ca9c567965cd1d85f4bdd0f74959fe'
         '1729b49bb948bf4b2000cd5fbb45d70e'
         '66c1c1cb64d0c7117746f81681ac64d5'
         '4432815d656e02b03045d841e8d351ce'
         'd18d66a231a11233f218c582e4b3503b'
         '7cdd0a60a8096cfe7929fff8882c9cf4'
         'ba2f048f091d58ece4498c66c79f7c4c'
         'dc186f280aaa8f66a039722dd9c624c8'
         '419659f67c8ef3d8b2d0834c35098bd8'
         '505a36aecc6b8ed539f7e6e5c82146ae'
         '116250b5c362e0568b9d98f732b7d480'
         '4c7ebaff514b5caf5cc29dbeb54ff437'
         '0f72483670413d2229e953308edfb16f'
         '03a0cb89c7a372d6d1dbd7d91b40621c'
         '20a557f37b1ca4d01cfb267c37ea3cf9'
         'd0e1e9d489ded79e7d4abd9ece9daf84'
         'f8e815dede20b36a0be3a992390c4040'
         '757678510c3007a5d64d332337060d70'
         '86dbd9956c0fc13b0cf5f31a4385766b'
         '601c3712283188fb0bfdec14fa5287d7'
         'e5713b8ccfda6de1b04e601a1a44e21d'
         '86b44efe2ed9af023bc631ebf48b047c'
         '70165e3291518e0bd0f8e0c721482b15'
         'aebbfdb3571ca24f52c2d96b1835b8d4'
         'd2ef58e65371cd494827a1524750f3df'
         'ea9bd76ea11b2789c2c37867cc4bc094'
         'b0af791b70e745ed6faaa9e25cee6d54'
         'ef587fec757906314985c4ad9a89641b'
         '7e43a52683a042008652b611ef507cff'
         '71b016192f2ce6ae50a8e75673d99a28'
         '35fbc20f9d48d2453552bab513d16fed'
         '7bb7567dbe2e1d56974aa86f89d10091'
         '5de21ad8903efb0cc0581f0fc276cf04'
         'cf2f9128285022413834c1863dfd71b4'
         '5626b77aeed748d41f6ccae255a58ad4'
         'a4bed4dce9cf5c72adbccdcef225c979'
         '92f68ffe07d4b04391c59c17c3396bf1'
         'a3e1106a5367abb3585a5548b2c1e516'
         '585ea8d9bbc1d8f1b1a229a628f7ec54'
         '9d66d6b64619808ddb946d582ca3f016'
         'bb87595fbe16e3b68a3be965069a6577'
         'ce189d1dae6092d82916e5b02de612f0'
         'de18b9b7c3e670993d98bdc226ab8b3d'
         'c5a2e521b99a2187fed7ccc085f009ea'
         '7acb911f25b245893b8de8b2914b7c72'
         'bf955ccdf88457dfccb2516ffd9ef1e6'
         '5e30b8fc4916f4019b95e6a922f01ff2'
         '6066fa9660947ba801eb04a09c2678b2'
         'f55ad1e0a18b8269da14c777e13ea564'
         'e858fb47ea8cfe846cccbeac621be99c'
         '59f7c58160d1da46d6214e64acf6b889'
         '81af910f890a3c1e0e9886c3776a7302'
         'fdf15dde30503027d36ffba33e9dd292'
         '5c971f4de50413217d9c606c14aa1002'
         '8158721598768b4e3c99ad38be267019'
         '335eccee6dc2711b1ca29b89e0ae1ae6'
         '7dad3cf5e1064c3ab8254eb280a3aa0c'
         '8e2ae8c57182226b1fd5b1a6d4c3814b'
         '5a4c778c239c3918644db2a7c1ecf045'
         '9452feec6b9bb1dd740496d23fefda1f'
         '7f206182661b3602c94dd42b4f7e5d2a'
         '4fc69e0509caa122ba28d58f35eb961d'
         '39a5951c2a990efddd816ab4287436db'
         '8429d20bd862623eec7f27480871dbc2'
         '46e93ebd76221661adaa954e1f013b02'
         'dbb6a83e931cbd70755d115828d12a5f'
         '81697f930357d8e311724b9fad869351'
         '06605bf7bc4b48095534a8e3d0938184'
         '78495ff7f2c18489f8792c215d5a1d5e'
         '027e6d13ef426a8fd7a9b47ab439f7e6'
         '41b41d8cf8837439dceadb7654fadafd'
         '4f0e635bcfc9f03d432b6967276a36fe'
         'c6a5f980cdb42bb20356bec66f9571d3'
         'ee100ed636f96e9e50007a25b558a67d'
         'b458132e4c083beafcff78751d9edb29'
         '6a92ca38d0938af395b04c6c0e0aad83'
         '30331b87ac23d103b865f8985c57f603'
         'fac9bcb3f4cf9798013176d89ed80426'
         'fb9da053854890bb27661a88743e5862'
         '371edb81023b6d58eb124cf7bb39a5ae'
         '8ae9efee4607a9cd27447cad4e690d78'
         '33a808ff588f99faa81087a5e9045736'
         'e8ecdf264b002dffb11bf205b1394b59'
         '200f7ce32cf5390bbdafaf90b4326ebb'
         '8086fe25fac4d2a5fc6c3292151ba8c6'
         'e4834fbc889d0c107fa6ca2e4c896424'
         '0fdcb440b14a40b3dd669c05230bd71d'
         '9730bca3aa7695734888fe43059a6609'
         'b9367f7e8215623d9d4dd3d9d0ba4ba8'
         '05fd01259727c186d26d67f028b39aaf'
         '0fe097e656b4d62aec68fed4394da655'
         '91b750f773a83aab96bbb3cc3d0a970f'
         'c6e92d9068011dbf9bc118d549fe14a0'
         '559d2db9c84c291c09de8b4cc9a87a6a'
         '0fa121c21df70980b522857d2d292e4f'
         '118d80bfe457c882dc4e82ebd18bf00b'
         '39fdde86de5c1d48186fd77e86c22eab'
         'e31d427fb0e3254c7e2430b2c43031a8'
         'b29d7026796dd83de0177ecf1b49f12b'
         '9240837a15c6d9f307235e3b574ad379'
         '3e0cfa15b40b6a241f0243f869dc1106'
         '6fc1d581287a16737057b921423415d5'
         '3b3c99cbd869642783fef11048e405fc'
         '6790fc4a82ca26a2b23fae417faec37e'
         'ec4482ccaf70b0fd3545ed6895729614'
         'b2f242af117d84abd0e62a81afcaa567'
         'dbfcf8c8cb3d59adaa02b5944382fb36'
         '1dd272f260cb935b2e32294ada2be282'
         'dc81a01d91df01c6fa2c6cac72332b6a')
