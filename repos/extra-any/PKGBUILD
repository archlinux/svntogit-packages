# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase="libreoffice-still-i18n"

pkgver=4.3.6
pkgrel=1
_rcver=${pkgver}.2
#_oodlver=${pkgver}.0.beta1
_oodlver=${pkgver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af           "Afrikaans"'
  'am           "Amharic"'
  'ar           "Arabic"'
  'as           "Assamese (India)"'
  'ast          "Asturianu"'
  'be           "Belarusian"'
  'bg           "Bulgarian"'
  'bn           "Bengali"'
  'bn-IN        "Bengali (India)"'
  'bo           "Tibetan"'
  'br           "Breton"'
  'brx          "Bodo"'
  'bs           "Bosnian"'
  'ca           "Catalan"'
  'ca-valencia  "Catalan (Valencia)"'
  'cs           "Czech"'
  'cy           "Welsh"'
  'da           "Danish"'
  'de           "German"'
  'dgo          "Dogri"'
  'dz           "Dzongkha"'
  'el           "Greek"'
  'en-GB        "English (GB)"'
  'en-ZA        "English (ZA)"'
  'eo           "Esperanto"'
  'es           "Spanish"'
  'et           "Estonian"'
  'eu           "Basque"'
  'fa           "Persian"'
  'fi           "Finnish"'
  'fr           "French"'
  'ga           "Irish"'
  'gd           "Gaelic (Scottish)"'
  'gl           "Galician"'
  'gu           "Gujarati"'
  'he           "Hebrew"'
  'hi           "Hindi"'
  'hr           "Croatian"'
  'hu           "Hungarian"'
  'id           "Indonesian"'
  'is           "Icelandic"'
  'it           "Italian"'
  'ja           "Japanese"'
  'ka           "Georgian"'
  'kk           "Kazakh"'
  'km           "Khmer (Cambodia)"'
  'kmr-Latn     "Kurdish"'
  'kn           "Kannada"'
  'ko           "Korean"'
  'kok           "Konkani"'
  'ks           "Kashmiri"'
  'lb           "Luxembourgish"'
  'lo           "Lao"'
  'lt           "Lithuanian"'
  'lv           "Latvian"'
  'mai           "Maithili"'
  'mk           "Macedonian"'
  'ml           "Malayalam"'
  'mn           "Mongolian"'
  'mni           "Manipuri"'
  'mr           "Marathi"'
  'my           "Burmese"'
  'nb           "Norwegian Bokmal"'
  'ne           "Nepali"'
  'nl           "Dutch"'
  'nn           "Norwegian Nynorsk"'
  'nr           "Ndebele (South)"'
  'nso          "Northern Sotho"'
  'oc           "Occitan"'
  'om           "Oromo"'
  'or           "Oriya"'
  'pa-IN        "Punjabi (India)"'
  'pl           "Polish"'
  'pt           "Portuguese"'
  'pt-BR        "Portuguese (Brasil)"'
  'ro           "Romanian"'
  'ru           "Russian"'
  'rw           "Kinyarwanda"'
  'sa-IN        "Sanskrit (India)"'
  'sat          "Santali"'
  'sd           "Sindhi"'
  'si           "Singhalese"'
  'sid          "Sidama"'
  'sk           "Slovak"'
  'sl           "Slovenian"'
  'sq           "Albanien"'
  'sr           "Serbian"'
  'sr-Latn      "Serbian (Latin)"'
  'ss           "Swati"'
  'st           "Southern Sotho"'
  'sv           "Swedish"'
  'sw-TZ        "Swahili (Tanzania)"'
  'ta           "Tamil"'
  'te           "Telugu"'
  'tg           "Tajik"'
  'th           "Thai"'
  'tn           "Tswana"'
  'tr           "Turkish"'
  'ts           "Tsonga"'
  'tt           "Tatar"'
  'ug           "Uighur"'
  'uk           "Ukrainian"'
  'uz           "Uzbek"'
  've           "Venda"'
  'vi           "Vietnamese"'
  'xh           "Xhosa"'
  'zh-CN        "Chinese (simplified)"'
  'zh-TW        "Chinese (traditional)"'
  'zu           "Zulu"'
)
md5sums=('0aed40e6bf15c2c622ca23f9c10aea03'
         '3c487dea5226b17d8bfd966fc000d1e9'
         'c8aac58768d78cbe64d880ac3c1cd6a7'
         '5909540e08da4a0341036142a535847b'
         '54aeb4d284014acda33cb7f7d2d3208a'
         '77e80d39134de31fa6a48e86627f4bcc'
         '16f7092593525b6b97d3886d0eecdbff'
         'b0226a3b0998739fc1b8e1395c7d9f3d'
         'f0f144da089a58195cd020c416b5fdb0'
         '1e4065a213ec2757ab51a1af36aee2b7'
         '37aa3f5950a0bf8640ed01751b2892b7'
         '53280833765862c356d5876fe34a34a7'
         'd78aeaab167b07e06696a5b8cc387c86'
         'fb9f4bc0cb348bcedcae9c0fc23e09da'
         '0500c53d142f504c6ae6fc2d130a3e87'
         'e38f24abf2c1e6f031a15d61e25921fe'
         'dfd70c7b498d9f70e0f57c26053a7558'
         '5cf418d22007bf81ab06446b232eed8b'
         '2734fee265934ff596e77880f3d7cd00'
         '835409307c4cace2b188ee0c0f68ab10'
         '57bc5c1fbca382727cefea9f8a654eec'
         '735e6d7ac74a65d9d30784ff339a6afb'
         '708ecf293dad76efb56e5b730758c61f'
         'f231e9276af058a819abee5b6f1e5cd9'
         '646a05165c25ec6fb984252faa091af5'
         'd71f0be4a8ad2cd869203e03555bcc2e'
         'ae4113b9d48ea81f3922dee9449acb27'
         'aed56bd7df849e9086b8bec8d6e6cb75'
         '7274e84c731a210ff167acb8f9048030'
         'c95eee2f856b1729c4d1f5652b946f1e'
         'eab1ac39a31dab2dc0dced9a447f34ac'
         '9001301816f177716d95bd008a20b4e6'
         '77559b40af916e463fdc4b428b1941af'
         '6abfb5be7338bf6c6df8b34a74fc034e'
         'c3e8a8f913d5a86476c03ab0603ce0c5'
         'a9782fb84d2a5acb3fd57ce398c5b2f4'
         'cc420ebfaf6c361d82c4ed680cc0089e'
         '8b7a9cc82e2bf7b2ea6a5c2f16ce0f7e'
         '93818a7647733719e4807cf12acf9fab'
         'c8abc418e1ccc09f6369d7a05c9a817a'
         '030941cd86e870dd11b96167f8e56e34'
         'b69f49844b372f3977705434111ca087'
         'fd8eb8032a73627062bfbb432c764575'
         '53e4a84372563b46108cc8c3a7e6073c'
         '530a02481e3935c30a49c10e0056b04c'
         'a01066c3204c149a019da09590537566'
         '65cbb0c879f0f33602e8d4fcc864e929'
         'f24edfeeb2cdad078182668b1cb6d882'
         '817f3fddda3c8f840c77e07e8520570c'
         '087b47a35afa5d94aee9a66e90c6762e'
         'ffc2e5241462e30748363a3eed1cc0d1'
         '86614938862d949ad48b1e537f726f97'
         'a911ea6abd6c3da238d5a0ff0897b96c'
         '421f094fa4498e90af34a5239ce96a3e'
         'a2636aa3992c91cd5d398ffd50dc6593'
         '8816bbb98bccf1f97955d43d4f1e13f7'
         '406c6dbea14dd548182ea586e3993f9e'
         '8bb3cea35b6fb863e9a04b0ede40be32'
         'b6e87dcdde64f920b0663335a130a1d5'
         '25da26396f63f5d98a454c5c892fd97b'
         '2df218dae320e89e8f2e2fd2f80e3589'
         'e0e5497e735b51e79eb5516426682797'
         '9acf87eda41434d89cd7fa222cb12870'
         '8fff208c8b4fc6fc674172d8a5151ddd'
         '995417c6e8cef4c683cc25b4eb6fcb41'
         'b2788a5e8d9d300deaf7fe728f4de436'
         'a4caaedf6dd5a9cd197f7346ec8f4d6a'
         '98085b30920fe1cd97ab751621139060'
         '81af8c0d6cbae71314295eb9910e8fbd'
         'f4706ea20ac529aa49dae572dda23878'
         '5ae58f26e7ec781a3a697c484fb5c59b'
         'ce5087b2432b0ae1a1e942e8c55050e6'
         'b654cfcd0cd4ca5781d95c426f8190d4'
         '4c52045f90e9b783c41c377a6c7b2666'
         'e8aa6a67443e8f0ac9b791716dbb8249'
         '239352895238fbf12b2d105610c7ddd9'
         '7deb20278955e11e78537941d1c1a210'
         'fdae90e9c65c5ee1ad23f4fc1c153bf1'
         '58da6260c6eb6343a50166bc7d932d2d'
         '8b02917e9a138c5b8c7845ced4e96f94'
         'b1710bc845b87d11a490b0195fa0d541'
         '94f0ad09dd76347079ecbe31857aa5e4'
         '783cf931191762855a3a22c3e3fe31cf'
         '05b3878e9f88223bcfa98637d0d0a9ae'
         'feadca611d73a3cd3bde12129390ed9e'
         '3fb95f91d87306b0d04633806ca118ef'
         'c9d7f372acf9862589c33a91eb197733'
         'e15e1ce6d43903f694eb7d7392caf84c'
         'c5993ddde30a12193cb334844d2dc5c7'
         '4c46867eb8c7cabe8f67b9172df5bd48'
         'fcd9544f3c11ae65c243b11504fbdc43'
         'd530a5832d2c53d27f8abf9d63c4fa38'
         'dffcf8aa6fe3f909f6c7116e53a9eb13'
         '32afc435c6a6db74bf266f90d2727a63'
         '573d65362397e73b6dd69185f20ff221'
         'f16380aad2bb96f6fded4fdc09b58cd0'
         'd42dc222e4575947f920b24f00b4aae4'
         '87c2c4be9ca2d397bf147fd0565291ba'
         '3281d5001892ff402cbeeafc9dc444e7'
         '4b11cd03d7902075f3000807b5e11bb0'
         'c8a61e12069c082b0110626123767064'
         'ad0245a2c6a2dd82d074f307ffe12322'
         'a178101ca747c1891d3439b45fde2cd9'
         '3f23bbbe6cd07d6acc626b38df229eca'
         'f08565d896cfa05a16b204d8981fd06a'
         '3e8e7d3333c4022d71eb64fcff999e48'
         '33e75f1495747ba183b1a18b094520db'
         '8ee81082a224f98baaf499271b7498c4'
         'b82f06f56144b9788d138d537e95b249'
         '63fc457f63d8bc9f8b966efa4ddfd60e'
         'fa681bdfd06c6e8697d5ae11d3395347'
         '64554a73ca5dfac818a6b4316ddcb7d0'
         '51dccfdc99e60805f529a16d3c32fa90'
         '923a8812e02e617519f94ce6aca58d40'
         'bc9766ae007b24506de17f023ece0b78'
         '0a69d48126a1f6cea37f3f24496957ed'
         '69b95cc54497d49aa17fc1b42b28c2fb'
         '036d4a45a9dabe7d91a607614b39abf3'
         '3c6818a630047825fb3eed5026cb383a'
         'ddeeac2d03bd67271a509996f093f2de'
         '4a97d057addd579adafa819267ad22c1'
         '5d19bcbb6cb181f74d65e383bc633999'
         '3452a847ddf362b7b7d350485143faf4'
         'c3995725e200ab01272d1d34aa05a732'
         '35e97d2787e941802e4ed660afbcfcbd'
         '82dcb8de572067baa499608e4e062850'
         '6658ee18544d9c3338011fde3527b1c8'
         '473314054ffc379793506dad79478d10'
         'a84fe210c8709d3fd55504b1bd3fcf6b'
         '34e65a532ea3b79fbc44bdde246087a1'
         'e2b47c11f3e5a6d07800844a4cbca535'
         '134b162f5c94efb2ba1b812cf515a531'
         '20b77fc474bde62f1d1d0e04a34f1a94'
         '18af64503f1999d61c8fb0588fe75fbe'
         'e3fce5686593ae9b9aa04e05479aa865'
         '2a87063005d9d713010abdab7901f099'
         'e9f148e5d94de9b9a580b3be7463351c'
         '854ecc82026cfd8ae0710b5188e82a26'
         '15b692f624783838fdc687cefe615534'
         '7820ae3f7886f56d7e3561a9e648311b'
         'eacf0ea8c3bc34199185ff7240a082b8'
         'd915059d662bee6c6110864e52181b11'
         '4c2643b70dfd4c99cf87a32a836f41c6'
         'e9e7a27172a695e6f8fd58fb29e3c4b6'
         '7efab6cae5a61eb0f145139eba005aca'
         '0c1f55bcd85520ff8102ebbc3db93708'
         'cff965acb9bd6baa83283db8f9e42552'
         'c2de48c8878132924b4eb05c3b57e92f'
         'b7b78af8ac5127de01e3dd5125317c48'
         '694fd41116ad14d8af81636cd9b9c7e4'
         '56014dd9384e25ef3260fa530f588e04'
         '34ba0e2e4142d5f3231168c7fe306be1'
         '67470820bc8406a5a069ceaea31daaa2'
         '50fcaee49a0d1760345f138b27bf1522'
         '3344b7d42b0b03ee5302231a45c99c6b'
         'bac32d6b9a8d872631ac591888dc2042'
         '1bf49e15bbc9e4cdc7b25e56e5ce7403'
         '4d21fa70df29388c653d64bfc407d5aa'
         '17c734191ae6cae7c284b966bc5021fa'
         '243da3b72b1b460515cb5fadb707b548'
         'eac03cf987620a331c6b62ed3aa20057'
         '531875c45617a31a06967b47d6200dc4'
         'efa0d0358d91a1fb5fb47387a17787f3'
         '6fffe5f58e997db351b3cc4522d14604'
         'dd21149a59b479ab8753cb40dde931c6'
         '224dd3ef8075cf8364c755a50efc9d87')

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/still-}
    
    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice still branch"
  provides=("libreoffice-$1" 'libreoffice-langpack' 'libreoffice-still-langpack')
  replaces=("libreoffice-$1" 'libreoffice-langpack')
  conflicts=("libreoffice-$1" "libreoffice-fresh-$1" 'libreoffice-fresh-langpack')

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-still-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done

