# $Id$
# Maintainer: Thomas Baechler <thomas@archlinux.org>
# Contributor: Jaroslaw Swierczynski <swiergot@juvepoland.com>
# Contributor: Michal Hybner <dta081@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgbase=firefox-i18n
pkgver=31.0
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox>=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'csb    "Kashubian"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'nb-NO  "Norwegian (BokmÃ¥l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=()
source=()
_url=http://download.cdn.mozilla.net/pub/firefox/releases/$pkgver/linux-i686/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

_package() {
  pkgdesc="$2 language pack for Firefox"
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg br csb; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}

md5sums=('4001255d66f53c3c0b3f60b7e019be08'
         '232da80653f289739eac21fd9a253944'
         '3bd5f576092f24ed21bb901535ce3cd4'
         'f49f2647f6b8dbe3572efddcf02815f1'
         'e8bf3b143331407edc17d2f6b203df34'
         'fb0158a5b8df48e5f3b894c961fa9f17'
         '812293dc31ca9e090806c9e66b9d3862'
         '7e19f83e0acb5a9156771f0bcf30d4e7'
         '68ecea1d2dd7269113be09a5c29fe3a2'
         '13efc14e3647116eedae04be439d39f5'
         'a4de709cb2298847befa1da0d4cdd5a3'
         '3ef31a78f29121aafe75e8ab21ca7712'
         '3e93477ee3b9d4ee0e43e6b30ec519f1'
         '5ae391f02d6990ca089dd259e795f932'
         '0fb88cb2bcacf693cd92c160be459f3d'
         '606bbd598cbed3cad1692a11cd73861a'
         'a0dc47722ed0d0f0ae962dadc505889f'
         '1eb1ac92c6dc2d5bc782c44bcd03c680'
         '5375d654148882bdbcb54eb19ae669df'
         'aa1b55476dab6bdc5fe56623cdcf2509'
         '4a43f05382b10f7688e7d227826c95fe'
         '68a81b8882df8dc2d6f1bea6eabcd662'
         '281a2e1d06c905adf987df12cb9c7622'
         '5622921185fe9208cc1a3e3d0dd473a0'
         '31c38061976141b87d836989a7331cdb'
         '6137543aa6b23699f78050bc785467c4'
         'e1ba0c988be37c6d0aecad133b047b06'
         '1297199a0630fefded4f14129eb440f2'
         '3bcdb3f5e031b4908baeb29014a0300d'
         '07aa134fc9e244e9aa6aec1b607a25db'
         '5021e9190987ad41235b5b1f33a64752'
         '03ddb15744c2fb41295f36d8da13feaa'
         '3fc297389f90ce8784160df72ca05106'
         'ddd88ae8577823891d4ca878ba617de4'
         'ecb252f3729b968c2155e346fc7dd05a'
         'eba5250d06f26237420acf94fc918e90'
         '8d90fd5f33aeba1ba4b6f5936906b0b2'
         '4b42437a04db82efef49c35dd93dab8d'
         '5da5f7cc33cc04a5d96717502bb5a32e'
         '75bb4011d2b8c91bc49ff2a1f82b8046'
         'db86db1a0f8daca6dbaed63388679836'
         'e54d0e5980f5a6419c71e0fd32efe723'
         'c1337128a4a858b2469c65e5c7663a91'
         '8ab9fe2aeacb2a6ef0275f00706784f4'
         'fe36dc6622534ad2ee7a8a99e9540bb9'
         'cd8c60e848910c9e5e106157abed1cfb'
         '1ad321445c0a7f73e2480f32de0dffb2'
         '50fd5e5b5c695cd6792b6782db5ac58c'
         '7b51f88b60938c23837dcefebc26d847'
         'a529e6bd7cdd671301d5c28e54d09e68'
         'c277337ec48beb3f5e5c79ae8b20dd03'
         '87a3c21cecea3b6a504f7ecc58b66bfd'
         '33382803f73987aa6b0af0d90dd5b5e4'
         '5f516e4aadbae948e5d2268ad23aed23'
         '4ef76f2f5a24b07ee739e178f4737168'
         'baef852014a8125db7d8a7a1e9b0e113'
         '24487b9f9a4b0af0097277a02759ab0f'
         '8e247f71aa9138e9e1edf6dbaab05bb5'
         '5f15b9d4d483d2d3034516a84fa372bc'
         '68e358e4605d821653b408c1ac61dabb'
         '517167686e7c7d2f044c6616a739a7fd'
         '9b5dd6fec2cd6f150c13cbf449fd013a'
         'dc0cb12fe49b936b1b4e3fcebc38fc96'
         'fd47cdb088ac8aba27dad3cd793d32d8'
         '7a024f33fb3e5b5d5cd3a2d5fc1beac3'
         'b507d0e1246fcc4bc80bc17baa0e176d'
         '1118e6cdd139a078358c1c596be0d924'
         'cc939b7c7b0afb213934832b7ba27598'
         'ca866f12a9adee2573d0cc64b4b2c258'
         '6e5f8161c9df578abecd23a5c20aa86a'
         '34fc712e7b858c9b00085280a64c4c62'
         'bebce4a8cff4491c120dcbd1234df3e5'
         '5b61dabf5a77ca9173cd85399ccdca0e'
         'a9fd632dfdd31164b9cfd77a9add5a02'
         'c869d0c309bf555edd8eb11b5b9683d6'
         'f7ac9c2b75ba62b53ac8f42926951efe'
         '6a69af99bfe8a53cb0a1986c2884a70c'
         'be618c053acd190cf60a75b4572c6487'
         '561c488f45adf30935d7d4b63414c5a2'
         '904b9d34f810dd8bc54b9581cc62d1da'
         'da33bb07afe75289a51c885337b51bf1'
         '876f3626921a6bf38343b4c16f361585'
         '568d101ca931c269f3e4921d767bdc88')
