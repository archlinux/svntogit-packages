# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase="libreoffice-still-i18n"

_rcver=4.2.6.3
pkgver=4.2.6
pkgrel=3

_oodlver=${pkgver}-secfix
#_oodlver=${_rcver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af           "Afrikaans"'
  'am           "Amharic"'
  'ar           "Arabic"'
  'as           "Assamese (India)"'
  'ast          "Asturianu"'
  'be           "Belarusian"'
  'bg           "Bulgarian"'
  'bn           "Bengali"'
  'bn-IN        "Bengali (India)"'
  'bo           "Tibetan"'
  'br           "Breton"'
  'brx          "Bodo"'
  'bs           "Bosnian"'
  'ca           "Catalan"'
  'ca-valencia  "Catalan (Valencia)"'
  'cs           "Czech"'
  'cy           "Welsh"'
  'da           "Danish"'
  'de           "German"'
  'dgo          "Dogri"'
  'dz           "Dzongkha"'
  'el           "Greek"'
  'en-GB        "English (GB)"'
  'en-ZA        "English (ZA)"'
  'eo           "Esperanto"'
  'es           "Spanish"'
  'et           "Estonian"'
  'eu           "Basque"'
  'fa           "Persian"'
  'fi           "Finnish"'
  'fr           "French"'
  'ga           "Irish"'
  'gd           "Gaelic (Scottish)"'
  'gl           "Galician"'
  'gu           "Gujarati"'
  'he           "Hebrew"'
  'hi           "Hindi"'
  'hr           "Croatian"'
  'hu           "Hungarian"'
  'id           "Indonesian"'
  'is           "Icelandic"'
  'it           "Italian"'
  'ja           "Japanese"'
  'ka           "Georgian"'
  'kk           "Kazakh"'
  'km           "Khmer (Cambodia)"'
  'kmr-Latn     "Kurdish"'
  'kn           "Kannada"'
  'ko           "Korean"'
  'kok           "Konkani"'
  'ks           "Kashmiri"'
  'lb           "Luxembourgish"'
  'lo           "Lao"'
  'lt           "Lithuanian"'
  'lv           "Latvian"'
  'mai           "Maithili"'
  'mk           "Macedonian"'
  'ml           "Malayalam"'
  'mn           "Mongolian"'
  'mni           "Manipuri"'
  'mr           "Marathi"'
  'my           "Burmese"'
  'nb           "Norwegian Bokmal"'
  'ne           "Nepali"'
  'nl           "Dutch"'
  'nn           "Norwegian Nynorsk"'
  'nr           "Ndebele (South)"'
  'nso          "Northern Sotho"'
  'oc           "Occitan"'
  'om           "Oromo"'
  'or           "Oriya"'
  'pa-IN        "Punjabi (India)"'
  'pl           "Polish"'
  'pt           "Portuguese"'
  'pt-BR        "Portuguese (Brasil)"'
  'ro           "Romanian"'
  'ru           "Russian"'
  'rw           "Kinyarwanda"'
  'sa-IN        "Sanskrit (India)"'
  'sat          "Santali"'
  'sd           "Sindhi"'
  'si           "Singhalese"'
  'sid          "Sidama"'
  'sk           "Slovak"'
  'sl           "Slovenian"'
  'sq           "Albanien"'
  'sr           "Serbian"'
  'sr-Latn      "Serbian (Latin)"'
  'ss           "Swati"'
  'st           "Southern Sotho"'
  'sv           "Swedish"'
  'sw-TZ        "Swahili (Tanzania)"'
  'ta           "Tamil"'
  'te           "Telugu"'
  'tg           "Tajik"'
  'th           "Thai"'
  'tn           "Tswana"'
  'tr           "Turkish"'
  'ts           "Tsonga"'
  'tt           "Tatar"'
  'ug           "Uighur"'
  'uk           "Ukrainian"'
  'uz           "Uzbek"'
  've           "Venda"'
  'vi           "Vietnamese"'
  'xh           "Xhosa"'
  'zh-CN        "Chinese (simplified)"'
  'zh-TW        "Chinese (traditional)"'
  'zu           "Zulu"'
)
md5sums=('98b6410c9413ea81a0bb2fa23796b9d6'
         '8816033df33d95ddad58f622522fe910'
         '52260374690efe21f74dfd4fcda47b07'
         '9293fe26e953b920a5515eef70531cea'
         '0fb763141c4796e466705e6ebe49f7f2'
         '897be8bd1f1fddcd5d42ef01795a0d28'
         'e1334961713cb36f700e174a1aa0766a'
         '15a2241c5eb1d2dc768ed918c44a1e8d'
         '3f16bf4586133ae09234c3db2a2cbdc9'
         '3fe0851500822b284591388025ee8f93'
         'e18dc2e861cc255f43db15156f842cf8'
         'ec84243810a4d3d9ddefc622f721bbcb'
         'febe44e6e81801e4248ca578a1793d73'
         '4c4011742c030a6b8806be0a8e08e1c2'
         '40228f4fb68735826e352039896a74ab'
         '09490b87c65827a74e8cd1c8a299baae'
         '89715f9957020480398d75ded26c7acb'
         '2db6a716db67ecac5e6ff4f123d42098'
         '1ef18cbcc6ff9b14a58662a8f8060e01'
         'dc57d50659dba96ae8abb66379c8f817'
         'c0305b188a7d541be015858c59077099'
         'd1437517b2e8c39641ab99e107308b08'
         '6e8672d4f93104374f5bd26c30cf0eec'
         'd0395a025572d57bb0130c4a47a86806'
         'ae043e5b419f6dc6e5b8bacadb1a4922'
         '18df1bf91c18d138030e7e306a6dc55b'
         '7678e24dad9066bde9cea2ed530729e9'
         'b443b7a54eaf8a77358755e3d92c5220'
         'e5197f14bd1f2da5ed327c26e816738e'
         '01e979685e35db8246d781226bb11d07'
         'a8d1397ea3c4a184614bfb57e3f9fb2b'
         '6870e130dd16919c7ed679c6a5b8ca7b'
         '179f53fc5040dbddbd91b0a754a755da'
         'caab10229154ccdf53e4a4cfdc5ed732'
         'c8858146b0badbbf87f9edd87ff0722a'
         '5cd177922b95f0656d17d99f0fa7cfd7'
         'a27878684f444c32e795b8724cd521c5'
         '6f30fdb0aa8e1a5e477ae53ef74376e6'
         '1adbcec6c96097eaedc8b5c51b4afb09'
         '0430a19074e193dd0ac937266082c9bb'
         '7723b7b5feec796d63640d07bf9f69fc'
         '20196d85b8799fdbb3d6ed023c5fb9a0'
         '02002f0c8e78531e2fc225e67684dc71'
         '16f2cde0096ba8bca590b5953e63e8f7'
         '5ef6c24f2bf6560b14a71b5939a43367'
         '3ab2070139e6980af4d56543fcd0b1be'
         '6230340484b78cc7ec92151a803cccdd'
         '24d764fda8257114e19324f6a956fa92'
         '70df28bf5fc92bae7b35feac15683b50'
         '5cb80b5e1a762db40c35f2349de54da2'
         '947d1c4c97f99213c51f442d86670277'
         'cd4cc22a985dde62e330f77612e2f4f9'
         '4c52358539400bbe6791f07981958681'
         '84a273b037d373a400955582b820ff9b'
         '47f9d9d5cc14c8220c3c386b3eb9caa2'
         '7d63102e36d30c45749851f4d72577ac'
         'e56035f0d0d322d1e838c0ca124e9f34'
         '52454324ee43c01c27fbe04a4b0c3c41'
         '9bbe074c58fce0a122f3c6abbe1b96e1'
         'e5ff5cfe98c15cf7447ec1da4a5e1cec'
         '1441931ff70a2afdd351acdf25b76fbc'
         '2f839a8a3ca768e33146d653d46a6787'
         'c5ffbb05df00f2760289a0e96641200f'
         'c0fd379e5ca362d239eccf561dd4c299'
         'b8998bad06ff79e72cb6426a84c1c67c'
         '11c2e489d1b0694770ebbd2a724b71a2'
         '359288cf3e34dc3037c12f8b926cb7d8'
         '61ad58ff170c0754ff75d0964b4dc4c6'
         '1fb155c903c0081bb9e56b6fbee121e0'
         '661b3beb5c115df096c86748c9d5f3ee'
         '1bf5f47955922512651624f71df15868'
         '7226c9f5736288ecf386c36d60b81a28'
         '40d8a28264eb24a0f537f5daf172c098'
         '7aaae00513b55f1dedc51bcbd08d51b2'
         '0125f7afcdad5810e760f975ec2ca390'
         'bcccb4e07d20fb09d1efda3e03550c26'
         'b95cf6713007073534c2acc2d3b56b83'
         'c3f00993425c92effd957b96e08f930e'
         '2691987164951e07fcf609c06e4d7ad3'
         '66e2bf4391e50f6efb2e4e979487dc40'
         'fb573ac479c84c29d675815cef1c4f5e'
         'dc214d1f276d2ba2c331bd1f6f82ee3b'
         'b1925c7ce43d5923c91120b13078dd64'
         'df44a5ba5682b163e5b104a026f473ba'
         '7d98fbce3f63952b751956d44af38031'
         'e1a50c01f86588b0c609ceef8879345f'
         '6c432e1534a39f40f1811ac8a7e5c57b'
         '3938313bfbdc0776ee371354955724cb'
         '52a4e2706dd0029eb51f8da966cf9b58'
         'fb71a2b918af6096866607a6b3e4d97d'
         '0a4d207c1fcb52955c27debcb80827fd'
         'f47df29f2325e0389b5b3dff8f8d7ce7'
         'b5eeb2a74ea731a8b90683040dab00f6'
         '05b6cdc6bf400f6be5d8050160db3925'
         '5bc3c592ad24ffec45351dc1117ce1d5'
         '3fa6584ba59c6633c9770adf2292e210'
         'f1e273eb0ef4179a2a23e66641c3ba39'
         'c669855b521f5ee3cec04d1a6c46ba68'
         '75edda1ac01487aec2f2ddc919837a91'
         '4063934cae84db78b346dfab5465e59e'
         'd4fdc5df0a8998a58a5d4d3b424d03b5'
         '45f497a5a7224082aa300f857dbc3216'
         'd13fc06ce2094922fe67b9e33f25bb71'
         '6c865b0b5404c74c3b8f9d7d7597c532'
         '1e20912e710994caf224b4ba7f17a9ad'
         '29182211347c876279b00c4817333e7a'
         '56001c615d29276c03a72d52f436cf4e'
         'd287b43c2a26749cb82e8a296444c7c6'
         '1bc92dd35b799a10ea317e8be4576400'
         '3005ed4e4e7e87127b2592d52a13690d'
         'd64966456ebd2c103408fadeaf1d99d3'
         '33ee55de4af630edffb392c5b8cc846b'
         '0f4e357a4f71aa8db60287de845785da'
         '5b3c57f142f6bb70e333e6bd8e5a1726'
         'd7d88cbf70ebb9d73c7701a42a668f05'
         '8ce5ab182e657b73d9d0cf3d8d7ef98d'
         '31f734ccb5632819e05216f8177a069b'
         'a7a893da02c827ae2c679031a20b2b2d'
         '7a1408042747eb1ed7626e5879c56be9'
         '440e2bcbdc0a796efd6173db8923280b'
         '8257d9081be66d56c01934f8b88a90ae'
         '7608c066987dc03762b592831dc2cf27'
         '1d2761b510117b191a7d6c8696aaa2a1'
         'fa4731afa6bb0bdfc61941febd924dd9'
         '4a6fbabf41a297bfece863ae1b5cc175'
         'd525f483ed4f59861b73c85687ea55e9'
         '2d76a35b53da3c74a8c6a9c95eb89bf4'
         'd70bd363f0bd8d75f26c5d5f40ecdbfe'
         '5f5672fbe204d3a95126d0e06f03d526'
         '466fabf2582711eb03bd14370e446fee'
         'e3f358cf26eca98795f9bf719d054f38'
         '253ca1ab7ee06aa9b9ebbe4aec7d850f'
         'b5c495c9ddb435e111fe0e45a448c33e'
         '7f71b046787c7fe6d950c61309608221'
         'b64bc1c6686ad1d41983ed91e14fe7ed'
         '034e12db6bda7f11f627a5197c2d44b3'
         'c7f5c3c85133b8854a21209223a2ac45'
         '6bc73120860d71cb735bf84c42139edd'
         'fa00ca45d1826007a2208f5267d0fc53'
         'bdcd8cbea8364e6239ce18181e1b3bf9'
         '6d2371d0089f093f0b7f12af194ded17'
         '96a35a9d6dcb244842e0a21466db21d4'
         '2d59684c0292c13c53fce206265da25e'
         '6233b41be6581e0e8a6d6e6298d1b7df'
         '45f5bf4221aa8f6cb53db02b3f3a6ed6'
         '4421be7e577ea33e81340b56cd69e62c'
         '5b3ae66309fd7b641aeadc1a062e560b'
         '7bf7fd27f6cf6b8315d95b5efd6fc9c2'
         '6aaff4acd3a77d793e587ac6aa09b2f2'
         '4d14b28c70cecfca998eedb00177454e'
         '8af31262a608905a73e58b6d181a032a'
         '2d0c83f079b0dc5fdeee3e3c5390a546'
         '43ee59f63e75855c03a0d9210508761c'
         '5da7bda2517cf7f404d11c439d4ca8aa'
         '90e54e04765835e8b41568fd04b894a9'
         'e595b9304e55de01a3745c9f34c4f357'
         '13c388da6b1338759870d08d420049a0'
         '1b058c61b074ca261e3cadf2d9e59a1d'
         '7a6da9a6a27eda9a352a9f0f2a9ebaad'
         'd555b27c934c13398f1156596ddef8c0'
         'b3b3b3e421a87914db3dac30363d79b3'
         '2c5b87ecb3b8583110b8b49c4e319b67'
         'a288f7ad4c782c28c05374f65a137067'
         '494b33c98b1ba99071662f8602c5f42a'
         'b70f71dffd2d1b33438f7ce620180a4c'
         '374a241c733be04c2210813e559b7460')

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/still-}
    
    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice still branch"
  provides=("libreoffice-$1" 'libreoffice-langpack' 'libreoffice-still-langpack')
  replaces=("libreoffice-$1" 'libreoffice-langpack')
  conflicts=("libreoffice-$1" "libreoffice-fresh-$1" 'libreoffice-fresh-langpack')

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-still-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done

