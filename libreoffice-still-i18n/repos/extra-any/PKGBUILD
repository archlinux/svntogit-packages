# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase=libreoffice-still-i18n

pkgver=4.4.6
pkgrel=1
_rcver=${pkgver}.3
#_oodlver=${pkgver}.0.beta1
_oodlver=${pkgver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)
md5sums=('1f40adc409d73c66f0a926921e3e80a8'
         '2a365b1cafe19698ae9d996bd4422aa4'
         '46492279cbe8a6d642ab7d05022ffb9e'
         '40dc8852862e5f136ad45d6ef4d8b5f8'
         'be3390a90a3d92e2c8e2ce3e8e776ec0'
         '3055f42caa1e3cb2ddb21cf8319b5f39'
         '2a2e24a2f1a76a13ff2c034d9d248a1d'
         '5d43662b5528db36751bc667a4f03f34'
         '0b083dd0b7f2d35fd64b9139561691b7'
         'f8e3c6d6665230035e900a3e1613f880'
         'ff983d147571a86b50da1578f146f5ba'
         '542ee445bf0a4048edb293c55f08ae1f'
         'd79fcfc8d08037506779a60b672ba78b'
         'fd652f559935ebdc6862827c7b85149d'
         'a6de24a91e39672006d638e1fb69625e'
         '89e9cb4a667783922b43e2ef4c389e47'
         '80dd6e1e6893c14b77145d9d25735bdc'
         '68a241f48a46262800cbcf23512c7643'
         '08af677e780ea6717792b417bdd90a9f'
         '510ab639c264d932dc28599987e510ea'
         '3e62896cb1ff0967fc88c96427f10198'
         'da1d2198ca80c643c1e9d5336fbd3143'
         '0820cedd8fc5f503f6f95ce69c46976f'
         'f4ef4d11889fb790156a7cb11d3cad49'
         '2180731fa654faea1417e24c21a168af'
         '4afe7c6c1b71363dbef590ee02a1b3fb'
         'ad2b3316fde587c0f0c9a147a58a8269'
         'eaecc9d945d7f373eacef8348bf4b28a'
         '4b47234254c737cee6bb83ac35fe4ebe'
         '6d8dff3bf127427e587628c0a5d52c3d'
         '476750e38841d1e0dc990e35f6d1109e'
         'cdf53e61464532a9d7c3445ae325ad9e'
         '45b5e142bb66ac2d35b19379c0b24914'
         'ed0c7c79a90e776e04a6440f9ae1c6ad'
         '5ee8eef68d8d7f6d9837531bd52950d9'
         '072a3e69073d4a72b268d98f904b8247'
         '2d25d247f1775d073fd76e842df01321'
         '68a93a7ccaf23c60f776ca36b494935e'
         '1fa2d6a355c8ccc76bd392729f5f27b1'
         '94c19b7d613d0fd9b94943761c3a218c'
         '22e55225a729750a79f8f23a3c5cfc69'
         'feab278d74a17a7d00b8b9845031f56c'
         '6d759db2690be564b5ddda3358c08115'
         'ca1e276584459035666329f1a124ae75'
         '6d79438640f7e52c59a8252d4ba4e8b0'
         'b6c53bb2b3c16e9f6977754b5e47fd81'
         'e9fb5deb1c4815fc18a12d7da7cd6db0'
         '07f875d329bdaf75e0c795d0f6e54d7a'
         'd141c98c9007542c92305e0cd844fce4'
         '10b58d68dfe5fc87ae63962b79c19699'
         'f1d09934a6d14fbde7c4e1f8322e9774'
         '14fdb866be6dcc55ca472afa18f2a464'
         '45f530d14f2fd5035e1497c007f7410b'
         'a6f11fda35f4a0519deb3f7646f187c5'
         '280f9cf28a77bb62a2b1eb3c53ac7842'
         '03831dec39c0e26a94f2189432c69da9'
         'e27502e2e52436c1804de6358bbe26da'
         '10a098f5751665e04cacd654f5f9adf2'
         'f4f40077178ac353609951d95b7def0b'
         'fc266dd6c8acccee8d0c4e9b10068e97'
         '0b4f9947a51163d7ebbb507d41a71528'
         '3365989faaad445653b556c3f061e419'
         'fd8e3358d6c32b307ffb0dade7b59952'
         'd146852ba45f4d659a0f163620e29a58'
         '2b7dce1fb057cad704b7b3971e8331e8'
         'c67b35ac6fa924772ef65dfa55c54545'
         '48d6e8777dceea6b7517fce1e8b593f4'
         'fdf67d1b171020bc5440ee1c9eefc727'
         '3e9fc213106528828874f95ad8a5b946'
         '35cf32673397573018f5763142c1a39b'
         'c28f76c72c6d11f9e54c012ec7d8e9c1'
         'e4bd5a16bd33bce7014bd9903d4acc23'
         'c75420b3dc059f88a52580638c4385c0'
         'e264ba63aea9e6b42a20ad997b79d5d6'
         'f1b5ebc5a242a1a806bedc1f151ed5b8'
         '5654ce8ba2dab41a6130acd65e00b720'
         '3ce202bd4a9513d5e3e83fe1959f569d'
         '2d1ae01da21272938de187aecc005072'
         '91d2e0ba9aed2a4164bc03540145b9b5'
         '61ad02eb782148ca8199608263e2200d'
         '9975be10c10413b64983040299af7e20'
         '3c2f00dc66be4981bce71d8638fa52e2'
         'b81513e45c506adcad22174a35131a9e'
         'b0b04c4678b077c7b105e0d7e1dd7d1a'
         '71b28cf99d9b5bb12fbe9bcdac2a0cc1'
         '759d814b1541456ea9ea4c7ad2a07be6'
         'fca4e23f32399845eaf22d72e90000a4'
         'be9c0b93fa9904bcb589ccdf3621aad3'
         '6b86e6fd4b3c169d18ed1a73e705f34b'
         'c4ff83fe4efe7d702e847c31f24105cf'
         '3bef4616ff0f731e4724c5141e44a4ea'
         '1913ff6f803eafa88e51e65da64811da'
         '4458088ca0d942f147e636ab549fbf81'
         '73fbecc1a7bec3f2425568e7da0dbbf9'
         'f1f83b78d7222e424fbd153498dea7df'
         'e6857efcf7f212ffa5308673222d4e86'
         '200c0c46db35cc6020f9ba6ab4a2ff45'
         '2cdace91af8af2474104a69133a003cb'
         '929aab7b7699dc296741585768a6df20'
         '147a546eac2c9770f5b5ab4a90051806'
         '1220921080fe69b35f6f00644ca7df18'
         '9f68c82b9092a5277420676aac5b40d8'
         '6ddfbc1e358eea7d7c6e0ca347516553'
         '6cf2c79693ca5fd676c4afb3ec48c531'
         '6b072fa6776cbe5ac6ef4f89cd20c868'
         '9f4a6c45f07cab7d57e8a3bc1d94fd82'
         'e84cdab9383d9d4de8b1b58d668e04c5'
         '4e5692bd0dd2512a6e47c4ded58ab0a7'
         '540bd86a3c5c347cbe71d6814a10cc14'
         'ca57aeee17ada949ee86d6ea64b44076'
         '2242f903d4ec247673b4720311ad7011'
         'a1c9a285deefd15aeb6866deefb7b6e7'
         '36cbd81bd0c47c4e693073402fef5c0b'
         'ba64015d4142f52b2111341d6f37fc7d'
         'cd376dd32949f78e157109e5cc44d526'
         '42b309263ebb86383cd0a0ffc7a6028e'
         '57872753164ca4be45a787599e815975'
         'e4edd7704c9ef4d17479fcfc0e84151d'
         '9668ed99762a12dc87dae310b8ce3f5a'
         '99600326c49830be9125f452da54cef1'
         'df8c4b1aa481ad16908d4443e555fbd0'
         '9d4274c4f959978880da0bcd25423788'
         'f2f7aaa2f1ea13e70a0e8be26629b64f'
         '88099be82b92701d4fb300322528f280'
         '8b4178660878b6c35e879d343f02bbe1'
         'a2c83c1556ca67f97e9751d1628c6929'
         '1a5ed98bfb7e573bf30d861d38e49c24'
         'e2138ed6371a8210e9faab120a03937c'
         '23632e257416df0fbb4b01c4c06f2437'
         '29d669381af11f4b6c210b40d656aa6a'
         '3a414242abe1cdc66a1a2404288b0220'
         '86dcaa8b79680a2d4922cadaa30b6e84'
         '2c098b8fad07371ee58d2917b5fe68d5'
         '9f1d0316584c458d2e67249ebc894834'
         'ec848cca7e76fb001198ffe1057ef331'
         '576ffe778ce976a7e510d7c5e6ca3490'
         'c67c8dabbfb5b08c5d1673783a8b8e1e'
         'b6eb2f3a7385889aea38f5256f476860'
         '1eb80404dd8b1dd60dc01fe4c92e1c08'
         'd712c9e8327d54be745f805255bce482'
         '0f2733b72b5c0b9c746662f58dc4ec3c'
         '26ced93ecf7048e21f0c1fdf614b92b2'
         'd1f17eb18beba590bc6273a8441bf1ea'
         '9efed934975d54219201eabc9f14858b'
         '576d0bf01f7e6992c7bd07f8f2ba9d84'
         'fc04e0293f21cdfa2a47d065288aa79c'
         '626b1e3025efb6dfb156d87eb4a7e1bd'
         '2bba4eff5bcbaed6e3a30799fd651669'
         'e668641fa40139723827e25525863b7c'
         'f79b68b52b47df14255b194c746e6cbb'
         'c6059e6f5e43f345455bd9b7f32e61eb'
         'e1bd0e86c32c93775572c1db3238edb5'
         '9801fe59651656d7df587dca8b504166'
         'cf1ae7ab471ce963397f917ccf749a92'
         'd889ee25879dfdddb53f8744ee88d7d5'
         'a3776417266cb8c90a66bfe48b802ffc'
         '4b810d8a33d06e0d878a32fbdb6aefb1'
         '066abfeeeff432418c65c1ee9372e767'
         'd8eba0cbc043583bff0f6274c7959676'
         'ffdd5ac0cc5ef925cf7fb3fa85067d92'
         '0ee005f153e5bf2d7dc38f0be6ae5865'
         'ac4d67f83b2692f61754609a83ad103f'
         '5824fb4687cbeaabe50aeb3d5ff6bc71'
         '8f9295492e1499a63a3b4402fd55e2c0'
         'd67da9fb9221490e63e0194baf5903fe'
         '41013c9a8e963e4c4e16d8c6b38f5c44')

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/still-}

    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm \
      || true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice still"
  depends=('libreoffice-still')
  provides=("libreoffice-$1")
  conflicts=("libreoffice-$1")

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-still-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
