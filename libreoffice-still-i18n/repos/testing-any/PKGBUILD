# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase=libreoffice-still-i18n

pkgver=5.1.5
pkgrel=1
_rcver=${pkgver}.2
#_oodlver=${pkgver}.0.beta1
_oodlver=${pkgver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)
md5sums=('7c3eee2bc1b7fbbde014c4187b44ceac'
         '9ea386c574c7980439ddd0c23f8b2b7a'
         'cb01c1038d63bb678624b52613d13c4c'
         '1923acb143178b964aa871f0adbdf653'
         '32dd76765a07f4f21ba892f3ea0a9c36'
         '55d8e54ceed193c3958ac9f7b2b965b1'
         '7755cde3319f2cce6a62b21cc2e97abd'
         '029ba9e73c5e6c91bbad2f365db52978'
         'ae0ed41207098107da94b0f0047e87bb'
         'e2204256cfcaaee13634ff0908e1f7dc'
         'b3562c3cc577e36b5086f2d6c307b3ed'
         '534351251c628b25a30e647665076e34'
         '10ecf7b1e4c9d61cd76618c5ce1ea9b4'
         '6504d0b27607571de7092188bc3ccf97'
         '60944313ed6da9c78b8f424e29f2f834'
         '21c92521ebaf0c2aa2188194f1db6b02'
         '413db76d4a595b943123fa45685a36c8'
         '1a316d1b57166dbda3dda20c0b5d8fb1'
         '4a2104a1bf67068487984e547000ac95'
         '415c05c1a1e01d1831c562791a226d87'
         'd293d182d369dbb6f6e93e8178a813d0'
         'a468f5564d31dc9249a38839e64bc4fd'
         '4ccffcba492c1e2ef0b1e13f3d372c23'
         '0fb0781907f9bee9550637873a222c4d'
         '6bdb1c39cba0242771f078742ac33b1b'
         '64b254a52e48be287126ed91812d6471'
         'e18a49e41875a7e410ca647de10cf8d3'
         'e4218a904b8add666bcbd582e45143b6'
         '1bc027d0bea821180c7683288fa537dd'
         '71e7c47dd4e4cd1d6fe92072439bef66'
         '72866439403225a331646ea26295db80'
         '0cf8fccf52c60d7610a02bcc22f91d00'
         '86d7ab8a4ebd5b85aaf8acb6a32eb567'
         'e2469d78f71f94ae1a669ecb6a6e45f6'
         '3731b40c5b9b4f8be2ee049c1bda3e73'
         '0e35a20f141f6852a48b42f6bcc6a6e3'
         '957ab71bf8c0f7f256e2fd6fc391661f'
         '32fa434ee1c847f67ae5e9295f10189e'
         '0f484e06df6e595f76be5d324a342fbb'
         'f85c7489dcf0c6d73f549df7d0c17dda'
         '491a4ff0ff96ff5776eed767232efeab'
         'f1789d441c6af8af71039f6f6b935f9d'
         'f75fb39ae548d4a6acf8d8aa6d3b38ef'
         '293b2eb9790d0976a64e8fc8e8ef5411'
         '64e63b23862593a283b75a9bbfe0a652'
         '0f77a2850cafcd478d9b7d42a015c8d6'
         '8fcf95e2096f2854eaded75cd9b003e3'
         '46d6ab4dd7b5f5c3cab49e448ea53d91'
         'fc932dc431f7622bff67afcdb04ac433'
         '9c68d6fbd556b58c2ce12346d02da10e'
         'cda9fc87261b186df62fd8ca0ff95104'
         '2f28f7099537ea820d3a2a2acdcc9252'
         '2926b408bc86b381b0a6ceaa595dac6b'
         '0767c5d3e34fc3eae090eaed457efaeb'
         '233327d3a8a309b18ac2c155ca208f1c'
         'e696b4b3ff0a994820ecdffd1bd0f40a'
         '1b3627c499b3a7f90fd285c73bc9349b'
         'd208bb88bf4b605bd0aa1c5fb5acb7a1'
         '2d84dfd7ad915d8dfff468a8a7fa7d59'
         '2d963343777384ec1755bdc927497d91'
         '488f19358e4c7ad07cfdb312d500e6a7'
         'cc0f5998da84802531c0d9b2d99908ea'
         '7eda0cd720c0400ee40dbafbcbe023de'
         'd4febaf0c103c19e263e8cbbc03ef81e'
         '1f63e9a8651661f098d4a05358f80acb'
         '24b95b62bc338b7fe0c9d9db7f089bcb'
         '974f4f320f1607d1e389a2ab358c6726'
         '3ff2c7ea4b318285afa4a9f98d25552d'
         '3065c59e9cc6da10bb0d1043988e37c9'
         'c6d642e9418c2ce26418af968e96a81c'
         'b405ef4d662d20f8ec05076f7f5d7e50'
         '222db091a00b690f8482c387874657e1'
         'a1453f774bc6f53515b8cf4ea44375a8'
         '1d7e67e3b02560ede3574964d0f4853b'
         '1720f0c5b5ecae0f9956bf5e2a69e3c3'
         'e6d280e3310e87f5a21af4a453267144'
         'cfc966650e045118b8f2954848be5073'
         '4e4761509e36175a7592a30c708b5f4f'
         '8606f3e53573e4bb0c38b2532c74a1c7'
         '16762060d66059b8644bfb1c74a13b62'
         'c67132933efcae574c134d49019df9e6'
         '51b72c7f50de10715f099679a39a29f8'
         '118a477b9dc767e54bc6f026f1b714cb'
         '62e5dd5521cc181a1a58ba4066ace6e2'
         '4e211c2b774fca6edafe975695a1f808'
         '718a475672ff193de11429fad5b97b48'
         'f357605227d969f6790d2d7f75c8f60e'
         '74afc28d05a2002896e6e2a543211f7d'
         '73c773f13554eee700c1254c270af4a7'
         'd010271a6618aaa993a8fdbff322aedf'
         '23245263d62e6a651c708ecf21280a82'
         '4a75fd5865f7cbdc1ff244dc6627ed12'
         '962ac69fa9e6b9153bc73486338a6e01'
         'c947e00bfa45d6b899a758992dfec3ea'
         'f2177b185d4b0b7232db910c9b244e84'
         '88c73af21f1b70d22675adeb8dbf899c'
         'af0544b1e1c408811813103e50633230'
         '53dd29e8d28a23af818c4d0043adece5'
         '3ac0f0df6cad55fd17cdd87771117475'
         '47fa6049efa2f6ac394fc1e6990c1fce'
         'fa696882dbd7ce154995fc75dec0fede'
         'a9600b658ec40d55a0670deeea029d1e'
         'e5cdb7c61bc5367f4b85bfa821ec2a97'
         '36dc3a015f3792adafa7e96456ceaeaa'
         '08f16db4a9b7c2aae4c9e3a75f8913a0'
         'e8091b99379ec98b2d9ba1bdafe637c3'
         'bc40d3777549981c77f21428e4638531'
         '071adb89dc52cea67f81d43a2b821e17'
         '21f0349db6efb8adef99b9a7d868dfdc'
         'ff4d7523b95860707ef237875d52e4b2'
         '978b41e45cf4990594e33c66534c69ff'
         'c51c759f6bd06931cca092c9c1508867'
         'fb8003ea499d43fe76aa097f8acedea8'
         'e9efec4c52526aabea0d587782654947'
         'eecdbae7044fa5384d3d6d593624c56a'
         '334b61fc2f0be1be3c72fd45c0a1323d'
         '8ba2da596f314a8b07ef5fcd1b51cc2a'
         '379faee23e43bffa085c17195048c07d'
         '9864c8d8c35166de4b7192f521d3001c'
         '3f0f73de9df22661ed3d7b4d53b611a6'
         'ef309c5942f89cd8cc61938a4e16bc93'
         'f3a5161c32c3b78839a6c7db8cd30b65'
         '320d418e4612a4dca5deb821fe965fad'
         'bce2a26b9c7cca7153ff2b25e66842f4'
         'eb23d215123faa6f62b45fd474c27fa4'
         '53da1d3c436b37e6f5546aab21042472'
         'fdc2842388814d351e39f73a9dfeddf3'
         '3fe2fe44bc9151f09a845886968cab18'
         '64ffd7cab03e1d437fe17ff7e70dac46'
         'cadb0c001bec50cf1621509c9fbc43e0'
         'b2d9b0aaecc2765dc761bf8b4ea1e5f2'
         'd682d354b27399bf22c44f4521739c5f'
         '686bf7b2e523ff032b016681caadab2b'
         '4f150016771181ded0bfed66617eb7a0'
         'a5fdbc4d92088ce4a32b979ab843bd39'
         'c1119dfb3c133aa9dfe9256253f20f00'
         '65ff9bfa66611db1efe76b8a4fbb85be'
         'f35a276560fbe239f7d61416542ce47b'
         '15fb923d1b79f36019deaaeba319a35c'
         '30d595329c481c45528d8c29e97d6483'
         '2ca71aeea057cb82e610ef03b038e76e'
         '208917e02ddc6ffd9fdcd2ce2fbdb31f'
         '4a965b1afa3146f3bbffbc297b942cc6'
         '280a3ff9a43e8c8ab9ba4dcc8868337b'
         '33a80834fe6dd332396a752787f4f64e'
         '1ab08dba9e6d440a54b0a2c04f7a1974'
         '80278a44c1fe2fc8649923eb8689e4f3'
         'a2741d78fa2d798d9f657908345811d6'
         '7c6cc900133028553e0d13e4f5edf711'
         '78195db6b27a2cf97296f30a402119f2'
         'e2c0aeb1e4ef637cdf018be5e95d674e'
         '3e974ff1f6680e69fdf20999830ce8d4'
         'eec3c2081b57b19df02136b497578897'
         'b580c47c06a0c54d7a804b83af9bf9f5'
         'bf865811450e52d122e062020c5c2db2'
         '6a04181209bce8829ce232fd7749026f'
         '73ad255aacea69ec47d9366f7ea2f028'
         'f5d81183b119e341719d322283a464ae'
         '643bdf5bd785898db59210698b9abd86'
         '3c625090430490a720b91ee01c5f1e41'
         '84194eda4c15af14b1b79edc84e9f23f'
         '3f9e5fe5322f9c6126adcdf354bdc6ef'
         '5126b99a721823e71e4dedeb46c3b959'
         '21e7b9f89312912dee30bf36e5042e16'
         'eedc8b5ea4287f37b4b53b38fea12f1a'
         '524d4d64ed15fb12ec257d8472de187a')

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/still-}

    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm \
      || true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice still"
  depends=('libreoffice-still')
  provides=("libreoffice-$1")
  conflicts=("libreoffice-$1")

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-still-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
