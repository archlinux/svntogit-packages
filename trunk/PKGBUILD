# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase=libreoffice-still-i18n

pkgver=5.0.5
pkgrel=1
_rcver=${pkgver}.2
#_oodlver=${pkgver}.0.beta1
_oodlver=${pkgver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)
md5sums=('4fd58362b4a6c7cc2277fa363d614090'
         'a862432ff8772d2873a97cbf8499325e'
         '1ec4a6bd84a40eb6c0b8fa0e43d5a80e'
         'fc1a4055ef6cd834d42e6d534b9c6ad4'
         '3f031d539af8f00420d66eede9e7134d'
         '9b6d5422db3255f22108eec7dfb28191'
         '320babcbdd0e3a05788f6064ae24b9f0'
         '7e4c823e2152ee6c60ea4d9551d29745'
         '5224f9bfb716992c1836e352a47c912e'
         'c154c33f09a8e83d0c1a06d134cf9db4'
         '8261968f5dda951fea898fb63500416d'
         '9d58270c36613a696cb336068005b087'
         'd318533e134f192599c6b8f39e04482d'
         '90884a2016405662216cca7e0076b714'
         '0eaa81a45328fb4f52976d5d4935cbfe'
         'b2be6c149d9c6f24339cbb8e50b81add'
         'c29d73cf24bca9fc97c6ef277cf17fbf'
         'e4308dd11f9fc00bb9966334efa8be10'
         '039320a9e90ceb0ba42809587a96e146'
         '42df21a046abec591290dff22acec987'
         'fbf05518f2eda3f0aa2bffadd380ce31'
         '11c13f8f2045579946c74dbb0335a56e'
         '18a77ea66f5ac7ef92e16cbf055f05c8'
         '998743927e67a85056a67279e5629058'
         '7724ddd86d60fb23b498f255ecb0a32c'
         'cc74d60dadf33bf14a2c4d837d82cae0'
         '57807446fb4f44b6c85f2c396e1fb2a9'
         '70931d23cac1d3008556cc53f8e69549'
         '85afed3f083521921d0258554112a66b'
         '4d5577cab1f02ea2a315b62a740eebd7'
         'bf8df40c0a0002e0595c4b6aa7fa8156'
         '1ce695bd8d340ec9b5a02eab8daa73a6'
         '81b354ad3ac37ca5171e9b0b6a9fcf2b'
         'a538d583cdda4653f52de8c9b3f68d50'
         '3f56492d16f664c8595773cd7fe20fa8'
         'f50230b85778f8e9db7365aa04c460ab'
         '26c55dec2fc2407ad005e0daf84098fb'
         '09171941ddb356b192072d596ca76edf'
         '182e92512ac53eb01ff14b0747c2a94b'
         'b9d47d3b93d716c53b6e63cee38738f4'
         'e68b1fe2d6e706707bc3c77200709636'
         '552a6f12f0aafda11cf9cd7ed5a90b18'
         'cb05103421cb6b1ee529d0c54ce87782'
         'ee48772b504052c6caef1ee6fdda139a'
         '548c93d3ee5187250a8232f435200446'
         '345ec9b8d4041b9718780a47e1abcc14'
         'a1ceb6203aff45d348a8fcb47d306ae1'
         'd247130ad33e864a504f8d835f8af2cf'
         '9bc6cdeafa851c197460920ea5666c5e'
         '1a7aed036ac553cc502f59bff3438be6'
         'e0ec91e06abc955059075855650d88c6'
         '4abb0107c60434159df35ffa352f22a4'
         '7b3c4fd6857f69fefac4e980db69ce97'
         'f333dc15873dca01fe2606ba2b278e0c'
         'efa7a41d14f627f795815b425e47d356'
         'd7c599e4b49dc1766c68140769e4201b'
         '4183054aa41c12d67a6709b086363fda'
         '6f5cb31805796ed7d05a6e47a996b0c6'
         '89b65a1bba03ed8a53cf18702cf7197b'
         '75763caff84fd384625cc8bbc87eaa7b'
         '55d3c0e3846601c1949051fb66f092db'
         '031a00bfa6567d66d0655065e9acdaed'
         'b207583dd35c7eaee900e97413393a67'
         '9b9f9fc3be9c41179aed312f019b1c1a'
         'c1ad0cffe0076f08945da8859cf3c80b'
         '1e097bf8997e36a3443ca4c65fe8f0cc'
         '5d28c3a930827ec3e339658783a2277f'
         'e7c16973d042f0ad5d95e5b65ebfb1d6'
         '7956c3621499bff575493a4a3fb8645f'
         'e27694a3358c28e2f884d2797f4f9354'
         '314520d850bf3f5b1b7573a3db084cc8'
         'c5784d80037dbedb6e116972ae6ef846'
         '052251f27577e0a592e324648adacd47'
         'bf02deb8f17bbb15c5688aa3f9e3eee2'
         '166e5dd1d2666db1b86788d2c58689e2'
         '73b6ca160a596116019559f81b34e92a'
         '73b8367b793984e3b8b33040cbb69974'
         '630032e742b4034c46c0dd9cd9e2b2d4'
         'e402b1cc30e3ea49762d8c43e42c4aee'
         'e56be8e6a54f8038a926acb8cc542e63'
         'b3bfffb9ef605b425b58758df9b32573'
         '19f79b405635f7bb6b682d2bc5a0db3a'
         '2c50c1f41de41e59a405594990cc56af'
         '41a7624735fa891c52c95ab946b1b56d'
         'e8ade1ec3f1fd370422803fee2bed6d5'
         '058bbbb8e4760a2a2bfc01a7e8642cd3'
         'e5aa89d9f0db16e40b647974083912ef'
         'a5f449448ff4a8a6ff5bd70d1978da96'
         '7ec78e569158c0bc60b395b69567f57d'
         '1171e6fe05affed1f16acbda04795be3'
         'ce85b22f9d6ddc57ea2d5e3f5ab9a370'
         'e6e5ae1fe00f2d957915e68265d0acd2'
         '2988ef17a4a9704215be8f1053786d43'
         'acf9c139a1e28d6a7328f5c8b0a0ccc4'
         '8f0c0b6f54925894ed35ea0cba16fc2e'
         '12c08cb95a00ad2fc7c00ba239290ac4'
         'd0c14ce29bd607a4967b1871fd6baf6e'
         '9eb09e9909ef171a7947d53e5f4c2ec2'
         '0ca90cae6046e90c1c0a369c5466f354'
         '4565ae273340d26c5c15ac290ac884c6'
         '3f799db1d1718e54258e7e5573ac972c'
         'bb36bb884cb7ba4ce591beb0b062cca3'
         '97897b4849c45e7aee4277a7c1c73e53'
         '482602b68914d62528a8a7028b8e15dc'
         'd8b6ab81aab31ce36c40c302e8586a59'
         '7235b77e16ceb28981944a3145f92c9a'
         '6180933abb922063852cc4a810466e84'
         '12a5425b4b96a1cb20a8bdecf40bae75'
         '43a6c4e577b7f1e71d6fb76956a7cd31'
         'd791b1288850ebaafa7eeb448ca26bb1'
         'e6fc48e7098c7ca218f87304aba089b1'
         'cd733f356a40112b896ffcfb50dd368b'
         '55f44bbc6484b91d0deae22f6c33878f'
         '1ecfd0c563adadb3de7ea60b5f4db8a2'
         '3a42be74299e608bd8436868f48766e1'
         '308e0df4d8e5b94b056b8951223d85d5'
         '060059899542274ae51c33b30a06dd19'
         '4d668bd4ae1f9d56ee98671521d1ca22'
         'a855889c4861300f45f3fd8b7a4c96bf'
         'cba9e9665eda391f1724e526253a38e2'
         '684f7d278871836c13efb15278a4d926'
         'b2007659efdc6c18c4d4db346343844b'
         '9b73c37fb431403cf09a419d9bd2317d'
         '50a4229111057af96f5ba799c2f33632'
         '43bcbda43f8ad516c3dc549c79565bc2'
         '7ed41c0665e02c1d4dba70be518837a4'
         'cd8a15e6a2edcbfdc524e9d7bc4bc2ac'
         'e88f56fc4996328925db1de4938194ad'
         '97ddf7bfd8088ba31e1a2cc21b490669'
         '752718756bb0c9c29581b9710c9c73fe'
         '3c3483f9539b45f61c587d7aeea2bd38'
         '1076c6f3df88dd74ac0f2da50046d877'
         'b1aa29cac3585d76595cf624b94b65c0'
         'ee1063e9c3793a41d75b1d9076794c10'
         '0e48b8db4652c9a6e65b372ac0161701'
         '560724f2c6d694ea4453023c43ea0f5d'
         'f0b0fb0310fb8b11fe00f63b6343540b'
         'ac5b2689306e9cbdc4b407d959db84f9'
         'a3f6e2763dbadce951109f139e8923f4'
         '8b1d1783a20d0fe2057851d7cfb80cbc'
         '5ef68c308f506f781d02bbb8b4e677b5'
         'ffbe9befb186948c625b284bc94ca68e'
         '4efe2ddb090e3a0df4b3c749a6ef6aac'
         'b50184d3cbaa51df755e740f8dfd103c'
         '840ae944b5e9dcd8e68c471efc3c9d79'
         '1b2b24d2b02bdba44bc6723dd215ee26'
         '1be40a8b35cee57504a938eae8d67fc0'
         '2b55c904702c1836ae142560d3001462'
         'f416cfbd31d7e4eb845a82704ffee66e'
         '3db577ad1441f7b825fff21c7a47a3c8'
         '16ddab6dc6b0a5057e25d070809f8534'
         'cd930ddfcdc89b237c3133fd7a8eae30'
         '1c6dd5c6ecde96db58aaad6f37cdc13d'
         'e2fbcebac416a54683206d9935142c39'
         'b06e87581b5f6cc8547f08109e3b6ace'
         '40038123bad27b879a4f02d18b67877a'
         '5a2db6c2ad2cddcfa60d9234f60766e2'
         'd456ad4909a8549fe91c3ec1efe153a8'
         '74bdb32656c3cd31f2ef6c45083f2c6a'
         '12f9e430b19798b4f8bb630989b814c7'
         '63fe5a839f087d353a7e381ce8106546'
         '27d3aa866dc11c4493bd9d7c91832975'
         '8258683d70af5258d6121819d5a807b1'
         '671498e12c9edbf6790a4b31e859d810'
         '133b5d2596771e130cdce916404a382d'
         '9e23b66e5e20b6d8cfe73b63d588cef8')

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/still-}

    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm \
      || true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice still"
  depends=('libreoffice-still')
  provides=("libreoffice-$1")
  conflicts=("libreoffice-$1")

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-still-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
