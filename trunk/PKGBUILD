# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase=libreoffice-fresh-i18n

pkgver=4.4.4
pkgrel=1
_rcver=${pkgver}.3
#_oodlver=${pkgver}.0.beta1
_oodlver=${pkgver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)
md5sums=('05fd15f7b468542410dab2b28b7cffdf'
         'c10a41a4542e14eaee69cf952d2d0a4e'
         '5b2d29823854d72385bfb5f291bded69'
         '6a5d81bc4b57f18da57c57d8f39a70be'
         '97851ea2cf0a942e99a138b2ba8404d4'
         '28aa9783286bf5e45965a9a4a5442f1a'
         'dea2270916f613b321cadcbd4c50685a'
         '19a26465a1a5472eae5a053d60d9d393'
         'b57208b96693ccf9c245c714912b95d1'
         '0a878572577432c62d66b71d03080dcb'
         '67e3390e7db9a74751befd64783699af'
         'fb67e9e731a81d96823f1eee9067905b'
         '8a637c54fda080d0314ed345126827c6'
         'aa739ed5d821e701284d859a61185287'
         'b836d9e464deba6fb3afbd9f89b6d931'
         '56f5a6ff47c33d0066e988cef4b4ebd1'
         'ab6ab5fcca06636d0f5a670fa7a6bdb8'
         '845904186173692217fc11172337f70c'
         '706aa5f6be8fa5f5e907cbf142627827'
         'b44afd1ea6dcaabdaeebc1ade644243f'
         'd1f3ca4e578c6a3b76387e313171fbc7'
         '885c3171fce86302da7a690c24bd98bb'
         '8ff0c61932162d79a4627d795037d4e8'
         '4aaaba0305ff3c408df1e457acbdf122'
         '8a323e370decf231a5e846af3826a2bc'
         'bd4e7abe6a4f92087c486a7b462e88db'
         'f6dc1bd836f24749f0aa5152bdada3c0'
         'f1ad58a2b94c70dedb501e6d08d3d906'
         '052f4668504c4c9d3c1e76b8e33ccac6'
         'd038e8fc2df721da3d48b70836617363'
         '5f947becf7ce2451e7e86e7049a50544'
         '3f36f2d3b901eb82ee8039b33fcf6f6a'
         '74e51b101649bdea2151a5e8e3a03d34'
         'efcbf558b50c8c4981d049586c91f3ec'
         '59303a63684575b9e0d101ff32661585'
         '24d1e7e6ae69b71998306f45e94bc07c'
         '2331ac06d51930af45cb5f84231ce8da'
         '2c89f144793cbbf2428299654d748d45'
         '2fb26629172185655b9c67fc78eadcce'
         'fa3d3bc011f4a56bd52f67520e5079da'
         'c89936e38ba30b56cdb9c9b60af3aa69'
         '83e2435b40cc449b0ae6bb8493d54f5b'
         'bd710ace183c1814b42dd2d39bd9f3e4'
         '3f3a5b31b9e0ff6134658a1d85028e8f'
         '249cb6503de53822d879a4ee2727002f'
         '87aeb12cca1107d473e9a5c0e95f06b7'
         'b9cc1c421251fdc09663fef6a65ccf22'
         '0e1463c3a29f1e968de1418a47a5cfac'
         '250aee9ff8199c29c3b5eed08ae213d5'
         '4e2a471645febeb752584f026da34f5c'
         '6cce16a7af58bd6aabbd929a16b4bf96'
         '05622a880e1e2bd5f095fcbcdfc717bc'
         '21e65500fd1503085f19a80bb4cf2a77'
         'a0f2ebc9a40e8d4b243b20260085aa74'
         '5119aa0b205df21e30b5c71e862b50d3'
         '1a91a6fc153b4f97ecffc805f1875697'
         'b7aab38f45a02cd3ce0a68bbf7313c58'
         'a33c88c0c886dea88dcb1409192d37e5'
         'e9c833484db3e38a5e3af4905793cafd'
         '24c57d9df93096647931d1319d789de0'
         '445f25512e8e77f3016bbf4bdc8b2f08'
         '4190d736c56564c2ffe17399ca18aaca'
         '0d3261c9cf01d32218b3d8ce83242cc3'
         '19e80ece7cad424526a912e2024db5b6'
         '151ada7b4990b1a6cee058237474ab37'
         'd42e5c9ed2b0dce2206fb49857b6cb63'
         '8b3c6570aae0032f41c615b415125693'
         '7abfdb7c6b4a5984a267d2d5d10c9bfb'
         '36d9a20d25a8d32412517c57789e9289'
         'e12081f83c4468fba629bf9e87663ec3'
         '8b820ff0fc511b075ea169655139a2da'
         'af6c686d4057cbc54815b33aa7b073a1'
         '0a511ffee31d9038f37120f2be1354fe'
         '70b4e3427e278a82becf760af7b3be22'
         'e16aae2cf6f490b731b2d5fec756e66a'
         '89dc4270dd795f184bdc1aee64d02cd3'
         'dca2f7e728b24832de2e762facfb6cc9'
         '7f2daa5f5f76e3155e7b73fbdd16caec'
         'fca186bbf278cf0a0cbb98f385efe696'
         '528dd4ecd26c4f05e4c3428cc0b59c6b'
         'e2b52f0875b7243b7153b4537c822bbc'
         'ff4a8c8220721ac9a9d5a0a7df41b048'
         '4dc615b993cb548fe53406ddca24b858'
         '3c6ce4b0beada739544831ed82a3c4d6'
         'a753e671d9bfaae430853b74b4b3f1ee'
         'b90b0e021977ac5bbfacf23760d9a6b7'
         '587a0a7d26dd0e4b31be053132ce009f'
         'cbca52e5351f2183a18ac8d5fa182abe'
         'f7b2bd2b1eb284183c64e84b29e6b4cc'
         '4e960968ac65778db75480b66a3e63dd'
         'ce9e89f44418c5e0afa07effda3b8074'
         '1b358285f01883e420b6d7018ee89087'
         'f6dd032f476dcf06601aa5541e94393b'
         '9585b86eebec2058a6ce33377e9386ba'
         '5975276d73147929ae4b22db11b42216'
         '8314d4ce98734ab3fa990c24171e7c3d'
         'f955f39abbb864c7e51610af2cc9b9d8'
         '7be57b6a5489f3505337b5411c0c5672'
         'b292b9a375218c01e6de2d6bac3b062b'
         'ea0bb86acf0e61deac5011b5513f1743'
         '61b3dc1e0a727f3e2b433839a781bdbf'
         'f547372fd817f89b809188325c1e9767'
         'a66a811b93ec1c270a9a854a4c68b903'
         'e37d7411b7235dc62eb3ad2480725f4d'
         '2e715aae10852846bb9b643d46d80750'
         '3d450a27765cb3a09c9ec4f7ba9ad5a2'
         '9689548241b7bb526f78cd0d965cd0d6'
         '364fe01df92644cbb89dcb7773548117'
         'eac876c717faec2eea20ed8cfc09ef7d'
         '90a733c21016b35a3d6a0155fadb6584'
         'fe05b32dd77eb2fa9cfb7051cb65b7a2'
         'd61ce3637cedf3aba5693622cfc2e53a'
         '7c3d89aefc21863fa58d9263a0c9f725'
         '531a07ec0be260ff3f3969bebb5e5bdf'
         'e329dc6ef29cf58d51d39a94e8884c6e'
         '8335745944b1b9588f43cf4f1dd03edb'
         '627e290055506eeaba21f7f374a16645'
         '5e68cb82922cbb21c33e91bfd643b3f5'
         '04c803f9151f8610ec2b49da651de0fc'
         'b98de0cec91164b6e385d7320a54c642'
         'cb79106c5b8aaf7c3828b2cf21222017'
         'e1d73a3024a344b8e6a20aaa87d499c4'
         '1fa38ae5ec61f189e17499ddb267176a'
         'cc89bba5bfe391eae4c56eaa3cf1e561'
         '9b444ceb312b6e614d567509598c531d'
         'ae31588566166d470995e8a629d2da4b'
         'ea959ce2fce4b2e9f36ea591adabc88d'
         '686f37823e4f419b2a45e2158b1411d3'
         '18c5928537ef963546ea954a3a06ba64'
         'e7fcfa84e39ea5e5262581b0a11e76d5'
         '57350e8ced0071a1a0efe765bac31dc5'
         '2ca4ed01d745c65fc9208bb288f1a487'
         '9b922afb8d3adbbe1dab5b567f16cb8e'
         '0880e11647e2033e0e22a1e18585a6e2'
         '1411458832354d9b4fc9add6c0a7f442'
         '302570524c69f8423315313bc9ba0140'
         '3f1cd9070541481fe9683e89fd1455b2'
         '760b3d55888c64fc8a7741992438d0dc'
         'd7cb9c963c8c892205f8a36784acbb7d'
         'aee1993de5d468bfbcd7d44ddb11c005'
         'd0094ded560a086b86b7728136612410'
         'a55f601582eec45ddd66a673e15ed507'
         'a50229d1dc6b3187fc725607f7e9e051'
         'd786a594ce995c7e67f7c92171f12cc1'
         '2cbbb29076376b7c40808d89f9218ecb'
         '982f24d8c6c328df141595ceb3856fa3'
         '284bd2c6230dcc34e67d1c7ce3fdee90'
         'ea66686dcc7fda960f6eeab71c00eaa4'
         'd28a240dda94237ec7c917342ba7f5e9'
         '81c332dd2c70b89105d8761bf97e3772'
         '4a240d97e3bf3d10915c9fcaebc6713f'
         'f666cc6d8741a6a16fbe41af6c8b0f49'
         '6e558bdc518d47f7626623a910c2541a'
         '0bbcabf3cc5be0d036c2e4aa6e9af472'
         'c9b093b8549575d9454880c84d598893'
         '53ea800b6b1626f79c971f39eb050dd3'
         '2c2012f7809188b99fdd0b4fb4892f79'
         '4fcb7aadb9b3380a49f983af036d529b'
         '19dc69c8e6ccbc55ff6f83598653fb69'
         'd32d9dfdfc336db425fd139cf87ee923'
         '25c5afa3f5d2b5af8b42e01fc7ed4076'
         '7d41f3f47dd2fb3fc658f7c3f9359ff9'
         'fe90a03d921039cfdaeb53e106c84958'
         '58024c2d2c4b1480126fd9742584a2bf'
         '25e92b1595626dfe58344c88b99df4c0'
         'a9c69250295a650c0c0bd8ed1b31ef27')

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/fresh-}

    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm \
      || true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice Fresh"
  depends=('libreoffice-fresh')
  provides=("openoffice-$1" "libreoffice-$1")
  conflicts=("openoffice-$1" "libreoffice-$1")
  replaces=("openoffice-$1")

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-fresh-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
