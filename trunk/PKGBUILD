# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase="libreoffice-still-i18n"

_rcver=4.2.6.2
pkgver=4.2.6
pkgrel=2

_oodlver=${pkgver}
#_oodlver=${_rcver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af           "Afrikaans"'
  'am           "Amharic"'
  'ar           "Arabic"'
  'as           "Assamese (India)"'
  'ast          "Asturianu"'
  'be           "Belarusian"'
  'bg           "Bulgarian"'
  'bn           "Bengali"'
  'bn-IN        "Bengali (India)"'
  'bo           "Tibetan"'
  'br           "Breton"'
  'brx          "Bodo"'
  'bs           "Bosnian"'
  'ca           "Catalan"'
  'ca-valencia  "Catalan (Valencia)"'
  'cs           "Czech"'
  'cy           "Welsh"'
  'da           "Danish"'
  'de           "German"'
  'dgo          "Dogri"'
  'dz           "Dzongkha"'
  'el           "Greek"'
  'en-GB        "English (GB)"'
  'en-ZA        "English (ZA)"'
  'eo           "Esperanto"'
  'es           "Spanish"'
  'et           "Estonian"'
  'eu           "Basque"'
  'fa           "Persian"'
  'fi           "Finnish"'
  'fr           "French"'
  'ga           "Irish"'
  'gd           "Gaelic (Scottish)"'
  'gl           "Galician"'
  'gu           "Gujarati"'
  'he           "Hebrew"'
  'hi           "Hindi"'
  'hr           "Croatian"'
  'hu           "Hungarian"'
  'id           "Indonesian"'
  'is           "Icelandic"'
  'it           "Italian"'
  'ja           "Japanese"'
  'ka           "Georgian"'
  'kk           "Kazakh"'
  'km           "Khmer (Cambodia)"'
  'kmr-Latn     "Kurdish"'
  'kn           "Kannada"'
  'ko           "Korean"'
  'kok           "Konkani"'
  'ks           "Kashmiri"'
  'lb           "Luxembourgish"'
  'lo           "Lao"'
  'lt           "Lithuanian"'
  'lv           "Latvian"'
  'mai           "Maithili"'
  'mk           "Macedonian"'
  'ml           "Malayalam"'
  'mn           "Mongolian"'
  'mni           "Manipuri"'
  'mr           "Marathi"'
  'my           "Burmese"'
  'nb           "Norwegian Bokmal"'
  'ne           "Nepali"'
  'nl           "Dutch"'
  'nn           "Norwegian Nynorsk"'
  'nr           "Ndebele (South)"'
  'nso          "Northern Sotho"'
  'oc           "Occitan"'
  'om           "Oromo"'
  'or           "Oriya"'
  'pa-IN        "Punjabi (India)"'
  'pl           "Polish"'
  'pt           "Portuguese"'
  'pt-BR        "Portuguese (Brasil)"'
  'ro           "Romanian"'
  'ru           "Russian"'
  'rw           "Kinyarwanda"'
  'sa-IN        "Sanskrit (India)"'
  'sat          "Santali"'
  'sd           "Sindhi"'
  'si           "Singhalese"'
  'sid          "Sidama"'
  'sk           "Slovak"'
  'sl           "Slovenian"'
  'sq           "Albanien"'
  'sr           "Serbian"'
  'sr-Latn      "Serbian (Latin)"'
  'ss           "Swati"'
  'st           "Southern Sotho"'
  'sv           "Swedish"'
  'sw-TZ        "Swahili (Tanzania)"'
  'ta           "Tamil"'
  'te           "Telugu"'
  'tg           "Tajik"'
  'th           "Thai"'
  'tn           "Tswana"'
  'tr           "Turkish"'
  'ts           "Tsonga"'
  'tt           "Tatar"'
  'ug           "Uighur"'
  'uk           "Ukrainian"'
  'uz           "Uzbek"'
  've           "Venda"'
  'vi           "Vietnamese"'
  'xh           "Xhosa"'
  'zh-CN        "Chinese (simplified)"'
  'zh-TW        "Chinese (traditional)"'
  'zu           "Zulu"'
)
md5sums=('00020fc63b23cd527b33bbc6b2780b5f'
         'e64016b4717422e0f223aa2cc9d35c2b'
         '4ec2c56ccfd9ebd4f898d3badd93bc75'
         'ae227766444996df7c031045d10775ee'
         'd8cb31fcca40f1a2793a5220b3fb2996'
         '65bb570d45231606f7b71eaf0284fdbc'
         'b40d0b64efbc003cc6ffc0d3e09c0a70'
         'baf6c09466349cd41da429269ce0bcec'
         'f4228ceb8ad799d91a748fd0fe0292e3'
         'b2a8f59eed7d23dd9ba0066d8e98e7c4'
         'cc937d9efe93f5410b5130101776a511'
         '3f860d6c9afceea0903d49e9e32a78ce'
         'ee70bfaeb38cd80c8cf46109762fa0be'
         '33fc7daaa0b8209d0d63e43d3e894027'
         'fdc0c5e688ac790df8babb41188a3f11'
         '83081eb47f155679467a5d67e31c6289'
         '02ed159c50fc0f199f2c6fd355b1b673'
         'd61ab4bc4dc3c088008f319586ba6f9f'
         '07f34357ab77bb30afc68db54c7c7d12'
         '200db24d6f77e6dd31e3bea4d1d7ef4d'
         'd99a87131bd5420207af33ec6c641c98'
         'ccff69bfe6919f2a40ffba852c0fd960'
         '09944be9f5b0c89d115e802c9aecbd9c'
         '5bf64383d2d4d46a5472b655b00c1bf9'
         'e67c2eeaa07a3f3ca4faafaf72a4cab5'
         'a181a15e185ac18111571b31d1a73d30'
         'c6a05ee3c2379af0561d763e6eb6ae6a'
         '7ac99ed018e9550ffeb68edd5f4fbc5f'
         '6721a3d0d11aeb9f18acc179b8f6e7b1'
         'cd7541ea94cd1dc33b8dd9b1bfe1683e'
         '78469e4e5c5c21570b8a6635a7187e12'
         'aedade6563aa6658f30bc4fae9abe178'
         '095858f82d2f22d52403df144531e7d3'
         'ca5eeb5566da22a2b8bade61e6eb4907'
         '3fd326fba68455d47371aa213e6259a8'
         '1bcce8d1464e1a58994e3902c1415d24'
         '3e68ebbc8c51765fb7832771fe869135'
         'ff55ac742eb06f993482796ecce72ee9'
         '853f0cc98b59bdfc9ca2ecafb858c868'
         '02395a1ee7d779077ece5ed8f38ce9a6'
         '284dff0b639e3df0f7ab458e2c4b8c0f'
         '357c16b8e7d035fd26f0d10ac3b0f815'
         'b8336cb10a270653cf0dc84b61861bba'
         '70526694b38df8e47b67c5e6dd480287'
         '6d3249145768f3fb991f021fd75b2689'
         '62e8ea9f9e1adcbf7774413d07affd4a'
         '8465b0f82a7fd91dcb01f9c48b595075'
         '15e88c0e46ab8066b2b25491c5dded00'
         '047a519417d1f7f86ceabdbf644a56ca'
         '2f7ca65235e010234f2df75027015f1c'
         '735bec63bc4645e30408cd25c76ef885'
         'be8322d9597de94a95742bf1feff1678'
         'e7c29ea21e3cfdb30910457f71d7d3a2'
         'a0714d5b7fefc4432ffb03baef3dca8d'
         '37cf38a23eeb53dde6b852f86ec6f3e7'
         'd95f7af0514b53b8fbbc8be1ff8cfaa9'
         'b14d7771a750f908f0da3db4ec529638'
         '51535bb0c22cd7f43fdc920e6d0fdfd8'
         '71d3ef94f176fc41fa75c74c835bf295'
         '31b75322c2d443649f39282716b63a19'
         '0d71a89fc0fa739030a75172db7ed8b8'
         'a897fb7cc1a45e1bb1c0a322709b673e'
         'f6f84c16ae431c12129e2dbd77f24274'
         '44d5a4ccfd48527ea66f2cf0473b0f0a'
         '96899d40c0183a30ecf8377890161603'
         'ed0e53dae582beee71739cf661110117'
         '60f81b8f9ec393b2596ebf2dc3ad0d6a'
         '70bdc819d47caeea8177faa723bf05a4'
         'dcf62bcd2cccd7c7c55756c8363e44cf'
         '94e222f4bde1df9e9168012839d8d0aa'
         '0b61adf8cffe67615233347ce0b6dedb'
         'c02691d76a86f07f6bfa71fa87ae321e'
         '6955db45ed8c04cec74877cecea3542e'
         'af506ab117567515a790acf74423aa4a'
         '52a6650f14b388e744135a21541903e6'
         'f3ae9b8ea2b9618ba2b08151a5fb777b'
         '1ba4eb648f64c91e3bd9ebcf1f7ef6b5'
         '962c1eb42fbca95a18c43bcfe678a9e2'
         'ad21e8d9a6c935938c14d7b46b9798a9'
         'f480c75a382eb95d278b61dce91e6e14'
         '8f9f23cfdd6e3a7a4cae642bb74d5349'
         'c74733c141e1dccf38b244570c5282c7'
         '1f863e1bb02921ddcc7f2012c4a0bbda'
         '504f1e573b373a4392ef64a9017ea2c6'
         'b708007734854d4b713ccbbc13f80ff6'
         'ad6822daab8e6721426e01bc74d2ac19'
         '7620ddd5451201477a3b47e4530fb0f0'
         'e01b733ae11fe0c32e60a564acdd57ce'
         'ee6475aff355ca768abb3e3569b92279'
         'ec7de6144d4fc210e7af93244f2b43d3'
         '57ffa222992f1417ebe6fc340d49e3c2'
         '368eb64026f2548bef5f414606565223'
         '431faea8b98e1b21f346f6488789d195'
         '8c5e4fcfa8327d8f7d1b9ff16b82acef'
         'ff2830b4df2fd052561be1e2d191577d'
         '3bda2c9320727599865db432546f3c89'
         'f7ec2da617e520de557593421283032f'
         '2165e15f6101014dde2d77260334c55a'
         'b5ed55f6bab22d85fc9a33b92ef2dab2'
         '9c79e53d105d64a1345bb8049f14ec7d'
         'c724b071811bd04492d739a87bab43c1'
         'da41fdcc881d5823aef1755b4c303807'
         'b399465cdfee8eb5c21d6534d5800e32'
         '129cbdcdcedd9dd6c77eeda98206e554'
         '8e32758fc93650cd3b1927483dd6ab7a'
         '49b2280d32acbf88a3f117edc9490c2f'
         'cd3c52edf521c769bc44c20e39aa7acf'
         '3f55b5b174deb6cb7893441edbba2268'
         '1dee357fc8a086f5791f92c7c1cdcfe0'
         '010d014047b07bdd04efc1cda678c714'
         '06fe1828daee93bf132f16070464f82e'
         '1cbfdd0ccc4db6dde4c20c683cd401a2'
         '65dba2fdcfb0e77416b8f7397a6b35ed'
         'd6f289018c49dfcf0b4394228cb4aeb7'
         'daabb9e3e0997e948ed6fc6cff1f50d5'
         '1381e2baa8d8ec2e729b65a08f58c6e9'
         '5fd9a51a6e9c0348f5c0d83196026053'
         '257d86fa35a4303ce276def318dc8f07'
         'e49bf05d965b71ffffe727c6b3aa9e1f'
         '0f63adc286a1104f6b4129ca753d0077'
         'f94aef8728e0acc3e670f70b250fb75c'
         'f4ad5190a02ea6bca0c0a5e99af46de3'
         'ac50ee6526960ce177561ea89e812542'
         '4664a08c2795e9f0c5fbd219fb1369d2'
         '8b4a9a3514489e4e8071d05e0be1f7f7'
         '33407f5fe2a8d39a0b8edb727c148dac'
         '38d309c490b0ffd0980f989235f86c01'
         '6f5291eba9339ee66e3c69c30d8bba53'
         'c07dfab170ac66935da91cfc41e3d67e'
         '559091bf151da096d91544ebff07b4cf'
         'e62ca466d77b689568e5e70d8e5824f1'
         '243ff89a6b8837ad91383e84224f24cb'
         'd5701206ba0c2d55c4dc090c8086739f'
         '428eed87c8db3e90d0c9799feafdb34c'
         '7638cfa4877dc9e039e82e46a692283d'
         'e9bb8bae0449f438f79fb9ac946fe6bb'
         'bbb52006f8cd3d2daf882a60a5fb45df'
         'c41d020cacab2606883b08961809064d'
         '531e947c47ac8cc0af59acc580c9e741'
         '0de3fac80fa453e19c502d2e2aff686c'
         '91859f68e6406a3e44e319cea3b19ae8'
         '8976b79080603dc46a0a0b09adf62204'
         '10f25f50d6774cba3207cef4f6ded361'
         '0556a6bc4a1464d731d80a89a0408389'
         '789396d6f79000a7c16212b56f9bf550'
         '7af3eb1566d0399b19b460cf189f52ce'
         '8802cbec5824ac079c2330299daee9f0'
         '2fd1a1d5881a6996885432853e2392d4'
         'fdfab1a24f04530025f518c8c325d72e'
         '0fff94725441ed1cfdd417271ed22686'
         'f2a2948f474ddc522652185a3309c26b'
         '9230b31a9d8cbf2589e77b971056637d'
         '93815f93a9ba9e2af447018d009ceaa9'
         'd010379261b33e3abaa9ba8ad01336e4'
         '7ab6d17d928722e70310f012b2da927c'
         '9738aa5e2cad18beef00761052156b3b'
         'd287f057541e6f1708cfc52403a67d82'
         '9c7b1c3f8bf4efb6c613b6edc3593c91'
         '676f22e5560688a4ac585869d65e5821'
         'c39e795e05e362520db299f679cfae0b'
         'b2506f624a45effce7c701514e082ec4'
         'e19370065bde513ae422f16c188f6f79'
         '74dbe8e7e1f30dc6338ecac8f4bf8832'
         '2fbe8da98ce35f2c4779ef260da26e1d'
         'ab72e3260565edd881aea90ea4739a9c'
         '02f8e08735cf8762eab1999a458bbfc6')

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/still-}
    
    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice still branch"
  provides=("libreoffice-$1" 'libreoffice-langpack' 'libreoffice-still-langpack')
  replaces=("libreoffice-$1" 'libreoffice-langpack')
  conflicts=("libreoffice-$1" "libreoffice-fresh-$1" 'libreoffice-fresh-langpack')

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-still-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done

