# $Id$
# Maintainer: Thomas Baechler <thomas@archlinux.org>
# Contributor: Jaroslaw Swierczynski <swiergot@juvepoland.com>
# Contributor: Michal Hybner <dta081@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgbase=firefox-i18n
pkgver=33.0.2
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox>=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'az     "Azerbaijani"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'csb    "Kashubian"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Lower Sorbian"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati (India)"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Malay"'
  'nb-NO  "Norwegian (BokmÃ¥l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi (India)"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=()
source=()
_url=http://download.cdn.mozilla.net/pub/firefox/releases/$pkgver/linux-i686/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

_package() {
  pkgdesc="$2 language pack for Firefox"
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg csb; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}

md5sums=('57d2c84275e11672f0fad8266296f707'
         'd8ac769b4f5ea83963ab7e0a5b9d03b2'
         '7661c3f21f2ebba2ac424a6361fe8ddd'
         '831721152178945f9ed4439918860386'
         '95c54c21fea51eb78d563236a86d1012'
         '22351a86811aa462c4371186363f2349'
         'b940c14a8bb8f99586177f0ffaa6dd07'
         '0a6fd9cd47dce9c5ca8ae2214a59e70c'
         'ebdac6da84f6b1c83a2c0b8666a8c04c'
         'daa62481c18d81c3cc8f3315ccfabc2e'
         'dd96e0e0afafb1e4b55cd0c73f29ce06'
         '4296565ee4449987b8681de0a9ef8612'
         '29d2a9ff827b400fd422339c3fe94213'
         'd3c130e00bd7f998eba381bb3e535867'
         '2acb2ac7d8bf72b42a96443d1d412a7c'
         '862a361b2387976da0319f069ee08872'
         '16d1af761a3bb5e6d2bc3e3052c39faf'
         '882d5e5452782f768253e8749eaa275c'
         'ee4356a24c8a147ae393937206b348f3'
         '03631a11859e679a914abcfc0b6b3db2'
         'f6e4f480e63bcd83003c64256e1f8e60'
         '89d6b51997b60bab58637cf2b91b4328'
         'df7abd1d1b711a67cdb7d63a389f1d47'
         '245d2630c7b67208e5326d2273f9cd6c'
         '045b482a0dcb3e70118d952b449c1b00'
         'ac740f57304dde52f60d3aa23949fe21'
         '3fc011cab10aeb64a33721cd3f516b5e'
         'af97dc0df755a213c5793dd6ccc9bc18'
         '2fcfd46da73b201c2debd0beb13467f7'
         '41943b0f4fbfc39c8864adce770ce320'
         'e91c5648b88b1b8adc7f1a1214081f29'
         '0962427670210c79b38ac6fa4fe24a6a'
         '92ad9fb2277a7a920e10c79fd699955a'
         '3b92d3fc1c91d96e9367b8e94383e3e3'
         'b67c6be70ddc8c9f989671a662c129d0'
         '027660aaa01aa960d1c987886aa217d0'
         'f51ceb71ada4981272700c38cad44c8f'
         '17acaba74e61cd8ea084a9b684af5af5'
         '8860c17b056e1a6b9832787a5f0c0373'
         '0c675cbefc05c943b320baa8f1e2f789'
         '167d5fc44b90c02767e763b4249a84fb'
         'bd7c62f228fc9fe9663a35723b77e0c1'
         'af5e1e672dcdd4c1b2a19690416b0789'
         '6b75188e273c8f2e8910d3ac2eb871a2'
         '400f06533db3792ed2d343015dad600f'
         '8afc0ce52648b107cf149bbb23286c4f'
         '4f31bfd6e2a67f81ba66a45d8b721213'
         '160a64277bf8a4567c4e9764f90cb31e'
         'db5cd27160468552be0dbc07df65743b'
         '92497aa95e25ced60c34c91c6d080c67'
         'deaae386338f9d974ecb41cfe666c7cd'
         '81494751e1a93addfdea110b93dc5720'
         '80e7f147f425ec9d3ddb88c628d5acea'
         'd815f361c00b0a5e4c80a632051b0eb1'
         '8cff8b17e752912b02e3d5ef00bde63e'
         '3a7dfc47eeb9fee1811b748563e2fe87'
         'e37ab9b0f97b726f03d1ad647ffd0fd2'
         'ae61f4272378916ae49a7b8deaf6cc0b'
         '21eb2a7d8bd3e86bf13fde7f1433a158'
         '6178c2893c92b0fbc99fe19aa20c54b8'
         '57a75939f642a3766304ee896326aa7e'
         '257e622924e9d2c9aa760df90ab1fd32'
         '9ee7e225ee1957e6ad5b1123a8926b3f'
         '218cca929f40adf389775303c3195d64'
         'e19afbb9c03db5a812a9d8941c079dfa'
         'dfa87103ff442fac5ec1b2a7314325b1'
         '75bd4b1e588c3fb8112ff2ed562f6a74'
         'a391570d62c016c53f09389703083a37'
         '5023fad32d2db92ea41f9fc82f835f14'
         '2859f3d05ea83f44eddaa66a0aa66f59'
         '7523a704e9f0ae47cb6b6418e447bf97'
         '564b8f3f6b82137561c7d9b009e58868'
         '6c051388eee2df78c94549e6daf85c50'
         '523ab5b146c58ad9be045ccfe9968ec1'
         '43db761c9fe3cf09bb2e40550a34573e'
         'ab1666a862a0affaa22a7e37dbf10374'
         '13327ca22c4ca45e2cc62429b72a68ac'
         'caaa9ccf0c0ad262e1d77b5f29bc5593'
         '4c178eb67aa4fba8c467866b8dedc78b'
         'cb5efcdcef5d39e77e5d1f7a95b2b94a'
         '436e57537e338912629770e8d7f55c8f'
         'c46d44220e992c5b3ca28a7aa59ed431'
         'ba3dcee831ec3a3e4ac167652412e2e1'
         'b914824fcce8e00dfcb66ae501a39016'
         '4cfc1e1d884ad1bc7b853f5484a20380'
         'b195789ee141f3bd5423e27d0716941f'
         '4ad633e6d6beee5224455921c2c3fe02'
         '78d69a6f5497fdfd2a3bc20ebf583a40')
