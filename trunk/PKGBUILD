# $Id$
# Maintainer: Thomas Baechler <thomas@archlinux.org>
# Contributor: Jaroslaw Swierczynski <swiergot@juvepoland.com>
# Contributor: Michal Hybner <dta081@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgbase=firefox-i18n
pkgver=32.0.1
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox>=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'csb    "Kashubian"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'nb-NO  "Norwegian (BokmÃ¥l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=()
source=()
_url=http://download.cdn.mozilla.net/pub/firefox/releases/$pkgver/linux-i686/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

_package() {
  pkgdesc="$2 language pack for Firefox"
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg csb; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}

md5sums=('1d30ef4c9f25874c1e8e5a57c54435c1'
         '8237e5fd28dd82e07ba5d996941e766f'
         '9d3fb43436092b9170d23dba3c7e8427'
         'cc005c085f2579319ae7f26f57348199'
         '1b6498a9ece311990cf465a041691b28'
         'b538ae3ae83ebef6cc2ac0f089de76fe'
         '28e841df46dc61e8409b37c4319edeca'
         'd1e9cce3edcea7c7bdc2cf695e06feb2'
         'bfc95a2b54042471f28930ee32328503'
         '873f860619076f64e2e920b97e558c91'
         '0ea608b7f3affcb3bd85c6514b229c1f'
         'f2f99f4d7ab1d70904fd074dd69ace59'
         '0dbb98f377f9e628b1304622abba92db'
         '56a92fc85956cc486d9467250493c162'
         'e81f47e9aa10660bc39dbfb1ec7bb530'
         'ffc0f5bbe53bf73bbd933a13aaf427c9'
         '2e5c47d204513d1012967a57c19773f3'
         '511539ba906245eeef62cfaad1601062'
         'f5f25ef80b74a9ba2b23ed47f95bafef'
         '86a04e3f352f1108a8a7adc37560f311'
         '9621186f271fdaff40ee99b7dee177c0'
         'f40d0bc00c0d1c4203a1ce8b3f0fb8fc'
         '284997f1fb8a353bdb4e854b51d19a47'
         '24b8f8af3cd37a3ed0b0ad4cbd4eda0e'
         '90c02cb98a1b09db4a84bd204906b813'
         '5987c622a2e250ffc2a9b055474c309c'
         '9f15e5e12f6d9e3f1e669e1c928da0c9'
         '8e7c5e96e8101129bd2c03604fcf3be8'
         'dfb09c9c3be19135d35317c3e1c81669'
         '6c1e115d02dccc9cfe82d79a8855d717'
         'd4174534d0fed3d8b8f8e8d3ab54dd6b'
         '8cfa1cbf6534f85192b1f268ed249889'
         'e9f02e87d1565fbbade2711e286585d5'
         '970dc2cf792866365f841e69c0e471e3'
         '7da73c161640261df9c8ef4b42140489'
         'fb162a77b4b4ae3b04448cb65e53155d'
         '65fe1748be219c325bc546b92643425b'
         'e212c0b34572f0c5145967d4c5b53ac6'
         '613a24ee7a4f61fab648436be2fe5874'
         '9524279577f66bf7297d1645dfb5073f'
         '10be7822ffcd942256740c0bfa42a8be'
         '16b96155ab6edcddf1aefb5be14c3918'
         '1c7fa82249076bd94c19317383674013'
         '6ab547c2a748f178b77bc4d788a5ee96'
         'dcc3d65a99f5c629a42baefcc02ca8df'
         '732b167c08a637e3207e0497c436139d'
         '7c52dbfd0ebc4c7ff8548ed5a1b30fd2'
         '96d61678032825ec827a1fd84858d4df'
         'c542475e0b8529078696cce4d9c8c1c5'
         'e7e6ff057eef95607b0b78b1eb1237f4'
         '81ba94745c100f44dc07c774d1b38589'
         'a2581c4c4d188f4fe18135c4d3dc7db4'
         '8bfe5a65a2336e79bfcd863a994f1340'
         'bed2eb67621f59e6918a8bb9264a9ab9'
         'cd2ba44a06fc9efe73e5ce62c888ebe1'
         'a312f16030f83b6dddc7257fd9865e18'
         '32cf4236cb07346dda5a38161ccdd503'
         'a015e8eda37497244d3d29afa66ab5c0'
         '44ac753130021dd006c54bd12b74540c'
         '8cb47d418ec220c6f1125c48945b9f80'
         'b17b22ef8368c3e72dbbe8b22e5c6c7b'
         'a1eae4b2f1635c0d5a075270811ce819'
         'a6d6ba040f6fe606a443d1b132d5e902'
         '30e6220f415245af11b48afd24faa632'
         'adee984b1a4ae723cd00276985b8f17f'
         'a6de215cf8ed00d2c813c83f6dd0e08a'
         '55fc934295da2ba3050e1ffbce38abd0'
         '07da6bc924730436d183103b582ffbd0'
         '3be6a4d1569c7dafa76cb511d31aa3d3'
         'eb427af7f7d1bf1e4ac45b65808783cc'
         '629c3f5456f5968a0fc95df3470361a6'
         'ef206457570d6af6ee3c284a690f93b7'
         '605fd1a632074742662669e866f0859d'
         'bb7d139d289e952a7b230bec45676bfe'
         '161add96efe2c780db707533770c2b04'
         '59f415f2e5a735d6be1d2e495598c98e'
         'baabf56f0771bf82991cf472c0e4faff'
         '8a9fbe743faa60e0f4229d8711e0898e'
         'ae44e15225e8f8ade5901e6d3846b741'
         '14565928972cdaf394f7e6759179e845'
         'b8f32409b260b7f8d63785d2f9fe88db'
         'd4315121dd69e36216be03e9752ab245'
         '8222caa105a8fd78ce593f3685dcdea9')
