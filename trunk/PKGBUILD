# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase="libreoffice-still-i18n"

_rcver=4.2.8.2
pkgver=4.2.8
pkgrel=1

_oodlver=${pkgver}
#_oodlver=${_rcver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af           "Afrikaans"'
  'am           "Amharic"'
  'ar           "Arabic"'
  'as           "Assamese (India)"'
  'ast          "Asturianu"'
  'be           "Belarusian"'
  'bg           "Bulgarian"'
  'bn           "Bengali"'
  'bn-IN        "Bengali (India)"'
  'bo           "Tibetan"'
  'br           "Breton"'
  'brx          "Bodo"'
  'bs           "Bosnian"'
  'ca           "Catalan"'
  'ca-valencia  "Catalan (Valencia)"'
  'cs           "Czech"'
  'cy           "Welsh"'
  'da           "Danish"'
  'de           "German"'
  'dgo          "Dogri"'
  'dz           "Dzongkha"'
  'el           "Greek"'
  'en-GB        "English (GB)"'
  'en-ZA        "English (ZA)"'
  'eo           "Esperanto"'
  'es           "Spanish"'
  'et           "Estonian"'
  'eu           "Basque"'
  'fa           "Persian"'
  'fi           "Finnish"'
  'fr           "French"'
  'ga           "Irish"'
  'gd           "Gaelic (Scottish)"'
  'gl           "Galician"'
  'gu           "Gujarati"'
  'he           "Hebrew"'
  'hi           "Hindi"'
  'hr           "Croatian"'
  'hu           "Hungarian"'
  'id           "Indonesian"'
  'is           "Icelandic"'
  'it           "Italian"'
  'ja           "Japanese"'
  'ka           "Georgian"'
  'kk           "Kazakh"'
  'km           "Khmer (Cambodia)"'
  'kmr-Latn     "Kurdish"'
  'kn           "Kannada"'
  'ko           "Korean"'
  'kok           "Konkani"'
  'ks           "Kashmiri"'
  'lb           "Luxembourgish"'
  'lo           "Lao"'
  'lt           "Lithuanian"'
  'lv           "Latvian"'
  'mai           "Maithili"'
  'mk           "Macedonian"'
  'ml           "Malayalam"'
  'mn           "Mongolian"'
  'mni           "Manipuri"'
  'mr           "Marathi"'
  'my           "Burmese"'
  'nb           "Norwegian Bokmal"'
  'ne           "Nepali"'
  'nl           "Dutch"'
  'nn           "Norwegian Nynorsk"'
  'nr           "Ndebele (South)"'
  'nso          "Northern Sotho"'
  'oc           "Occitan"'
  'om           "Oromo"'
  'or           "Oriya"'
  'pa-IN        "Punjabi (India)"'
  'pl           "Polish"'
  'pt           "Portuguese"'
  'pt-BR        "Portuguese (Brasil)"'
  'ro           "Romanian"'
  'ru           "Russian"'
  'rw           "Kinyarwanda"'
  'sa-IN        "Sanskrit (India)"'
  'sat          "Santali"'
  'sd           "Sindhi"'
  'si           "Singhalese"'
  'sid          "Sidama"'
  'sk           "Slovak"'
  'sl           "Slovenian"'
  'sq           "Albanien"'
  'sr           "Serbian"'
  'sr-Latn      "Serbian (Latin)"'
  'ss           "Swati"'
  'st           "Southern Sotho"'
  'sv           "Swedish"'
  'sw-TZ        "Swahili (Tanzania)"'
  'ta           "Tamil"'
  'te           "Telugu"'
  'tg           "Tajik"'
  'th           "Thai"'
  'tn           "Tswana"'
  'tr           "Turkish"'
  'ts           "Tsonga"'
  'tt           "Tatar"'
  'ug           "Uighur"'
  'uk           "Ukrainian"'
  'uz           "Uzbek"'
  've           "Venda"'
  'vi           "Vietnamese"'
  'xh           "Xhosa"'
  'zh-CN        "Chinese (simplified)"'
  'zh-TW        "Chinese (traditional)"'
  'zu           "Zulu"'
)
md5sums=('75fddb83d97995ad144202b2ef888cc5'
         'c3de4310aa2559ba07b8aac0e57f3e5e'
         'fb86b209fa049b80b58baf3968a426dc'
         '224f247813ef4ca1f88c4a25a38d3d62'
         '1343496b6a59cd27749c2a6594d48f39'
         '6c0eaf6f291f6f1b2f46b65d64946924'
         'c93deb14a86d1637d1721bdc20281c1c'
         '652e90abd171b6571234b550cd55aa6f'
         '3ae98cb1bf4ab822303c656513e2d653'
         '9870d99f6779a66d491d076a5fca25b0'
         'f7d5a9d6184e84f0e5bcfb2812749920'
         'e1a48222300e5deaf724977648e4c4a1'
         '2b36976f43a879beecc678e1d0084864'
         '07eed267761f4e73d940eb6887735b2a'
         '9322bbd790188c833f491f5dc95d8948'
         'f897a5c6025cdaf8df44d0a5b37f6b54'
         'd789c84ca758d2e600d925a36c850525'
         '67db1c98de3bb4e67018fe228c77515e'
         'fa47c37a644be7ba5b2033d3b5fb482e'
         'd180464f192f95d3073ccbab8e3c1b91'
         '8ce29169ffde79e9c495f56d4f8ac42c'
         '4b131105c7d8593e26eeac4e450991fa'
         '5f7b9219a2972caab0211a6d3bc890e6'
         '0d5b9087336e1f26b6aa0a89f2c3a268'
         '4d4908ab54ed48128aa74600a8242b9b'
         'd1de17bdffb134d6b01bfef76bd4fad7'
         '4b95e0d158a51777ba0125a3275eb381'
         'de2d52c7440d9f77249a90138098bfcf'
         '1dd33a41d7d9bcfa14e24787f1d3ae23'
         '80dd660bd4b72866fb0be4804de62ae1'
         '56521a4125a610b2ece70af8fc23a6ef'
         '0536feae61c1a6e9a197cf7a04eeae61'
         '716985274eb2080039da00693f81719a'
         'ba35cd9cb04419ad54f3690f88b4e855'
         '7af588ad9b6d4b03e903aa851ea0db8e'
         '2349f39e99a2288e09826e8cb3da863a'
         '7fd3e29432cc2fe9b150a22dd6278d4a'
         '17c70a737b7c004f448e7e2cdeb8cc7e'
         '7cfa6141b941784def8ab94c63e3dcc8'
         '24a2fa21ce5fbf8380a8a1fedc181df2'
         'fd220e479c4c79ed7ebc326ae9215203'
         'c3f89425ead34c770bd922ab866707dd'
         '1f2aabe79eefc5131d62a73f6f6e8447'
         'dd89f1fef597d1816c0177402f02f02c'
         'b2a19f049f74f8a7d568226c6212c41a'
         '67f257a537056f7b9488443be7719035'
         'cd0d901049e104edc86be97cd290eecc'
         '5df6ce00fdf2ee2ca18616a8a02e4025'
         '0d190e20ca92d07c217e5ba87fe7a2a6'
         'a5f048555fac7a7e204ee6e1352545c9'
         'e38df15b5b01d32c13fa3838ee40561b'
         '50b5c17a4f76234861eb892f5c3508b4'
         '7c449d2062a0d2f504081f75291e97b6'
         '33bf9b1001acfac08b57e9e72582385d'
         'd12582d7fca7b70e284564e93a9e7a7c'
         'a6938c94add435b60aca4f1ff182b296'
         'a40a9a1c5d673fecccaffce8dcf3dbca'
         '8dd4c3bc7ee7cb3b187356f4e5cd1939'
         'edf85c0f62b68bde846915b7420964f1'
         '48698c3e7e36755342b23a8b8450e97b'
         '569c49c6ef5b0ed0051d600554bc9e63'
         'bc22e6f3165a4424399c0cf3f983702b'
         'a9840a0ca25a2b1075fc9987c4f0738f'
         '6f0133a044d115d4f989dbd97f32ff24'
         '2aeae469466e96c4a9d25d67dce576eb'
         '2f2d9fffc55839e0ddbaeb070be3a492'
         '97001b231ba4aa499626dd8523397d25'
         'fc206c39e990e8b4b6e2e7901fb5b0d0'
         'd1da18f8fffb80c21f7602155a09443b'
         '9b8c5c740ffd1e3966798c8447291b62'
         '6e89afdc16498d8d12ef063a7e51d1c6'
         '4afde192fa028520620e76546573985f'
         'b8cf2d83173f09df68419d336409d4f0'
         '9b4e35f5d9fa8f5c2d68aa09e4977a6e'
         '88390b8c6fa00a96c5458c80ebc3579d'
         '9e916b512fc4123a2a0c72682cafadf3'
         '6f6312bf0af8716e4e1dd742f8703859'
         '642ef6980555c1e64bf6d534d1e3ff2f'
         '0d0fa4e3f726716a1eeaff328ed40339'
         'ccdf5e3ac4343d3331e9e7059c048cfc'
         'c6a7067449b84736d9302847dd7d48ec'
         '49800317440543cbd015a9cdcad5b8cc'
         '07a122b91d5a5c6bb232db39db84debc'
         'bb6c5df073c057142153b8b040704592'
         'e892760111887ca4ad9440909d710275'
         'eb90991657102d71fd3322077bed116e'
         '398c1e060d0cf81851d5ce19c2052d5b'
         '56b5f0a9b1e3dff8680da1c75a3126cc'
         '37dc47466a95645e1d027e14dea51ddf'
         '88eb3f40d4c72d829e2c98a16f752dc9'
         '5d5143623cc4ed84b7f1a83624aede10'
         '57b98b6bafaf32e05ec90574547060ef'
         '5f8a89c8da63f2de33adc04c33b0b279'
         '8d0f797a8df484b08baa39aea54b6743'
         '90c077bbe571c522a2532ccaad83cfa9'
         'd8b75bfeb5f82e68b55fcecea20db51d'
         'c9c1aa10ade8be974881c3292e9e59bf'
         'b79524e12f3b37a36c745971c16913a4'
         '77eeb0f7ab93f99ca00382fac560e511'
         'de19c2f7ef54c3c87be0318057f2dabe'
         'd9fe6ac6b0a014e1c6f0b5f675948c5d'
         '7545d5d242e37880db43b1d453c26142'
         '1e9f7fdbf96f10938614f51a009bd330'
         'e9a6d082ffdcba0f7906a089b483e9b8'
         '57b2e4c53b909d73af57552baa2e98db'
         '1095db81ee052d41fbe7094db69ce7b5'
         '5a317109111366276e3697bf36d7d45f'
         'c6d8f7e03141a22f7666020a9f1d235b'
         'dbaf21340829f44a9aaeeac356b3b44c'
         'eb79101a7adbda5d939b97648703799f'
         '41248204e02207969a5035c432102db9'
         '7aa2f00c1560535db70a2a7869e502a4'
         '39e6959e9a4418a2413874d1a4cd2891'
         '2ffaa41c19bad55d0c4c8438d917f98a'
         'ab8cdc9f4c38ca58ce81efa72e1dc773'
         'd53657de0ea60c0fe8a1cb7496d1c47f'
         '9404dbf942e81b45ff1503be91c17674'
         'ca9d45137fde86bb2305cd1a63931c7d'
         '2ac2df1ef3ec43edbab47abf18318500'
         '5908a58c63ab90786d5c417f2c3f724e'
         'd00bcebb8beca6febfa0a74318007f0c'
         '2e40c8095c88d8421f3d85c39e88c029'
         'ccf2185b62afe5833698fb382d55d53c'
         'd822954072447e0c2a372d51a9d0c29f'
         '44be41def50bc062dcaa1dbd9d7aef1f'
         '5f1577f3b6e981440b90bed7a65b6960'
         '68bfaf927bba0a97752519497b57dc23'
         '535a62d29e946811fb7803fd4fbe4c04'
         '114587b3c911a9983f296f4700f8af54'
         'f12b8034c6961c7e8534045072f59b85'
         '751e6c87e0354d048b4375c0882d49d2'
         '5452ae36637952d09313d98d7dc87051'
         '2b13d8f3087bd9e5e66ee854813a9366'
         '44adea39be7c925ea4baf0bc6b9e2e72'
         '099e102d4345a26b30f8b032108195c5'
         'eb7019fc5f06e67c8cd5d0051a185a0c'
         '3563fea9461d01266b216323b64c5eac'
         '82183b7eb308fa0c39d71d9a590ad6d4'
         '93bdd76f3c263f95edd768b0ef373104'
         '18718b70b3760bbf5dc55c9273572603'
         '4c22a9d89f98475a9cbc957347b34ec8'
         '66db86b489b817baa986fc5cfe1be0ad'
         'bd2dcd8141337f208f766f4a912bf202'
         '681b58f03aae9b14efc1c4045b23a9ab'
         '6e4d0e67901d3a49d10fe147502d90a8'
         '9aa04ecb7e7e660c2b35d72b6a0cb51d'
         '4bee00ff0cc93690c28909a7ce7d9ea7'
         '8eac158a16ef04ebcc2c100058a44a3c'
         '02841e3d8fcd35f549fab37f8f62099e'
         'bbb4d246108780b441265701b8aa23c6'
         'e24cb829e6264d77c28f0a0f59388fdb'
         'd27d08ba9701f5154c4e2e5cb0faa04d'
         '0c94271a76be9de6832f77e5043e9c59'
         'b9b0026828947081b134f5b7142fe650'
         '4adc31e7907087cb021372b8a3e0626e'
         '6b82847577f023bd06a4720fad9c88b8'
         '0f87362464f4e0b3481e6395ad12ed20'
         '08b135243e2c55b4d093886f2679ad99'
         '652a0549b6f997827c01bd3175f6ad39'
         'c3af09e12c199dc007eb221a231c3e27'
         '144514ac75fa0bf46927101c7ff85eb4'
         '9b796ad0fea824dafd1d6d8244a6eaf0'
         '7d5f7971683076aae1b086328744b74d'
         'c8f5a88553a6de68b790a8333d1d3923'
         '5034d566018b1c2ce68b592a4fc37a4b'
         '7f4b93d0bb3578c5fc225f15167dc76a')

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/still-}
    
    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice still branch"
  provides=("libreoffice-$1" 'libreoffice-langpack' 'libreoffice-still-langpack')
  replaces=("libreoffice-$1" 'libreoffice-langpack')
  conflicts=("libreoffice-$1" "libreoffice-fresh-$1" 'libreoffice-fresh-langpack')

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-still-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done

