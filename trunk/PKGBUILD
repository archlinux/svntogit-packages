# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase="libreoffice-still-i18n"

pkgver=4.3.7
pkgrel=1
_rcver=${pkgver}.2
#_oodlver=${pkgver}.0.beta1
_oodlver=${pkgver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

# http://wiki.documentfoundation.org/Language_Teams
#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af           "Afrikaans"'
  'am           "Amharic"'
  'ar           "Arabic"'
  'as           "Assamese (India)"'
  'ast          "Asturianu"'
  'be           "Belarusian"'
  'bg           "Bulgarian"'
  'bn           "Bengali"'
  'bn-IN        "Bengali (India)"'
  'bo           "Tibetan"'
  'br           "Breton"'
  'brx          "Bodo"'
  'bs           "Bosnian"'
  'ca           "Catalan"'
  'ca-valencia  "Catalan (Valencia)"'
  'cs           "Czech"'
  'cy           "Welsh"'
  'da           "Danish"'
  'de           "German"'
  'dgo          "Dogri"'
  'dz           "Dzongkha"'
  'el           "Greek"'
  'en-GB        "English (GB)"'
  'en-ZA        "English (ZA)"'
  'eo           "Esperanto"'
  'es           "Spanish"'
  'et           "Estonian"'
  'eu           "Basque"'
  'fa           "Persian"'
  'fi           "Finnish"'
  'fr           "French"'
  'ga           "Irish"'
  'gd           "Gaelic (Scottish)"'
  'gl           "Galician"'
  'gu           "Gujarati"'
  'he           "Hebrew"'
  'hi           "Hindi"'
  'hr           "Croatian"'
  'hu           "Hungarian"'
  'id           "Indonesian"'
  'is           "Icelandic"'
  'it           "Italian"'
  'ja           "Japanese"'
  'ka           "Georgian"'
  'kk           "Kazakh"'
  'km           "Khmer (Cambodia)"'
  'kmr-Latn     "Kurdish"'
  'kn           "Kannada"'
  'ko           "Korean"'
  'kok           "Konkani"'
  'ks           "Kashmiri"'
  'lb           "Luxembourgish"'
  'lo           "Lao"'
  'lt           "Lithuanian"'
  'lv           "Latvian"'
  'mai           "Maithili"'
  'mk           "Macedonian"'
  'ml           "Malayalam"'
  'mn           "Mongolian"'
  'mni           "Manipuri"'
  'mr           "Marathi"'
  'my           "Burmese"'
  'nb           "Norwegian Bokmal"'
  'ne           "Nepali"'
  'nl           "Dutch"'
  'nn           "Norwegian Nynorsk"'
  'nr           "Ndebele (South)"'
  'nso          "Northern Sotho"'
  'oc           "Occitan"'
  'om           "Oromo"'
  'or           "Oriya"'
  'pa-IN        "Punjabi (India)"'
  'pl           "Polish"'
  'pt           "Portuguese"'
  'pt-BR        "Portuguese (Brasil)"'
  'ro           "Romanian"'
  'ru           "Russian"'
  'rw           "Kinyarwanda"'
  'sa-IN        "Sanskrit (India)"'
  'sat          "Santali"'
  'sd           "Sindhi"'
  'si           "Singhalese"'
  'sid          "Sidama"'
  'sk           "Slovak"'
  'sl           "Slovenian"'
  'sq           "Albanien"'
  'sr           "Serbian"'
  'sr-Latn      "Serbian (Latin)"'
  'ss           "Swati"'
  'st           "Southern Sotho"'
  'sv           "Swedish"'
  'sw-TZ        "Swahili (Tanzania)"'
  'ta           "Tamil"'
  'te           "Telugu"'
  'tg           "Tajik"'
  'th           "Thai"'
  'tn           "Tswana"'
  'tr           "Turkish"'
  'ts           "Tsonga"'
  'tt           "Tatar"'
  'ug           "Uighur"'
  'uk           "Ukrainian"'
  'uz           "Uzbek"'
  've           "Venda"'
  'vi           "Vietnamese"'
  'xh           "Xhosa"'
  'zh-CN        "Chinese (simplified)"'
  'zh-TW        "Chinese (traditional)"'
  'zu           "Zulu"'
)
md5sums=('ec993b007b23a9f272b978e6e27f4bb9'
         'dde2a36195cfc3c53f2af7f6ef2def3a'
         '4b2f67b177abbd312982cd8d2f439ab7'
         '528f4d2df91ee28aff0bb27a297842d1'
         'bee4d7672d4de43790e55bceb32641f8'
         '538dd7d2b34ab60c22e8f48c19470310'
         'f5fe70231069a34f0c89553931c43e54'
         '3984ec4ae80079ba4ec2367c98e44bf0'
         '20447a6ae38e7ac1d2b2bca90d4b7cb1'
         '5315256fde92a72815abec1a5762c953'
         'df7be8942c5c4f499c3bae17d424d089'
         '1d0ad1b8e1bf859b1ac64096e833e02e'
         'a43cba75f379989fe0109bc83cd56730'
         '61bd8536ba5d82f58ee78c746d014883'
         '8c59a4c6fd6a7ba40f622b946c55123e'
         '00f6cdd2380222b5244056d966d5d7f5'
         '2c9153338abb40028d2a268359797bce'
         '37d5b8afb415b8f85d3eb1d6ea420385'
         '21a93743d6cd474f2e97d99e38f3d944'
         'e3195eaa06f80406bf9397396fb2aa33'
         'aec0f2b82f2ca46a2d0325304f1e837a'
         '8e27e43df33b37d884ce8163077757a3'
         '116543710cf2398c32d3d8d9753f48f5'
         'fceba86583100a3cd342ecbc5d695525'
         '2820d8b482a0c844da2a8bb63443e542'
         '18cc44b9e34f351bce86afeff6eedf45'
         '526416c1c718e8ce3eb66625428a1aed'
         '8696ad49df371f0394ba6dfff6721b70'
         '9d1cab51d410e647d8cc839c6f38401c'
         '78e34977ed86cbfdee1f92da06479a82'
         '48258a46ff8200a65997965b33373e21'
         'a9a7c0233876fb90c49318bf23fc4e0d'
         'bd30c77dbe14dc13ed8ae7549f2bcbbe'
         '78f33000c30ad15b1be04da77e37d57b'
         'd505fb4409071c884416e1c5db9a97d4'
         '1c8219f0900e13a0a4c61d3b2e37f561'
         '8d2b96af3af0bc1cbe47fb73e65672e5'
         'dc481809e79ed8f18b9c5f912f136dfe'
         '3872d251036707ae596a0dc0edc3726f'
         '3e409025e8b9afc6cf35b57fc3eadb54'
         '6e03153f08b3bb877303e5c117c5e4a3'
         'd6d59979ed46aab8f00731b099d74f3f'
         'b0c5aa5599397552c572883af219147f'
         'c82dcf976e6f019e71adf19f99a6de3c'
         '32e739c3d74428cfd0b1943104d22596'
         '86bcd5b4eef48a5492bee8fc721ff523'
         '5c0c8887e49ba0704a0e088d40ea483a'
         '8239f9a55746e6cdaa7a609f6b8f31f0'
         'af70eab34bb4fd80eb4907e709aab665'
         '561c1dbf08bf661f2a2b57000fa8a2cc'
         'aa3aadc4df776be13bc4176a06dea10e'
         '31f98f030a0d12a6b4cfb1738a2a4791'
         '6783a07315d1927d243d480a36f869a3'
         '2102722f72356edb2835af260c40c381'
         'caa3c90d52f3defc83ab454cbe931624'
         'dcf012ed147d581ae4077674fbf622d3'
         '5c6cef05b6c748e11aa78ef53fe37525'
         '64520ac771a8289d2523056dc27bb0a8'
         'bbd2890da4795cf81e3b75ede93277a7'
         '517f2295cf02c990df1cae372c416ad0'
         '2cf96eda11cd4b339f6456ba22701e97'
         '1a096389bcd837cd39e45fc1ed76320b'
         '7e69e759203fbda5a4d97ee4e6be6c74'
         'a79f1d2c11d6e314a0bdd1bff68f4998'
         '31cea401a1d091117951c5d05210dd39'
         '1670cdbb04c6af13a764e16f7d26f2fb'
         '101b69dd55c12dc006fb2d72860e8587'
         'f1d14f1de2bb9d6da504f134dc5f48d9'
         'c022ebb64de0845aa9bc48f4cadc1572'
         '92ceaf5613844432036a5db84fa4f1a1'
         '84bc4bc3da52ea712cb67cbe6fed147f'
         '256ffa056c20b2932eca2cf2d5614f9d'
         '9a450a82803595efbf6ac4202ee3ff1b'
         '53e48e2ad18cafd918cad4f976c3eab5'
         'c82ed503b28c5587094cc8ce13807794'
         '9a81c5a657240a30fba222a112a23c83'
         'fa09c710e6f5e3de9445faf93d4bca38'
         '07e2914649de2a4e4f1f52cbe26c5f5e'
         'c96a44e2c1c60c6feefa23d70c598b05'
         '096f90f4bcd939ca560412e6fecb0061'
         'd0675942a8df0867580905fd3120b2a3'
         'b0a5ba926eb13cebfad2e394c00d559e'
         '4b026e6cf391244c1969aedb169ed302'
         'd45a61d37d8330255c950b8f6e3a4ae0'
         'e7bb49d7f8263d7f192187505680ffa6'
         '7e08396b7c09ab9f6ce2b4ef98cf3c72'
         '777d5cd28292224ab156b2fbf4b050f9'
         '21d56b49cbe3175d4cdad016b8d312a8'
         '119033815f30f04a9c05857ca06a8186'
         'fa413a462f6e0cb98115c212b8585d5c'
         '16bb7183c560dc2fd05a2e8c95853d67'
         '08a357788ac6dc17f1f4490f8ea015ce'
         '66c3054a3b06fcb549ca2c857f849a74'
         '03dc14f72bdd78bbd1e6a82aa7d0b7e3'
         'ed9fef98492e8507e092bb3029cdbeb7'
         'e248effed181ce5d441d07740c2e34ac'
         '2cee527f703ceb3e250003a2a9acfc5b'
         '502a2ef88a34db6c23c4b6c88dd5cd72'
         'd6c256e1de93f0e80d9abe4d85dc6e95'
         '48df9a06d241246bb1c97f1812d545dd'
         'b91c0fea404ac47d267bd9d056ac5828'
         'bc44140ea3a0254424b0492078ae49a9'
         '8e0f3aa2fedb48e0cfc8dbeacdb713f7'
         '888c51721615cb675af3a3530992aee9'
         '6b415313c6d86712f54779ccb9c20e74'
         'fab44f08a629d8a929e4a04d53c68d8a'
         '0080c9c93b793b8ad615882dbfda117b'
         '4f4c292df04a94b268e21e9b3c261f40'
         'b4ebed09e74d7b985e3608b25a0a5b6e'
         'f46765d53053551b0c3f352ed82cec43'
         '17b5f930648a9d4d395b828279a7d8f3'
         'c8f530ce370f4da1697c86ecb9cf47ef'
         '7641ffce1bcee228db06fa2c7b89a91e'
         '0bc7f890b8fb361e26dd66c3e041c507'
         '73e06be7fc15d15084515f56ef88e9bb'
         '6ad80f25227483f420ce731a4fafa41e'
         'b54526222993b8664ce3ebd24154815f'
         '7f0369737c72b7d039a24ff2a94ae118'
         'ba877b6d47a7ef1203caf0c3796c9ede'
         '798c3eb74baff2cc54d2d7db912903f8'
         '1fbe05d69a42d8e14d65cb149dbf9241'
         '737cd398685573c8b542b39174c3c735'
         '502f8c7eef09477e83a1b76b3d32b6e5'
         '76540346c2ef1a47fc37dccd3ffe2a98'
         'be05c7f83865d812c7f7f4f2b37e9388'
         '1866a68571e731d10b57b0a324dd6fba'
         '90e072cb9bad3958910ca76c50991eca'
         '3d0bc5dcf259b5d2e46d5f6c20b26313'
         'b3a1643607f5183a2d91ddb3b386530b'
         'ed21c5ca7f9e40de919c6940beba3eed'
         'c712507e16eeb605329c460c46f04976'
         '3da2254d29d0e5221f7361702b2d2cf5'
         '7658fb6f90f82e6e59a0e652c2f24f93'
         '6ec1bc934bbfff57134412a326f09d45'
         '39659765c95540f5f641c53beb80bbb0'
         'eb2736fa166d8929b5bdd425ba008854'
         'e5688a2e06d9305324c01ee1d6ccbf34'
         '440a5638d471e4dc5de5fa4ab8d5940c'
         '9517fd22fe69851a35b16b9a8f2cbec2'
         '46ab1001446c84995a9faf39939c02e4'
         'f1ebf12a833dfc7a44fb86db7eae8eaf'
         'ba6c4d17d3523e10e3cb5ac63b8816da'
         '1b0f10a469e15ddb5a90a0222dfd9ff8'
         'c3566bc0ef5b6b8e65ffa21c448257ed'
         'aee2c43dcf99a36fb66758d125ed264a'
         '7843c7f06db97216fc9c5994f9febe51'
         '7fd3b2c91e75ae63b6834a8902eae4db'
         '58e49589a788f1d7b9c35544135df5e0'
         '7c985d1e7de7ef3ce87838c779173f9a'
         'df07db97bd9286fa0088611f75375482'
         'ae704bd43832b31e54e9c5e3589497b9'
         '87107e77d0cf9d14e1fea017e857959c'
         'e58abe74c782aeb88ded494e3a3e8275'
         '13071b8c92192c00674f0f22ee3cd040'
         'bb1ea1a2d1ab887685458a4655883a8f'
         '01fc1386d349be92d6c8f151e8195bfc'
         'c04a11738e5d239e95b349243ff3135b'
         '919dbd91215e67a15fa507b2b0de4c58'
         '7e0069887f413664c71face786fbc223'
         '725d58802fee684bfaaa818c1e6a6dc2'
         'ef99f0b1f7494ecb330fcc221c5923ae'
         'd3d43b0b04a90e5e685e3359a3c15eb1'
         '8857e64fce305d09212f0ce5b30d895d'
         'fa13a501a42d2d6c8edbea084e215e01'
         '08c278d9543783449abfe25c8451e180'
         'a536ad693722cc42cb94acc6bfc89ea0')

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/still-}
    
    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm || /bin/true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice still branch"
  depends=('libreoffice-still')
  provides=("libreoffice-$1" 'libreoffice-langpack' 'libreoffice-still-langpack')
  replaces=("libreoffice-$1" 'libreoffice-langpack')
  conflicts=("libreoffice-$1" "libreoffice-fresh-$1" 'libreoffice-fresh-langpack')

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-still-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done

