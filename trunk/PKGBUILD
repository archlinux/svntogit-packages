# $Id$
# Maintainer: Thomas Baechler <thomas@archlinux.org>
# Contributor: Jaroslaw Swierczynski <swiergot@juvepoland.com>
# Contributor: Michal Hybner <dta081@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgbase=firefox-i18n
pkgver=35.0
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox>=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'az     "Azerbaijani"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Lower Sorbian"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati (India)"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Malay"'
  'nb-NO  "Norwegian (BokmÃ¥l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi (India)"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'son    "Songhai"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=()
source=()
_url=http://download.cdn.mozilla.net/pub/firefox/releases/$pkgver/linux-i686/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

_package() {
  pkgdesc="$2 language pack for Firefox"
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}

md5sums=('63c6b999652afc2995fe714cdd9cb339'
         '9b7e2aa953681bc86aa8db3705a7d806'
         '3f1f3855f38d0e982e13224b1acf92c1'
         '5a7b70d23707435db918e9d3026b9be4'
         '565b6a8a134e1d1c040ec3e5500e02fd'
         '5aa9443f6f3414a9f89cb660775f1a79'
         '07ade08b1c3be1371b3b49c6f2472cb6'
         '37426e0b0abac918647109120e586030'
         '31dab6e5cb1cab2190051a0bc5ee77e7'
         '2ef6f78a6e4f8157fb1034940cd3ff9e'
         'ed5985f7c5b17df32a6f14faadecec4e'
         '04644c105d4973bdf1185a799c630b30'
         'd9d1415ba67ff90c01f74a4ad193989f'
         'f72d89e7387992ae6b95731489541971'
         '544b4480d2174eca2e903a97e55770d7'
         'a1def90dccc2a0bc31592fc4c5da30bc'
         'a75217ee2a7dfe881b892e17b882f0e7'
         '95732afc87047b26d646e795cb135f6b'
         'af801a324c873010ae84be78b61905d8'
         'e0e1cc706e3b06c37c752bb03b843e68'
         'ab0154ce6c933ccf4c1c14c2eac6a1da'
         'bd699eb2d73d03fa7673231730d6ae33'
         'd06c534ddfa3a872d8a3e36b38690df9'
         '58f23f8acd946170e25a7204f1256cd4'
         'fadd0038f141550db277f99559b5bcdb'
         '8ba84a2ef64941e69dfba4181af0e24b'
         'cf33d1203292213805e70662ee086144'
         'f772f0e58e081872c65a198bef5ece44'
         'b1255dc24af5d4c546cebeaa8302bb80'
         '67046c151661f003678cc660042ea85a'
         '9de02f466173b64dccaba78ff9fa89e1'
         '92baae321e1275039a1c1280db61d5b2'
         '0f0fd08a714c958fae5b1c878a69e1ec'
         '599c592edbf0d03c677f4bacb5c6fb65'
         '043d86df40db69804819d125c86968ea'
         'c94b3d1a8726a88e5e6c6da1258de9a3'
         '93e156ff59f1057613d830112453421f'
         'd24bf8390f0063832ac28e4221ddde81'
         'c3e86f1e0c83745f5e13f44a151e1466'
         'e596ba5b66fa1cc7a741eb886039ceb9'
         'd00ea7b6b88fe22c8cdda30ab14c631a'
         '934188846ffbd7cfee0532b6aff3ab72'
         'c58a2b57449d25e8dc99d0dfabfb33cb'
         '7a8a8ba22695dc654537ebea3b5501da'
         '2d1cf2eb8b053e72ba3728abf61b51f9'
         'fd8f55ce12d60b713f32176738f9388e'
         '1a795877226fbaf7a85885b10462e711'
         '61c7ebb9693658bff5e6facdec95e0d7'
         '696f6c6e726f0933c1802b3191d56a84'
         'c400b715440af85eae2444c2f76d3cce'
         'efaebdd33d17d21d7878e0f9edb576f8'
         'c5da552fc30171b5d4e7d94cb3306df6'
         '4bb860fd500f681d6078d1fe5e7123b3'
         '606a12e9b1be346b14c536f1e9bf7060'
         'ee6d51f05c7033dad77ff40a8d06056e'
         'cfdd76e23c329a3da6e841a9f7520ea6'
         'b5ee4d7a76d94742af98c9a656c653b5'
         '3ab19edbe0fb9090751f624e8c38455c'
         'cf9b42db52d8e05386ca4e6e455a49f6'
         'f69f109e40a623d3b54a556c5649d321'
         '9e247b58f60a19e8a33642a821bf99bd'
         'd86ff38c9bdff075fc632c16bf771fd5'
         'fd16d71b8678bcc5cf17e8a8b616b44f'
         '7a09fec660b9b4c0a7160be8eeee7c88'
         '28a4dbdde052e00677677f9cf4c4aa44'
         '20561c48d42a1e756939198cf4a58f18'
         'ca9028e7d0624caa7c9989c488efb5ab'
         'ea9a60aea3c579194cae8772f09bac3f'
         'f641df66560cb229aa2d82546840206b'
         'de7e199d67a21b8177d5a857b28d88ae'
         '12a3c08bd8a64e54318bebbf5e703596'
         'e7b78d736b9a347cb45282202b325390'
         'b3787856d01a55f52c6c045d295101c8'
         'ea123667b8ac71a9322ccd7459be20f5'
         '06269d90cd30f224ab84ecf08fd28e91'
         '3a711d01af0020f0437e899daa9ac7c2'
         '7d64a86ffe4a73bd147bee4b120c0cd3'
         'e269c5f8123ee1521d7102b676994df9'
         'd78260f403e3d29bb50078a8633e811f'
         'a5713ecb36a3afd83fb81098d800941b'
         '7d3fc762030b62adfd85c34536a632e3'
         'e57aed4dfe07818b3ceb220b8150f930'
         '2ac49f8963baacde8c245d37c21385ed'
         'f7606e5e15d648b6cf4ecbd8c5925ec4'
         'd7fdfbad42075c504d5941bf713dcfc4'
         '76e1775121ca95a8759069873e9fcee6'
         '291c60af443a010d250d444d49f8f760'
         'b142e2bb680a89558859a613f280d0ea')
