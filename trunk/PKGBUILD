# $Id$
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase=libreoffice-fresh-i18n

pkgver=4.3.1
pkgrel=1
_rcver=${pkgver}.2
#_oodlver=${pkgver}.0.beta1
_oodlver=${pkgver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/fresh-}

    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm \
      || true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice Fresh"
  depends=('libreoffice-fresh')
  provides=("openoffice-$1" "libreoffice-$1")
  conflicts=("openoffice-$1" "libreoffice-$1")
  replaces=("openoffice-$1")

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-fresh-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done

md5sums=('9dacf97b9ce8940374fde3f8b136f92b'
         '04045d0a217d1e28fc8cec5859b67f0e'
         '49031e3b1f9d325b874e2057d6ffb99f'
         'ee317ee0e447bf5e420b8b7d42b30711'
         '8e08adca3535ef47158465cbf11e4125'
         '6656f0611d9e7721e329b3efdcb3218f'
         '8ab4f84e219ddf2fd8183dc1063b462e'
         'd3f0ac3c6119ff24d3b1f006982ed63d'
         'eae962efe609811bf2668b8cbde4758b'
         '11d685aa8731d8f896eeb3ef5c372ce2'
         '5c82c7dcdd1d1fcdeb3a38264745d703'
         '31aabbbe494f9f3c15c48800b7f4620c'
         '6ae87698561f33f7dfea4fa259aa32b3'
         '98697b6282a132caa0a2bfae1efcff5a'
         'cbfd0290ab95bbcb10344b19a58d6a34'
         '60b7752b49c53e4af3bf28dc4c32d142'
         '9c94db24b0facead5fb6bd04b98be717'
         'c0184f14c50fc9c1c1eef6da04166869'
         'f66f376eb21f130510e8bcb72e5c965a'
         '68e88c739e1593732f77feb2c0cc3576'
         '3621029f24fb9c3f509084d3593aeccf'
         '46bb4ba3073e1850291c99316f8b7a0e'
         '1d08080028e604d240caebcc5a36115c'
         '9a94631d83ca15067b9338afe4fcda39'
         'b86348ea78ec2cc1b7de05abd92a3187'
         '7b966c2e92f665a4b04d0511f17d188d'
         '6cc640f75878f7ee1042da3784533472'
         '362dc351269ee0c91817399306391eb8'
         '421c72d671ca9e2c5695f8e53f15ca57'
         '464609fb6e4ee115f3e257d0f0183c01'
         'd87cfee17357e6a37acba219a9eea9da'
         'a20ecfca9d67eb0c7d18a4fc6ae85c17'
         '6c48b0f5d56d708272655ec47bed5394'
         'e341aad0fbc3c75764f05d6998f55477'
         '48f3e0a91cd05efe29a7b7dc3ae29df7'
         '6fd18ea76f3d474438407dc05a2980c0'
         '26a44b4c0bcc47d542fdcd2efbf32fff'
         'c437359acbd105ba9316d330a536ac6d'
         '18cd38644de0d9e427fb5c183209f22b'
         '675d7a56bbfb91889ab7689ec945af00'
         '9d1d9ada8034553bda6bdb73a8f0df5e'
         'e707521dc2c6bdbb9e3135d79faf3f24'
         '9a75e43aa6bbdfbf5ae08edf73faa9c0'
         '023a25e27ebe9c42003776c21214664a'
         'ce825dada2a9f4ced9c0396d0d4b77fb'
         '9298b0b912313c683f39024a37aadeb7'
         '007e3648698c6fabd3c125504141d0ec'
         'aa0fc76d8711ad559cda4464e692a126'
         '94024e8a53dcbf5233202645de1fc1f5'
         'e4fd1987c43f1a1212b731d7949b12f7'
         'e6504aed0c18b656a726a514b2eeb93f'
         '8ec2d342b0b7d1383b4d6b46ddc82d81'
         '75e8c77e1a9d5362629d3d42f4539ac8'
         '5215d7b4f61f754350008a09f80aaa2c'
         'b46610cc2f55f657b876b3874362cfde'
         '925251139823dc191ad1cf92cad072f2'
         '2753ae67d0efcc72aefb154ffcf8830d'
         '4ae50641f4fcfc372071bbe0c82483e9'
         '58204a367a9afb523176f394c92797e9'
         'fb25a753660ec4201cdab781b0a7dda3'
         '6048dddb7fee5c9dfb58fa0ffa849cc9'
         '9c5a4b2dc3e8c5777522891affe1f712'
         '4315b089c08be4aa36f2e937470e9642'
         '641e26f61a59374f9035232603ed13ef'
         '841cfc8250663a37679463f06c800028'
         'ab8a1d38eba71dc12656284dfa27353d'
         '3d18bc64c83e0367ac2e3b9413dc2a42'
         '6263be424ef34ea13b5b4b9edcc3776b'
         '44dc452be1188c6d20f879ceca03e217'
         'db3cccacbc990664d712eeb0b72792ef'
         'e116736e0382470444280f0a6b8e6730'
         '1eacdec32ab3c9da6b1ac660c1bd8e86'
         '6bfd81cc4a663cf7c43c0d3550057ccc'
         '522c2b6298bec434659b036efa73c249'
         'fc73378d8b07c9961909fd5d938acd88'
         '2e6f96372096e4a77db0b91ada59022a'
         '384afd744b685e440110e6fccca28cf9'
         'e1e84f5c2a1d8bd80abf3201df6c2f08'
         'ff911f705e623989a78ff2d514a065a3'
         '31041239494426c836ac6be8fbe5162f'
         '8055fd2d189e0713cdf83f5abaae83e8'
         '64220c36023b8c73b5d9893f9b204763'
         'bcd27407a69812503eae17abd27140a3'
         'c28979eca1f22a673aa91651cafa5de3'
         'fadcbb56df63768df6c87308de07a2f9'
         '7f35e51f7c4ade29b69b91d2bcce628d'
         'ab2bfc5786a1ac4bda31e13af99020ca'
         '51615984d158d757834bbfef4be630ec'
         'd5d50c2864f7fd288f9030ef4235f79a'
         'ef01173d4d4598f6891222cbe28d89af'
         '18be0b1d2d24bb4ad0cf0854fcfb95c8'
         '0a88b742cccb62b5a8d05d885b18bdda'
         '1124ca0e5c0d4d89176ed099ef786413'
         'ac0f6f41f85c671851152e59db10190a'
         '9bf95ba89f17c9d258c24e35850ae777'
         'e5124e072afa1b061483f2d9c9fe75b3'
         '9b17556065c410dbd8c93a8aef6ac6b5'
         '13da47109477ef0bb97b978cb976490e'
         '2de110c4f9ccc0df5042ff0f126358ab'
         'f7ea92732ea6bbb05ebc48f151a51741'
         'bb7db560b9f2155963f2a5bf68c1eb91'
         '6ce54d3c5cc2b536c282db44eb7fd873'
         'eecbebab7967c68ba580f1135bc46cc2'
         '29085020038c788792fe1713fcb9fafa'
         '4fa9e86370545d8db8c6460e79f4882a'
         'cd0e9cff3ceeb35def98b07db1fbed29'
         'ae10d6f645ca771ae8e7afdd7eccb7ee'
         'a89be786fbf01cbadf2dc337cf5287bc'
         '371b45f106dd98a80875f2f118daa642'
         'b4ec9199a09ca95850987691b8c433fb'
         '3fc73cb8a65b61b1d2bc273253abe138'
         'f3b8eb4c3dddd6d9dcc9cd8928987db6'
         '57ce832d1856fdc45fe0dc0d7e53ebb6'
         '5b2830a9143bf02aef5b2d8d405946fe'
         '2ed8e7a56459a5d962c543fd8f11892b'
         'f189b63ff73eb055b2da487d50b4fed3'
         'a01b053ff324d6fd0e66fa70e5419f99'
         '84762aa8bee7864be50f873deec60557'
         'd48b3969e5da2c58997a8aff4e1e10ad'
         '8036dbcb3c6b485a0dc3d37f79fae645'
         '13bbd67de64d2880f9e763d3e93a1c8e'
         '59efecb589a694de0fa3db09ecf655f1'
         'ddcfee28b75476efcc1a8ffec6b107c2'
         '2e5e3158d3c8d8b345fa49768c3a47a6'
         '3e296e06ac0780ef3553775fff118d8c'
         '3fd16fdbb9a0fa2f418118d0a40e7bd3'
         '615fc0df0aae73d13f8f702eecd9fce4'
         '661aa8a5ab61bf444f10fa72b2543261'
         '96f77a7e71b14fc692575f0b14313715'
         'da583bfffd3c55ae0d9d44e9e80b9f52'
         '51dc56e6c8b6a815660583fb5b86deb4'
         '81c9200d617d3a1d65159ac5626335bc'
         'c412dbb62e30ab968676e8d7689c485f'
         'd5d488d560aa577a6f15cfc6055970b7'
         '5d8206055c9f32c8ee562dd0d9558325'
         '13424ecfaec911eebfd777828a557f21'
         'a35a81065aea48ca9374345469c2d833'
         'e5556f466ed549a43387509e95c4ac42'
         '570412c9b91ef2dd13452e0705318f8c'
         'f81b6b4b731f2849055e5af04f6c13db'
         '92ad56a359f67356a369367083235408'
         'dd96619c24ab4b938ff838f168c6e8ac'
         'daaffd519976c5ad4361eac10b1eb572'
         '6acbca823415ae481ff6eb4a1c2cee64'
         '60e7042cb09588bf8df3720166185fc5'
         '734572ba4f71aaa4d2162a9871bf5c3c'
         'a2adeb7eb8ec3a6b11a1a2bbcdcc3167'
         'a1e7252f7f9fb900845745d4ab23cee9'
         '62f3bdf666c3f420e779326180b52d59'
         '4b1ae70ebba4314acfd3c00599deb293'
         '513c5dac36e446d8e4a644439af348d2'
         '30133afc52173855212b57ad88280085'
         'e8bd3a663a5c77c7dcb26f53c0fa4f3c'
         '70058091a9123b9c11f25f2773729441'
         '88f4a08f7fce81e9bb297cb2b112eb1d'
         'd4d9de081d32539c6c495e1d151ffa30'
         'ff9afcf433a2e3c6f2dc0aadadbd0134'
         '0604db72023cb7748f598174b61891c4'
         '638d52daff3da5db4e0ebffad1bead44'
         '7d8f3e178372b3ae838c9c18c08bf96e'
         'd998e1fc7db5336c05e101fce9c61486'
         '639aa31ad6ee503556b264e5706fae4d'
         '16dd667a5ae0bb6153513e9433a8a628'
         'f4a5be63679ae96b11e8a911ce76cb25'
         '32c38deabdb245f9c60ef97374a143ec'
         '47099a3c09179bd83a9c0af322d8d7db')
