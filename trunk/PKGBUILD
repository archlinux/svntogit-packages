# $Id$
# Maintainer: Thomas Baechler <thomas@archlinux.org>
# Contributor: Jaroslaw Swierczynski <swiergot@juvepoland.com>
# Contributor: Michal Hybner <dta081@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgbase=firefox-i18n
pkgver=32.0.3
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox>=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'csb    "Kashubian"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'nb-NO  "Norwegian (BokmÃ¥l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=()
source=()
_url=http://download.cdn.mozilla.net/pub/firefox/releases/$pkgver/linux-i686/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

_package() {
  pkgdesc="$2 language pack for Firefox"
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg csb; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}

md5sums=('f00f38892a74a894e068320d5200fc9c'
         'abc6ddd23d280f58c57aea71da56809c'
         '2d8dde8a34794b5fd5c44b4e6a72f865'
         '6cc4aab38ccad811b414b14060bfb172'
         '43042c700e136382fb007ddfde0e8e7a'
         'cce37c8d3fa4de2acfcc98b48fef7b2d'
         '0263ddb512c971f77ba4f57532aa97c7'
         'afbb287fd1cc0c420fd5b629fc1873e6'
         '856a4ec81153b8e53ea305c4235b4d43'
         'c50f7e9d0c1e365183a7738d93bfa1f1'
         '847af502efa6eac23852fe330708b0c8'
         'af26fa54eb50e89eedc032b00e9e0f87'
         '847a6f6d5ef0af86e33a37e97520734c'
         '28b8341592be35db12bb1cdfbc2ae41f'
         '432197c868d6eb1078694507ccae683e'
         'd1563a3b73198fbfa249d9105adea12f'
         '3e95f4968ebe66f47e1cfe8d1f6b97bf'
         '3ca3962e2d7123ee38d6af3ceb7a2fe3'
         '2c3a6d464d7e33920333dbc03fedef18'
         '8ddfc6831031380957b4f037988d79ef'
         'fadce47b39c830586ef0e813f87a190e'
         '3fb48cda23be02a60d76e54566560787'
         'f674a817a8d207f8a256f16c18386a67'
         'f0087ca53d40c550db7227e5992e1061'
         '8a82d008b1ace861b9d4da068b0bc9d5'
         'f240217e2c5a53958001741e566cab55'
         'd24542010ab2e6c33f80427b71665623'
         'fe14ac1dac4fecef331bbe6dda01abc9'
         '176cf00ae9fa48c62b3fbf61aff5e696'
         '30a1a850478e958e6585fb730ea2ef5c'
         'cadd712282df41b693741e90d5ae4355'
         'ccec184691cf65301e3ca2b9997fac0b'
         'dcbdd75ca605563e01a1249659348d5f'
         '8e825311bcc31da1fca1f9aa28424ff1'
         '325937cc4720b021c93e6d3025e31ef9'
         '176a5e62ed85afd177735558cdbac1ef'
         '53f8003666d8a68f3847a384c270d6b1'
         '7025f51e33b7feed85bbabf9b8887880'
         '5a0301c44c032b280d001910e7fc6ed7'
         '5ef5059e2158d17272bb997cf82ae3fb'
         'a59cffac1519899893d39af744a55b0d'
         'e062cde9316758374f0973416f8dcdb3'
         '3cf4259fe8b2a829330e4a3b7109128f'
         '0b0c96501ae512c717f2cebcce3812b8'
         '32f7531d07319a936c84b825a9323b74'
         '0bf40b89288e8dc739a43f087311e5eb'
         'e9af5a9b19e69542f85135193df3ad53'
         'e596cfdde03f1945faee793c8ca503e2'
         'be02c7e897f4015d8b41cbba4b873bec'
         'c5952540eb1eb58bff77fea8d82e8a8f'
         '0eb212192301fdd48387a066113aa91e'
         '286c25fd42b9e5b000353854fd341bdf'
         'c67335f24719d139a02a9edb155c091f'
         '24c071c19b44b15d7f88ed9f9665a766'
         '79a54640708e353fc939355f47d672b7'
         '2602c1a643a64c48f95ff3362b3ff207'
         '266c5b9939ab93fd57ad08e922241a11'
         'a11add4b77604891526a34783c994954'
         'a121b0ffdbb402a95149d64a9c39de09'
         '6e157170fed60bae8e5653144d2cfd0c'
         '3742fa3853167a4f781e67c09fb22046'
         '14ed3ab5b9cf5a4cc8438f279a8bef3f'
         'aa5c6abe1a0e6a5d5c72f3d5a4edd557'
         'f07e7b7cdf2e95a3a14a8d6c0ce7ba2f'
         'da51acbea1cb6ae2ac4da33b6117ba8d'
         'ca13606c16b7ca7fbc13430cbb56537c'
         'd9e51deb7435b90f6da99865aaa6cb9f'
         'ae81ebc52b1f04397c7368bc75adbd32'
         'f80c31468a80f46225cb2256248649c0'
         '2747fdabcd80c1c71acf22d728ce08b5'
         '6d2e3d0036f910e68b7f2f24365dde29'
         '80df5530b071abbe18d3866b242f4b83'
         '147b7629b842c33cddbd2c827dcc2296'
         'd7d99d2a580a2bbf534bc89e498a7066'
         '06f68663b3e5818d296377fe96186be5'
         'c614aa73f8075be85bf7d5d233050220'
         '30b4b544672b54fa52486b072e080d35'
         '822b1bee862f64c378b8753e1ba0562a'
         'f05f08cdd1e5764ebc6cb1958d8bba6d'
         '5913cd528cd4518e883d73a6a5139237'
         '50a6bdaba3c6c349793513995e3f4bdf'
         '33efbbccea9ccaca76ef1ca7c50e31d6'
         'f511e3fc61661accb4e6681071419800')
