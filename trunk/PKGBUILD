# $Id$
# Maintainer: Thomas Baechler <thomas@archlinux.org>
# Contributor: Jaroslaw Swierczynski <swiergot@juvepoland.com>
# Contributor: Michal Hybner <dta081@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgbase=firefox-i18n
pkgver=33.1
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox>=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'az     "Azerbaijani"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'csb    "Kashubian"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Lower Sorbian"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati (India)"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Malay"'
  'nb-NO  "Norwegian (BokmÃ¥l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi (India)"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=()
source=()
_url=http://download.cdn.mozilla.net/pub/firefox/releases/$pkgver/linux-i686/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

_package() {
  pkgdesc="$2 language pack for Firefox"
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg csb; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}

md5sums=('0bc924618918130605f52f73dae4d05c'
         'ab103f473511f3363f755f31c542cdf8'
         '5d727e51720a2b54d04bf21b0a077a93'
         '1b18b1500cb813a1a50123d97809bf90'
         '8c3521890ddc9227d4ff5c574a89e07d'
         'ff7702d22c09b9e605c6d8bdb398f2d3'
         '20df682f3c011a2d680b978003b849b0'
         '8ec09062b339ef97464effceb4a1858b'
         'bc5e21c0e43eaae8393cde8c06095ff3'
         '7996949b0d21623476ac06ec0bbe73ab'
         '93ce0c6145b3c579260cbaf8e5681187'
         'd5b29e3a32c3aa3eb87376feced671b8'
         '99412196e8ce2f7e0e4b245be8b16389'
         'ab32ced50765f9a67b7a9eb21175f682'
         '7d478ab04145f39dc26e7eef112daca4'
         '99a3a9f2c6888c4a3bf5cf344570063e'
         '4c9cf7efc2da8845a64275d8b968e41e'
         'ffa4c3f51d8d854d187fd2e0c22cbf46'
         '4c11103f7af51069f2005c5638257276'
         '0b66cb0478828d699df60d98a9a984c0'
         '236f4ab0ea52694a54b567f010125bd9'
         '9974961f9c89889750838e078319770b'
         '6e9764fa71cb7dfa79869b1a1614283d'
         '68d41223c30e0b1fa0ecd6f5cc5269b7'
         'b928622d4d1f56cd31a77734f8859775'
         '27175136113ce146cddd9dd0896ba833'
         '76baee2f3e665d4712a07bbd92e65b8e'
         '7f7f59bd4e59892d90fac43663751bda'
         '5eb4864d55c5f56240ee3c0437f8e48f'
         '1f0418d651d881d0f1673d4866155c59'
         '6dc7d485047aae896c8289b56dfb9bd9'
         '373476fb8b5a29d3f50755802218be48'
         '0fd27253d48a54f6718883a4bc936267'
         '092bcbfaf6e56be8d7d8fdd994bc2b5f'
         '7b3bde42ca5f8852bb998045f3b3b36b'
         '502a91a7de7ffcef3a5496899a8f00ee'
         '7776c48756568747e49943ee5b3e3ecd'
         'b3f688b2f2fc87e3c932b0189004b41f'
         'f6c178a3e8d877195a427d2b3f8c5c23'
         '68522623ebe242f457fa067a616705c4'
         '6e889017339489498f3876931db35719'
         '21903455cd5bd59dae9393340904fe95'
         '31adfbe924892bce12c4a2ae2133d65b'
         'f71aedc47f9d5fe0c66bebaca8becfd7'
         '1f9ded8f8916418f9b75e53c6bf9dd56'
         'e66748610ee5757d45211b9ed56ee8c2'
         '3108ee32be2ec096755364718502fe8c'
         'a78d864002df216db4d62d22753ba7de'
         '7ba90b79396822114f0e813ffe0c664b'
         'cf4f0c0fc03eb03f398f82fe45617b4d'
         'd38bbdee6591fb86ce92e386323313f0'
         '07c0c6d77abd741c3ea6f8e5d625daae'
         'c1db3d381b921c4d4c751ba94a14f7c3'
         '44bccbdc352242afb815a7d20877d3f6'
         'f45daafd3c31d98dc89bd450258bb2a8'
         'de094aa288b1e95eca6ec0c6e7778de5'
         '0ee96912fab887c5573d3d06dda3ecc3'
         'a19a3ede5ce21a6075fab652cbc3b1e2'
         '699cc77f1e15a41538ebbe421e2d2cda'
         'bd8a4271cef5916973699e8691abe746'
         '2adfeed0c4cdfede4f78ae754e9433b6'
         '1fa833d61678817d07660076120e4458'
         '757624d2ffe7734313b263be1b1794c9'
         '8b2456123898581899757db9df144e35'
         '47f4f81ec18526f18af641aed04d9683'
         '65378a10c612c9bb62294d42904cbd63'
         'd35fe3e54059a61bb237391e68ce4276'
         '7988e3081a2743a64e8514322a37e1c8'
         'e43a31bbaad1a40683b80ac46a37857a'
         '1335e3f1471f0116ab7fc58f5c375817'
         '7217d1f2ba4759f5a797d3014902f58b'
         'b0dfa5c6f9e55dc31a5907331678fb15'
         '5171f91a848960e9389aa2a3ce879b23'
         '55dc896feff1cca96fd8d3696bb94282'
         '5d37fa42aa60237971b43e0002900bcf'
         'f512b8bbe4730db29adcf295077e94e9'
         'cbf45a3f3c15e6e94161e60797276102'
         '8e1bb83aca8b793452ea51256c451ea7'
         'b180d4d197000acce0bbd4d2ffe91453'
         'c1c899f42bee6dfb47468af0d500cfd4'
         '8de4fe13207fec0f19a28cb4078de9e5'
         'e033a19f4c7e6436492a965c4042a101'
         'be57fd81b8ffeb3f561e21d6653dfdc4'
         'b26c46ac867a5a0642e8aba2264852c9'
         '6438da88312add7771a76134e95902a4'
         'b2a9a5a3d05b9f554895720432babdae'
         'babc16906f69b4234daee5cebce1c66d'
         '9a61aa6854d1174918c2c281d45c389a')
