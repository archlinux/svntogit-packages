# $Id$
# Maintainer: Thomas Baechler <thomas@archlinux.org>
# Contributor: Jaroslaw Swierczynski <swiergot@juvepoland.com>
# Contributor: Michal Hybner <dta081@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgbase=firefox-i18n
pkgver=33.0.1
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox>=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'az     "Azerbaijani"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'csb    "Kashubian"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Lower Sorbian"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati (India)"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Malay"'
  'nb-NO  "Norwegian (BokmÃ¥l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi (India)"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=()
source=()
_url=http://download.cdn.mozilla.net/pub/firefox/releases/$pkgver/linux-i686/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

_package() {
  pkgdesc="$2 language pack for Firefox"
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg csb; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}

md5sums=('580e949b19aaefe726aa3f7a77f6a102'
         'b2dba75162ae04f99927a07a3c90d03f'
         '5f0e751fbcd25e490b65fdb8e269d003'
         '2b9fc92eeae4bebdded40284077ae98d'
         'bfca139345ce7a1e6b983481f691fab8'
         '42559d183455eb9885f817ab4b5fb267'
         'dd3f36ce5c32e7fafd829245509c923e'
         '16c164693976a8d89c62819562d1013d'
         '94b8efbf0e687082df690fdad5443b37'
         'ca0d1ed09b2b766d85b9d27d568f4968'
         '4dd7f4e6b9de8bdfef1d93df48aaefb8'
         'ac3be87d6545e424a0cb6cac155aa8a4'
         'c53908cd07be1a4abe2c488d3b353d57'
         '5649daa35d7257ecbb8a7b3713074af7'
         '57140d69189126dd7196e9a1a9713ff8'
         'b8bb51e4a459528872a1ef7381a931c7'
         '8dd8497357e88618a7371b0a1615b94e'
         '6d8fd887cdb9ece7b3eaaf234c4fb1bf'
         'a6bd80b48650ccb13fd1885ad5e5e420'
         '599e835cb5bf02c6c7c485bc0c7eb1e8'
         '152989e3f594a226dacac36ee7cb593e'
         '943c76a01e01298a7e423929bfe08c87'
         'ea1f770e606bf8bb8c6a9414d3336372'
         '0073ffe2d2f306dcffce809dcb483c0d'
         'fac388d0f3a59184c37a0ef56f3e8c97'
         'daac781ace8f5ef90de96f22d2f82cbb'
         '2fc87b79d0b5537dc316acdecb5d18ff'
         '2ad53c2c65712e0f4ce644e87cc45327'
         '4f66557fe274bc740bf3b9b041a2d5bb'
         '5befbd37fba7c84eb40d50dd6143070e'
         'c770292dc0d96e69ad3e8ffa829a6de2'
         'b25c3c0acb51abadf3b5ad859561a997'
         'ee3e347f85013cd652e2ee4982ead247'
         '3d506df89524960bf6a329c62476f623'
         '57f5a4d788a5257a006e5bc0e4a569f7'
         'c2b5842e85f8596d042ea8149ecf58b6'
         '576064dbeae29bdef3d4e8af73b8bf6a'
         '3338a55cda74dfd3020cecb8111a8d88'
         '8958d583dbb6b105f4d78c4e75020e6d'
         '62be04f3ea560b82ccf69d5ede816333'
         'a0e1eb7819f8475bfccb531c5ff18b9d'
         '1832160be3fd5d1c3a5aedafc9ef7a9c'
         '7a17f912342dad222a15770eeb609988'
         'e0945233f95b5b2c9aa331f1bfd19980'
         '13e4e77479616d991eabf45b26d5cc92'
         '6df28cb35f2c0102a6a79e56350b236e'
         '398773ee092eecddbcca8bd9abdb377a'
         'cac2ffa44c420ca9f23c7b3f8be63469'
         'dc73f407fe7c5018304987efdd2cea78'
         'f130d294a3162340372cd562da0573c7'
         '483c1e6a0d304ab539462a07529e9a5c'
         '3a65da48210adefb12eb51a7177180fd'
         '7049b249e00d42a4ea5289a78f5989a4'
         '255dcf2aace8874d33d1faac2146ca36'
         'c83dc16ba6672723e2856a0efbce5a53'
         'deb947c105b37862629aa11e31692b21'
         'beb3a1aa73799fa16bc5c338cc6f5c2d'
         '84981c15c85e37b3d76fb5b12bc1c6cd'
         '9c70cac7795121bb0e6f82bf44672e4a'
         '9db59966a82e896353383a82d54a5747'
         'dbb3383c73f05e94063292e5a49dea54'
         '79a5068126800b642b4e1e8dbb8d4cc3'
         '5fc41a7e18ae88e05297dc5bd9918b38'
         'fea3dd89ab9e5ec47f206e22c219286a'
         'c42610e6685bbb84a396485b9d5e86ca'
         'f21c5d06a13c1f8b847e43af733ef540'
         '4d8151c2e2053420b859167b0afb80e8'
         '9dba191ef308ce48d7441644b23c8ded'
         'ec2a8e1ee7031ac38a3fe8c19aa9a498'
         'e1a827c4389c9da076b4102a7f6d6e04'
         '80279d8d6ed91bed00875c916a62ae26'
         '406e7b5dbf4eda06a04fe72249d43488'
         '8bc90425520547e4ad991232de94fe20'
         '6c0435bf0d180bd0f7e517527ad0fd32'
         '04952bcf3a009a6407887763fa001834'
         '5795b89365ec8b2eaa4a17092d95237a'
         '51f86e8523905e9b6112538899e7bcdc'
         'b05c10a8e0c2caefdd8515b4c4bd0ae7'
         'dab22199a61b6748b2884f6c54a53d11'
         '77b516b2324bb864d94c1ce183f0df81'
         'e9f42d2e1bc5318ac6dfbf3c3e78319b'
         'ae3210f2015d90af5f8332996591ab38'
         'a7c5d51e4d6c3d1011d9f5996e20b9fb'
         'e5954f9bdde0cb193fbe941df41f00a3'
         'f2601c6874a74330c528f32110d90dd7'
         '79d92e387e182168a48fecf61b748819'
         '50ff2042f0ca98a64cd588efdfd66a8e'
         '7fb9c98e8f5f094eac3ce12342c473d3')
