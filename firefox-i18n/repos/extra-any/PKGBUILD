# $Id$
# Maintainer: Thomas Baechler <thomas@archlinux.org>
# Contributor: Jaroslaw Swierczynski <swiergot@juvepoland.com>
# Contributor: Michal Hybner <dta081@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgbase=firefox-i18n
pkgver=33.0.3
pkgrel=1
pkgdesc="Language pack for Firefox"
arch=('any')
url="http://www.mozilla.com/"
license=('MPL' 'GPL')
depends=("firefox>=$pkgver")
makedepends=('zip' 'unzip')

_languages=(
  'ach    "Acholi"'
  'af     "Afrikaans"'
  'an     "Aragonese"'
  'ar     "Arabic"'
  'as     "Assamese"'
  'ast    "Asturian"'
  'az     "Azerbaijani"'
  'be     "Belarusian"'
  'bg     "Bulgarian"'
  'bn-BD  "Bengali (Bangladesh)"'
  'bn-IN  "Bengali (India)"'
  'br     "Breton"'
  'bs     "Bosnian"'
  'ca     "Catalan"'
  'cs     "Czech"'
  'csb    "Kashubian"'
  'cy     "Welsh"'
  'da     "Danish"'
  'de     "German"'
  'dsb    "Lower Sorbian"'
  'el     "Greek"'
  'en-GB  "English (British)"'
  'en-US  "English (US)"'
  'en-ZA  "English (South African)"'
  'eo     "Esperanto"'
  'es-AR  "Spanish (Argentina)"'
  'es-CL  "Spanish (Chile)"'
  'es-ES  "Spanish (Spain)"'
  'es-MX  "Spanish (Mexico)"'
  'et     "Estonian"'
  'eu     "Basque"'
  'fa     "Persian"'
  'ff     "Fulah"'
  'fi     "Finnish"'
  'fr     "French"'
  'fy-NL  "Frisian"'
  'ga-IE  "Irish"'
  'gd     "Gaelic (Scotland)"'
  'gl     "Galician"'
  'gu-IN  "Gujarati (India)"'
  'he     "Hebrew"'
  'hi-IN  "Hindi (India)"'
  'hr     "Croatian"'
  'hsb    "Upper Sorbian"'
  'hu     "Hungarian"'
  'hy-AM  "Armenian"'
  'id     "Indonesian"'
  'is     "Icelandic"'
  'it     "Italian"'
  'ja     "Japanese"'
  'kk     "Kazakh"'
  'km     "Khmer"'
  'kn     "Kannada"'
  'ko     "Korean"'
  'lij    "Ligurian"'
  'lt     "Lithuanian"'
  'lv     "Latvian"'
  'mai    "Maithili"'
  'mk     "Macedonian"'
  'ml     "Malayalam"'
  'mr     "Marathi"'
  'ms     "Malay"'
  'nb-NO  "Norwegian (BokmÃ¥l)"'
  'nl     "Dutch"'
  'nn-NO  "Norwegian (Nynorsk)"'
  'or     "Oriya"'
  'pa-IN  "Punjabi (India)"'
  'pl     "Polish"'
  'pt-BR  "Portuguese (Brazilian)"'
  'pt-PT  "Portuguese (Portugal)"'
  'rm     "Romansh"'
  'ro     "Romanian"'
  'ru     "Russian"'
  'si     "Sinhala"'
  'sk     "Slovak"'
  'sl     "Slovenian"'
  'sq     "Albanian"'
  'sr     "Serbian"'
  'sv-SE  "Swedish"'
  'ta     "Tamil"'
  'te     "Telugu"'
  'th     "Thai"'
  'tr     "Turkish"'
  'uk     "Ukrainian"'
  'vi     "Vietnamese"'
  'xh     "Xhosa"'
  'zh-CN  "Chinese (Simplified)"'
  'zh-TW  "Chinese (Traditional)"'
)

pkgname=()
source=()
_url=http://download.cdn.mozilla.net/pub/firefox/releases/$pkgver/linux-i686/xpi

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=firefox-i18n-${_locale,,}

  pkgname+=($_pkgname)
  source+=("firefox-i18n-$pkgver-$_locale.xpi::$_url/$_locale.xpi")
  eval "package_$_pkgname() {
    _package $_lang
  }"
done

# Don't extract anything
noextract=(${source[@]%%::*})

_package() {
  pkgdesc="$2 language pack for Firefox"
  install -Dm644 firefox-i18n-$pkgver-$1.xpi \
    "$pkgdir/usr/lib/firefox/browser/extensions/langpack-$1@firefox.mozilla.org.xpi"

  # Fix a few broken langpacks
  # https://bugzilla.mozilla.org/show_bug.cgi?id=832060
  if in_array $1 bg csb; then
    pushd "$pkgdir/usr/lib/firefox/browser/extensions" >/dev/null
    unzip langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    sed -i '/./,$!d' install.rdf
    zip -u langpack-$1@firefox.mozilla.org.xpi install.rdf >/dev/null
    rm install.rdf
    popd >/dev/null
  fi
}

md5sums=('8ed44ee615aa0e6b486f5227cde883dc'
         '57ef39e3685c405b54472db4ac897266'
         '2699490167e8719e941cdf8b32e13f5b'
         'c36260e018ecb1ccdf1e086c5e77fea7'
         '4fb371d7f44dc85b9b3d82016301ab82'
         '6c2ca9af468d3522a2b00b89db640415'
         '21e43876919791389a5d9e95c19b6cab'
         '7b3d677b4ef8d9c0e2eb238a2c616028'
         '3cc6bacdf302066d281894814b97bdcf'
         '113351b866c2bb29b4a45f4bcb457a47'
         '7d33f596be2524a2547912d05f3549f8'
         '6754808bb8b6857903577adb79d11e9d'
         '3d161bebce8436c339ad0ad454caf2fe'
         'd0a101ca9bf703759150f37ec6608a8d'
         '50b7f714e75e18a7d9ad8d62f30ff817'
         '92f6fb22fa7ba54366ccc8079675384a'
         'de5377420552ec05dcc96549f8a2df40'
         'e8bec6b9acaf4978601080cee34016f9'
         '79c35b3e395a038880fff32f29654773'
         'ea6ce6909f033f1917d86370004b6e54'
         'd21f2611c464b8301ebfd65404098f02'
         '2c812f8a5a816aca5a8cdb2405fbd2e9'
         'aa6984fed538f0a2463761c93036d446'
         '47bccce737060e64bd9a92dbc4be500b'
         'ff2625779818f53367811fd642d8d010'
         '4d4c7a05ec9ffbee5f75eb80918911b2'
         '3ccbaa3dff54dfb3b2b91d6b9056cc53'
         'dbcbe4dc5fa4c811d4d2210d0fa3f763'
         '0cf82bc8b94b6df4896d6abdb9a43927'
         'afcc2194502ff0842c44f091a9fb6ef1'
         '3639b555ffac7cdc52012556e8601411'
         '1fb73b63967b5802a0deedb08f37a2b2'
         'ec6674f67c519063cc0f2a34e0cd3b6c'
         '229c3940bc24b328545f8a6d337cfabe'
         'b15d17c69043a1d05489f8d716ada5e0'
         '579372732821d0b6824c5537edb6cba4'
         '1ece97e55a133f99e77aad282d148d1c'
         'e102aeafce9243a1e7c22bd62670cc5f'
         'ac77acac04387308c28820792683b65d'
         'b929170a759cb13e2a461e26be43cf94'
         '4dfd8981cf23685682a6240d86a3e837'
         '76598b82f0f82a03a099141c7009156d'
         '457774b9a32a7d0701ea978ee69359ae'
         '90e2ac7b25485ecb986ffae81fe87d46'
         '68c62d42de18e91c52f3ef851b07d917'
         '6a8d56d6d68c4c4918be52e275e14474'
         '9a805df77f7126d4145b2bb9d608b741'
         'f704536eb73e41f2b7e927359bb84233'
         '220099c212468081fc1c2200ff5bf176'
         '3937c5515b69ad8ce8c65768e5831fb6'
         '79e8df2c9dd85eb6f403278de7c6127f'
         'c2c89ef733783a94e65736215556927c'
         '247c9165f7b2150227e1404a57172489'
         '0c6e64529508b3a63a6c931faaed4230'
         '696f6bd8c4699b6d91da9602e0e06551'
         '4c07ffdfbf55ab1e9c498c9d9ea72736'
         'c9c04002c9be083e8e6ce77cda058ebb'
         'ae99f5b6c157895131aaa88ba51289be'
         '0b7755d7788c6cc9c812430c65ca5b6a'
         '92f879a6965590d1ac8f98799262c656'
         'b9a9fd6b4bb92fcf9b86fc3806b4e731'
         '53afb18b7a217d237f723b666a1e8fd4'
         '6f438459feaabbb3839ecd0927085e26'
         'd7d8cc3d716cb91e6287850a011b275a'
         'c6c97e037faad2cff210da9ff78a1208'
         'bf82cad46dd2a4bf1cee50b9c0479a88'
         'e840eab61654efe82460b57d240cd418'
         '594f8d319c2795dcecae4632f488bf96'
         '87efca97fd4fa8841ef4b52669b9c2c8'
         '373d2469d3c3399a888c0e2c17e2d707'
         'fe56eb61ecde60e421bb41c8a1b0a84f'
         '5034976c1c315f1a0bcf312adbcc42e0'
         '0fb1f16836d1c33ebac60cda73b5362c'
         '510717b2f0a68edbc3ac9a5c94d7104a'
         'cb759226b73f0036def1eec4b0fa5261'
         'c48ddde372c80b826cf67bb9b9abfd38'
         '0d1ca444f1662f27f4c49be81aaa5be6'
         'ed7dac16e1acf6cb630f1ebe29fbe674'
         '82f8677e3f69b486baef624dfdaa2f2b'
         '40da3c3d8415685ff5d3417ce5d7bb7b'
         '938c92f04fe8a5138b1359f76d277b69'
         'bcda1556a7dec7490cef06cf2c3ca389'
         'b3585ab0329650a960aee47f402e2a4e'
         '64f862ab66cb0abf810d7bf4e4fe8195'
         'e4d76d9cab4866fb178c0b723ad6f4bc'
         '524c286e82e978bd7a4c9499d7595da4'
         'ff17845fc6326b3c457dbf52c4188360'
         '2b4f54ed4304016f8e0783783fb1a25f')
